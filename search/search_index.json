{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"NDSL Documentation","text":"<p>NDSL is a middleware for climate and weather modelling developed jointly by NOAA and NASA. It allows atmospheric scientists to focus on what matters in model development and essentially decouples performance engineering from model development.</p>"},{"location":"#portable-performance","title":"Portable performance","text":"<p>NDSL brings together GT4Py and DaCe, two libraries developed for high-performance and portability. On top of those pillars, NDSL deploys a series of optimized APIs for common operations, e.g. halo exchange or domain decomposition, and tools to port existing models.</p>"},{"location":"#batteries-included-for-fv-based-models","title":"Batteries-included for FV-based models","text":"<p>Historically, NDSL was developed to port the FV3 dynamical core on the cubed-sphere. Therefore, the middleware ships with ready-to-execute specialization for models based on cubed-sphere grids and FV-based models in particular.</p> <p>Next: get up and running.</p>"},{"location":"quickstart/","title":"Quickstart","text":"<p>Alright - let's get you up an running!</p> <p>NDSL requires Python version <code>3.11</code> and a GNU compiler. We strongly recommend using a conda or virtual environment.</p> <pre><code># We have submodules for GT4Py and DaCe. Don't forget to pull them\ngit clone --recurse-submodules git@github.com:NOAA-GFDL/NDSL.git\n\ncd NDSL/\n\n# We strongly recommend using conda or a virtual environment\npython -m venv .venv/\nsource ./venv/bin/activate\n\n# [optional] Install MPI if you don't have a system installation.\npip install openmpi\n\n# Finally, install NDSL\npip install .[demos]\n</code></pre> <p>Now you can run through the Jupyter notebooks in <code>examples/NDSL</code> .</p> <p>Read on in the user manual.</p> <p>Supported compilers</p> <p>NDSL currently only works with the GNU compiler. Using <code>clang</code> will result in errors related to undefined OpenMP flags.</p> <p>For MacOS users, we know that <code>gcc</code> version 14 from homebrew works.</p> <p>Why cloning the repository?</p> <p>We are cloning the repository because NDSL is not available on <code>pypi</code>.</p>"},{"location":"dev/","title":"Under the hood","text":"<p>This is the technical part of the documentation, geared towards developers contributing to NDSL.</p>"},{"location":"dev/#introduction","title":"Introduction","text":"<p>Recently, Python has became the dominant programming language in the machine learning and data sciences communities since it is easy to learn and program. However, the performance of Python is still a major concern in scientific computing and HPC community. In the scientific computing and HPC community, the most widely used programming languages are C/C++ and Fortran, Python is often used as script language for pre- and post-processing.</p> <p>The major performance issue in Python programming language, especially in computation-intensive applications, are loops, which are often the performance bottlenecks of an application in other programming languages too, such as C++ and Fortran. However, Python programs are often observed to be 10x to 100x slower than C, C++ and Fortran programs. In order to achieve peak hardware performance, the scientific computing communities have tried different programming models, such as OpenMP, Cilk+, and Thread Building Blocks (TBB), as well as Linux p-threads for multi/many-core processors and GPUs, Kokkos, RAJA, OpenMP offload, and OpenACC for highest performance on CPU/GPUs heterogeneous system. All of these programming models are only available for C, C++ and Fortran. Only a few work that target to high performance for Python programming language.</p> <p>The Python based NDSL programming model described in this developer\u2019s guide provides an alternative solution to reach peak hardware performance with relatively little programming effort by using the stencil semantics. A stencil is similar to parallel for kernels that are used in Kokkos and RAJA, to update array elements according to a fixed access pattern. With the stencil semantics in mind, NDSL, for example, can be used to write matrix multiplication kernels that match the performance of cuBLAS/hipBLAS that many GPU programmers can\u2019t do in Cuda/HiP using only about 30 lines of code. It greatly reduces the programmer\u2019s effort, and NDSL has already been successfully used in the Pace global climate model, which achieves up to 4x speedup, more efficient than the original Fortran implementations.</p>"},{"location":"dev/#programming-model","title":"Programming model","text":"<p>The programming model of NDSL is composed of backend execution spaces, performance optimization pass and transformations, and memory spaces, memory layout. These abstraction semantics allow the formulation of generic algorithms and data structures which can then be mapped to different types of hardware architectures. Effectively, they allow for compile time transformation of algorithms to allow for adaptions of varying degrees of hardware parallelism as well as of the memory hierarchy. Figure 1 shows the high level architecture of NDSL (without orchestration option), From Fig. 1, it is shown that NDSL uses hierarchy levels intermediate representation (IR) to abstract the structure of computational program, which reduces the complexity of application code, and maintenance cost, while the code portability and scalability are increased. This method also avoids raising the information from lower level representations by means of static analysis, and memory leaking, where feasible, and performing optimizations at the high possible level of abstraction. The methods primarily leverages structural information readily available in the source code, it enables to apply the optimization, such as loop fusion, tiling and vectorization without the need for complicated analysis and heuristics.</p> <p></p> <p>In NDSL, the python frontend code takes the user defined stencils to python AST using builtin ast module. In an AST, each node is an object defined in python AST grammar class (for more details, please refer: https://docs.python.org/3/library/ast.html). the AST node visitor (the NDSL/external/gt4py/src/gt4py/cartesian/frontend/gtscript_frontend.py) IRMaker class traverses the AST of a python function decorated by @gtscript.function and/or stencil objects, the Python AST of the program is then lowing to the Definition IR. The definition IR is high level IR, and is composed of high level program, domain-specific information, and the structure of computational operations which are independent of low level hardware platform. The definition of high level IR allows transformation of the IRs without loosing the performance of numerical libraries. However, the high level IR doesn\u2019t contains detailed information that required for performance on specific low level runtime hardware. Specifically, the definition IR only preserves the necessary information to lower operations to runtime platform hardware instructions implementing coarse-grained vector operations, or to numerical libraries \u2014 such as cuBLAS/hipBLAS and Intel MKL.</p> <p>The definition IR is then transformed to GTIR (gt4py/src/gt4py/cartesian/frontend/defir_to_gtir.py), the GTIR stencils is defined as in NDSL</p> <pre><code>class Stencil(LocNode, eve.ValidatedSymbolTableTrait):\n    name: str\n    api_signature: List[Argument]\n    params: List[Decl]\n    vertical_loops: List[VerticalLoop]\n    externals: Dict[str, Literal]\n    sources: Dict[str, str]\n    docstring: str\n\n    @property\n    def param_names(self) -&gt; List[str]:\n        return [p.name for p in self.params]\n\n    _validate_lvalue_dims = common.validate_lvalue_dims(VerticalLoop, FieldDecl)\n</code></pre> <p>GTIR is also a high level IR, it contains vertical_loops loop statement, in the climate applications, the vertical loops usually need special treatment as the numerical unstanbility is a reason. The vertical_loops in GTIR as separate code block and help the following performance pass and transformation implementation. The program analysis pass/transformation is applied on the GTIR to remove the redundant nodes, and pruning the unused parameters, and data type and shape propagations of the symbols, and loop extensions.</p> <p>The GTIR is then further lowered to optimization IR (OIR), which is defined as</p> <pre><code>class Stencil(LocNode, eve.ValidatedSymbolTableTrait):\n    name: str\n    # TODO: fix to be List[Union[ScalarDecl, FieldDecl]]\n    params: List[Decl]\n    vertical_loops: List[VerticalLoop]\n    declarations: List[Temporary]\n\n    _validate_dtype_is_set = common.validate_dtype_is_set()\n    _validate_lvalue_dims = common.validate_lvalue_dims(VerticalLoop, FieldDecl)\n</code></pre> <p>The OIR is particularly designed for performance optimization, the performance optimization algorithm are carried out on OIR by developing pass/transformations. Currently, the vertical loop merging, and horizontal execution loop merging, and loop unrolling and vectorization, statement fusion and pruning optimizations are available and activated by the environmental variable in the oir_pipeline module.</p> <p>After the optimization pipeline finished, the OIR is then converted to different backend IR, for example, DACE IR (SDFG). The DACE SDFG can be further optimized by its embedded pass/transformations algorithm, but in PACE application, we didn\u2019t activate this optimization step. It should be pointed out that, during the OIR to SDFG process, the horizontal execution node is serialized to SDFG library node, within which the loop expansion information is encrypted.</p> <p>When using GT backend, the OIR is then directly used by the gt4py code generator to generate the C++ GridTools stencils (computation code), and the python binding code. In this backend, each horizontal execution node will be passed to and generate a separate GridTools stencil.</p> <p>NDSL also supports the whole program optimization model, this is called orchestration model in NDSL, currently it only supports DaCe backend. Whole program optimization with DaCe is the process of turning all Python and GT4Py code in generated C++. Only orchestrate the runtime code of the model is applied, e.g. everything in the call method of the module and all code in init is executed like a normal GT backend.</p> <p>At the highest level in Pace, to turn on orchestration you need to flip the FV3_DACEMODE to an orchestrated options and run a dace:* backend (it will error out if run anything else). Option for FV3_DACEMODE are:</p> <ul> <li>Python: default, turns orchestration off.</li> <li>Build: build the SDFG then exit without running. See Build for limitation of build strategy.</li> <li>BuildAndRun: as above, but distribute the build and run.</li> <li>Run: tries to execute, errors out if the cache don\u2019t exists.</li> </ul> <p>Code is orchestrated two ways:</p> <ul> <li>functions are orchestrated via orchestrate_function decorator,</li> <li>methods are orchestrate via the orchestrate function (e.g. pace.driver.Driver._critical_path_step_all)</li> </ul> <p>The later is the way we orchestrate in our model. orchestrate is often called as the first function in the init. It patches in place the methods and replace them with a wrapper that will deal with turning it all into executable SDFG when call time comes.</p> <p>The orchestration has two parameters: config (will expand later) and dace_compiletime_args.</p> <p>DaCe needs to be described all memory so it can interface it in the C code that will be executed. Some memory is automatically parsed (e.g. numpy, cupy, scalars) and others need description. In our case Quantity and others need to be flag as dace.compiletime which tells DaCe to not try to AOT the memory and wait for JIT time. The dace_compiletime_args helps with tagging those without having to change the type hint.</p> <p>Figure 2 shows the hierarchy levels of intermediate representations (IR) and the lowing process when orchestration option is activated.</p> <p></p> <p>When the orchestrated option is turned on, the call method object is patched in place, replacing the original Callable with a wrapper that will trigger orchestration at call time. If the model configuration doesn\u2019t demand orchestration, this won\u2019t do anything. The orchestrated call methods and the computational stencils (lazy computational stencils) which are cached in a container, will be parsed to python AST by the frontend code during the runtime, then the python AST code will be converted to DaCe SDFG. The analysis and optimization will be applied before the C++ code is generated by the codegen, this process is called Just In Time (JIT) build, compared with the non-orchestration model, which is eagerly compiled and build. The JIT build caches the build information of computational stencils, and orchestrated methods, and it is more convenient to apply the analysis and optimization pass to the overall code, such as the merging of neighbor stencils made easy. Therefore, more optimized code can be generated, and better performance can be achieved during runtime.</p>"},{"location":"dev/#analysis-and-optimization","title":"Analysis and Optimization","text":"<p>One of the major features of NDSL is that users can develop a new pass/transformation for the backend with new hardware, the passes and/or transformations are the key integrates in order to have good performance on the new hardware. In different abstract level, the passes and/or transformations perform different levels of optimization. For example, the loop level of optimization is independent of hardware, and can be applied to any backend, while the optimization of device placement, and memory and caches optimizations are dependent on different backend and hardware. In this section, we only focused on the optimizations that are independent of the backend hardware.</p> <p>The general procedure of code optimization has two steps, in the first step, a filter function is called to find the pattern that need to apply the pass and/or transformation, then apply the pass and/or transformation to the filtered pattern to insert or delete or replace the existing node with the optimized node. In NDSL, the following passes and/transformations are provided.</p> <pre><code>def prune_unused_parameters(node: gtir.Stencil) -&gt; gtir.Stencil:\n      assert isinstance(node, gtir.Stencil)\n      used_variables = (\n        node.walk_values()\n        .if_isinstance(gtir.FieldAccess, gtir.ScalarAccess)\n        .getattr(\"name\")\n        .to_list()\n      )\n      used_params = list(filter(lambda param: param.name in used_variables, node.params))\n      return node.copy(update={\"params\": used_params})\n</code></pre>"},{"location":"dev/#code-generators","title":"Code generators","text":""},{"location":"dev/dace/","title":"DaCe","text":"<p>DaCe is is the full-program optimization framework used in NDSL. DaCe is short for Data-Centric Parallel Programming and developed at ETH's scalable parallel computing lab (SPCL).</p> <p>In NDSL, DaCe powers the performance backends of GT4Py. In particular, in NDSL's orchestration feature we will encode macro-level optimizations like loop re-ordering and stencil fusing using DaCe.</p>"},{"location":"dev/gt4py/","title":"GT4Py","text":"<p>Warning</p> <p>TODO: Add some docs on GT4Py here</p>"},{"location":"docstrings/","title":"Welcome to NDSL Docstrings","text":"<p>This documentation is generated from the docstrings of the various NDSL classes and functions.  It's organized by the various NDSL paths.</p> <ul> <li>Top level</li> <li>checkpointer</li> <li>comm</li> <li>debug</li> <li>dsl</li> <li>grid</li> <li>halo</li> <li>initialization</li> <li>monitor</li> <li>performance</li> <li>quantity</li> <li>restart</li> <li>stencils</li> <li>testing</li> <li>viz</li> </ul>"},{"location":"docstrings/checkpointer/base/","title":"base","text":""},{"location":"docstrings/checkpointer/base/#checkpointer.base.SavepointName","title":"<code>SavepointName = str</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/checkpointer/base/#checkpointer.base.VariableName","title":"<code>VariableName = str</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/checkpointer/base/#checkpointer.base.ArrayLike","title":"<code>ArrayLike = Quantity | np.ndarray</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/checkpointer/base/#checkpointer.base.Checkpointer","title":"<code>Checkpointer</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/checkpointer/base/#checkpointer.base.Checkpointer.__call__","title":"<code>__call__(savepoint_name, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/checkpointer/null/","title":"null","text":""},{"location":"docstrings/checkpointer/null/#checkpointer.null.NullCheckpointer","title":"<code>NullCheckpointer</code>","text":"<p>               Bases: <code>Checkpointer</code></p>"},{"location":"docstrings/checkpointer/null/#checkpointer.null.NullCheckpointer.__call__","title":"<code>__call__(savepoint_name, **kwargs)</code>","text":""},{"location":"docstrings/checkpointer/snapshots/","title":"snapshots","text":""},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.SnapshotCheckpointer","title":"<code>SnapshotCheckpointer</code>","text":"<p>               Bases: <code>Checkpointer</code></p> <p>Checkpointer which can be used to save datasets showing the evolution of variables between checkpointer calls.</p>"},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.SnapshotCheckpointer.dataset","title":"<code>dataset</code>  <code>property</code>","text":""},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.SnapshotCheckpointer.__init__","title":"<code>__init__(rank)</code>","text":""},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.SnapshotCheckpointer.__call__","title":"<code>__call__(savepoint_name, **kwargs)</code>","text":""},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.SnapshotCheckpointer.cleanup","title":"<code>cleanup()</code>","text":""},{"location":"docstrings/checkpointer/snapshots/#checkpointer.snapshots.make_dims","title":"<code>make_dims(savepoint_dim, label, data_list)</code>","text":"<p>Helper which defines dimension names for an xarray variable.</p> <p>Used to ensure no dimensions have the same name but different sizes when defining xarray datasets.</p>"},{"location":"docstrings/checkpointer/thresholds/","title":"thresholds","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.InsufficientTrialsError","title":"<code>InsufficientTrialsError</code>","text":"<p>               Bases: <code>Exception</code></p>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.Threshold","title":"<code>Threshold</code>  <code>dataclass</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.Threshold.relative","title":"<code>relative</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.Threshold.absolute","title":"<code>absolute</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.Threshold.__init__","title":"<code>__init__(relative, absolute)</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.Threshold.merge","title":"<code>merge(other)</code>","text":"<p>Provide a threshold which is always satisfied if both input thresholds are satisfied.</p> <p>This is generally a less strict threshold than either input.</p>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.SavepointThresholds","title":"<code>SavepointThresholds</code>  <code>dataclass</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.SavepointThresholds.savepoints","title":"<code>savepoints</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.SavepointThresholds.__init__","title":"<code>__init__(savepoints)</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.ThresholdCalibrationCheckpointer","title":"<code>ThresholdCalibrationCheckpointer</code>","text":"<p>               Bases: <code>Checkpointer</code></p> <p>Calibrates thresholds to be used by a ValidationCheckpointer.</p> <p>Does this by recording the minimum and maximum values seen across trials, and using them to derive the maximum relative and absolute error one could have across any pair of trials, then multiplying this by a user-provided factor.</p>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.ThresholdCalibrationCheckpointer.thresholds","title":"<code>thresholds</code>  <code>property</code>","text":""},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.ThresholdCalibrationCheckpointer.__init__","title":"<code>__init__(factor=1.0)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>factor</code> <code>float</code> <p>set thresholds equal to this factor of the maximum error seen across trials</p> <code>1.0</code>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.ThresholdCalibrationCheckpointer.__call__","title":"<code>__call__(savepoint_name, **kwargs)</code>","text":"<p>Record values for a savepoint.</p> <p>Parameters:</p> Name Type Description Default <code>savepoint_name</code> <code>SavepointName</code> <p>name of the savepoint</p> required <code>**kwargs</code> <code>ArrayLike</code> <p>data for the savepoint</p> <code>{}</code>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.ThresholdCalibrationCheckpointer.trial","title":"<code>trial()</code>","text":"<p>Context manager for a trial.</p> <p>A new context manager should entered each time the code being calibrated is called, and exited at the end of code execution. If each of these calls is done with slightly perturbed inputs, this calibrator will be able to estimate an error tolerance for each savepoint call.</p>"},{"location":"docstrings/checkpointer/thresholds/#checkpointer.thresholds.cast_to_ndarray","title":"<code>cast_to_ndarray(array)</code>","text":""},{"location":"docstrings/checkpointer/validation/","title":"validation","text":""},{"location":"docstrings/checkpointer/validation/#checkpointer.validation.ValidationCheckpointer","title":"<code>ValidationCheckpointer</code>","text":"<p>               Bases: <code>Checkpointer</code></p> <p>Checkpointer which can be used to validate the output of a test.</p>"},{"location":"docstrings/checkpointer/validation/#checkpointer.validation.ValidationCheckpointer.__init__","title":"<code>__init__(savepoint_data_path, thresholds, rank)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>savepoint_data_path</code> <code>str</code> <p>path to directory containing netcdf savepoint data</p> required <code>thresholds</code> <code>SavepointThresholds</code> <p>thresholds to check against</p> required <code>rank</code> <code>int</code> <p>rank of the process, needed to compare against the correct savepoint data</p> required"},{"location":"docstrings/checkpointer/validation/#checkpointer.validation.ValidationCheckpointer.trial","title":"<code>trial()</code>","text":"<p>Context manager for a trial.</p> <p>When entered, resets reference data comparison back to the start of the data.</p> <p>A new context manager should entered before the code being tested is called, and exited at the end of code execution.</p>"},{"location":"docstrings/checkpointer/validation/#checkpointer.validation.ValidationCheckpointer.__call__","title":"<code>__call__(savepoint_name, **kwargs)</code>","text":"<p>Checks the arrays passed as keyword arguments against thresholds specified.</p> <p>Parameters:</p> Name Type Description Default <code>savepoint_name</code> <code>str</code> <p>name of the savepoint</p> required <code>**kwargs</code> <code>ArrayLike</code> <p>array data for variables in that savepoint</p> <code>{}</code> <p>Raises:</p> Type Description <code>AssertionError</code> <p>if the thresholds on any variable are not met</p>"},{"location":"docstrings/comm/_boundary_utils/","title":"_boundary_utils","text":""},{"location":"docstrings/comm/_boundary_utils/#comm._boundary_utils.BOUNDARY_AT_START_OF_DIM_MAPPING","title":"<code>BOUNDARY_AT_START_OF_DIM_MAPPING = {constants.WEST: {constants.I_DIM: True, constants.I_INTERFACE_DIM: True}, constants.EAST: {constants.I_DIM: False, constants.I_INTERFACE_DIM: False}, constants.SOUTH: {constants.J_DIM: True, constants.J_INTERFACE_DIM: True}, constants.NORTH: {constants.J_DIM: False, constants.J_INTERFACE_DIM: False}}</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/_boundary_utils/#comm._boundary_utils.shift_boundary_slice_tuple","title":"<code>shift_boundary_slice_tuple(dims, origin, extent, boundary_type, slice_tuple)</code>","text":""},{"location":"docstrings/comm/_boundary_utils/#comm._boundary_utils.bound_default_slice","title":"<code>bound_default_slice(slice_in, start=None, stop=None)</code>","text":""},{"location":"docstrings/comm/_boundary_utils/#comm._boundary_utils.get_boundary_slice","title":"<code>get_boundary_slice(dims, origin, extent, shape, boundary_type, n_halo, interior)</code>  <code>cached</code>","text":""},{"location":"docstrings/comm/_boundary_utils/#comm._boundary_utils.boundary_at_start_of_dim","title":"<code>boundary_at_start_of_dim(boundary, dim)</code>","text":"<p>Return True if boundary is at the start of the dimension, False if at the end, None if the boundary does not align with the dimension.</p>"},{"location":"docstrings/comm/boundary/","title":"boundary","text":""},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary","title":"<code>Boundary</code>  <code>dataclass</code>","text":"<p>Maps part of a subtile domain to another rank which shares halo points.</p>"},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.from_rank","title":"<code>from_rank</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.to_rank","title":"<code>to_rank</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.n_clockwise_rotations","title":"<code>n_clockwise_rotations</code>  <code>instance-attribute</code>","text":"<p>number of clockwise rotations data undergoes if it moves from the from_rank to the to_rank. The same as the number of clockwise rotations to get from the orientation of the axes in from_rank to the orientation of the axes in to_rank.</p>"},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.__init__","title":"<code>__init__(from_rank, to_rank, n_clockwise_rotations)</code>","text":""},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.send_view","title":"<code>send_view(quantity, n_points)</code>","text":"<p>Return a sliced view of points which should be sent at this boundary.</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity</code> <p>quantity for which to return a slice</p> required <code>n_points</code> <code>int</code> <p>the width of boundary to include</p> required"},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.recv_view","title":"<code>recv_view(quantity, n_points)</code>","text":"<p>Return a sliced view of points which should be received at this boundary.</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity</code> <p>quantity for which to return a slice</p> required <code>n_points</code> <code>int</code> <p>the width of boundary to include</p> required"},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.send_slice","title":"<code>send_slice(specification)</code>","text":"<p>Return the index slices which should be sent at this boundary.</p> <p>Parameters:</p> Name Type Description Default <code>specification</code> <code>QuantityHaloSpec</code> <p>data specifications for the halo. Including shape and number of halo points.</p> required <p>Returns:</p> Type Description <code>tuple[slice, ...]</code> <p>A tuple of slices (one per dimensions)</p>"},{"location":"docstrings/comm/boundary/#comm.boundary.Boundary.recv_slice","title":"<code>recv_slice(specification)</code>","text":"<p>Return the index slices which should be received at this boundary.</p> <p>Parameters:</p> Name Type Description Default <code>specification</code> <code>QuantityHaloSpec</code> <p>data specifications for the halo. Including shape and number of halo points.</p> required <p>Returns:</p> Type Description <code>tuple[slice, ...]</code> <p>A tuple of slices (one per dimensions)</p>"},{"location":"docstrings/comm/boundary/#comm.boundary.SimpleBoundary","title":"<code>SimpleBoundary</code>  <code>dataclass</code>","text":"<p>               Bases: <code>Boundary</code></p> <p>A boundary representing an edge or corner of a subtile.</p>"},{"location":"docstrings/comm/boundary/#comm.boundary.SimpleBoundary.boundary_type","title":"<code>boundary_type</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/boundary/#comm.boundary.SimpleBoundary.__init__","title":"<code>__init__(from_rank, to_rank, n_clockwise_rotations, boundary_type)</code>","text":""},{"location":"docstrings/comm/caching_comm/","title":"caching_comm","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestWriter","title":"<code>CachingRequestWriter</code>","text":"<p>               Bases: <code>Request</code></p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestWriter.__init__","title":"<code>__init__(req, buffer, buffer_list)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestWriter.wait","title":"<code>wait()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestReader","title":"<code>CachingRequestReader</code>","text":"<p>               Bases: <code>Request</code></p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestReader.__init__","title":"<code>__init__(recvbuf, data)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingRequestReader.wait","title":"<code>wait()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.NullRequest","title":"<code>NullRequest</code>","text":"<p>               Bases: <code>Request</code></p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.NullRequest.wait","title":"<code>wait()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData","title":"<code>CachingCommData</code>  <code>dataclass</code>","text":"<p>Data required to restore a CachingCommReader.</p> <p>Usually you will not want to initialize this class directly, but instead use the CachingCommReader.load method.</p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.rank","title":"<code>rank</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.size","title":"<code>size</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.bcast_objects","title":"<code>bcast_objects = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.received_buffers","title":"<code>received_buffers = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.generic_obj_buffers","title":"<code>generic_obj_buffers = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.split_data","title":"<code>split_data = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.__init__","title":"<code>__init__(rank, size, bcast_objects=list(), received_buffers=list(), generic_obj_buffers=list(), split_data=list())</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.get_bcast","title":"<code>get_bcast()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.get_buffer","title":"<code>get_buffer()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.get_generic_obj","title":"<code>get_generic_obj()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.get_split","title":"<code>get_split()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.dump","title":"<code>dump(file)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommData.load","title":"<code>load(file)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader","title":"<code>CachingCommReader</code>","text":"<p>               Bases: <code>Comm[T]</code></p> <p>mpi4py Comm-like object which replays stored communications.</p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.__init__","title":"<code>__init__(data)</code>","text":"<p>Initialize a CachingCommReader.</p> <p>Usually you will not want to initialize this class directly, but instead use the CachingCommReader.load method.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>CachingCommData</code> <p>contains all data needed for mocked communication</p> required"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Get_rank","title":"<code>Get_rank()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Get_size","title":"<code>Get_size()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.bcast","title":"<code>bcast(value, root=0)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.barrier","title":"<code>barrier()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Barrier","title":"<code>Barrier()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Scatter","title":"<code>Scatter(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Gather","title":"<code>Gather(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.allgather","title":"<code>allgather(sendobj)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Send","title":"<code>Send(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Isend","title":"<code>Isend(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Recv","title":"<code>Recv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Irecv","title":"<code>Irecv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.sendrecv","title":"<code>sendrecv(sendbuf, dest, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Split","title":"<code>Split(color, key)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.allreduce","title":"<code>allreduce(sendobj, op=ReductionOperator.NO_OP)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Allreduce","title":"<code>Allreduce(sendobj, recvobj, op)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.Allreduce_inplace","title":"<code>Allreduce_inplace(obj, op)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommReader.load","title":"<code>load(file)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter","title":"<code>CachingCommWriter</code>","text":"<p>               Bases: <code>Comm[T]</code></p> <p>Wrapper around a mpi4py Comm object which can be serialized and then loaded as a CachingCommReader.</p>"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.__init__","title":"<code>__init__(comm)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm[T]</code> <p>underlying mpi4py comm-like object</p> required"},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Get_rank","title":"<code>Get_rank()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Get_size","title":"<code>Get_size()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.bcast","title":"<code>bcast(value, root=0)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.barrier","title":"<code>barrier()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Barrier","title":"<code>Barrier()</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Scatter","title":"<code>Scatter(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Gather","title":"<code>Gather(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.allgather","title":"<code>allgather(sendobj)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Send","title":"<code>Send(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Isend","title":"<code>Isend(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Recv","title":"<code>Recv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Irecv","title":"<code>Irecv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.sendrecv","title":"<code>sendrecv(sendbuf, dest, **kwargs)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Split","title":"<code>Split(color, key)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.dump","title":"<code>dump(file)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.allreduce","title":"<code>allreduce(sendobj, op=ReductionOperator.NO_OP)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Allreduce","title":"<code>Allreduce(sendobj, recvobj, op)</code>","text":""},{"location":"docstrings/comm/caching_comm/#comm.caching_comm.CachingCommWriter.Allreduce_inplace","title":"<code>Allreduce_inplace(obj, op)</code>","text":""},{"location":"docstrings/comm/comm_abc/","title":"comm_abc","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator","title":"<code>ReductionOperator</code>","text":"<p>               Bases: <code>Enum</code></p>"},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.OP_NULL","title":"<code>OP_NULL = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.MAX","title":"<code>MAX = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.MIN","title":"<code>MIN = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.SUM","title":"<code>SUM = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.PROD","title":"<code>PROD = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.LAND","title":"<code>LAND = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.BAND","title":"<code>BAND = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.LOR","title":"<code>LOR = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.BOR","title":"<code>BOR = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.LXOR","title":"<code>LXOR = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.BXOR","title":"<code>BXOR = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.MAXLOC","title":"<code>MAXLOC = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.MINLOC","title":"<code>MINLOC = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.REPLACE","title":"<code>REPLACE = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.ReductionOperator.NO_OP","title":"<code>NO_OP = enum.auto()</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Request","title":"<code>Request</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Request.wait","title":"<code>wait()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm","title":"<code>Comm</code>","text":"<p>               Bases: <code>ABC</code>, <code>Generic[T]</code></p>"},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Get_rank","title":"<code>Get_rank()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Get_size","title":"<code>Get_size()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.bcast","title":"<code>bcast(value, root=0)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.barrier","title":"<code>barrier()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Barrier","title":"<code>Barrier()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Scatter","title":"<code>Scatter(sendbuf, recvbuf, root=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Gather","title":"<code>Gather(sendbuf, recvbuf, root=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.allgather","title":"<code>allgather(sendobj)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Send","title":"<code>Send(sendbuf, dest, tag=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.sendrecv","title":"<code>sendrecv(sendbuf, dest, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Isend","title":"<code>Isend(sendbuf, dest, tag=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Recv","title":"<code>Recv(recvbuf, source, tag=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Irecv","title":"<code>Irecv(recvbuf, source, tag=0, **kwargs)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Split","title":"<code>Split(color, key)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.allreduce","title":"<code>allreduce(sendobj, op=ReductionOperator.NO_OP)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Allreduce","title":"<code>Allreduce(sendobj, recvobj, op)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/comm_abc/#comm.comm_abc.Comm.Allreduce_inplace","title":"<code>Allreduce_inplace(obj, op)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/communicator/","title":"communicator","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator","title":"<code>Communicator</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.comm","title":"<code>comm = comm</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.partitioner","title":"<code>partitioner = partitioner</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.timer","title":"<code>timer = timer if timer is not None else NullTimer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.tile","title":"<code>tile</code>  <code>abstractmethod</code> <code>property</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.rank","title":"<code>rank</code>  <code>property</code>","text":"<p>rank of the current process within this communicator</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.size","title":"<code>size</code>  <code>property</code>","text":"<p>Total number of ranks in this communicator</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.boundaries","title":"<code>boundaries</code>  <code>property</code>","text":"<p>boundaries of this tile with neighboring tiles</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.__init__","title":"<code>__init__(comm, partitioner, force_cpu=False, timer=None)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.from_layout","title":"<code>from_layout(comm, layout, force_cpu=False, timer=None)</code>  <code>abstractmethod</code> <code>classmethod</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.all_reduce","title":"<code>all_reduce(input_quantity, op, output_quantity=None)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.all_reduce_per_element","title":"<code>all_reduce_per_element(input_quantity, output_quantity, op)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.all_reduce_per_element_in_place","title":"<code>all_reduce_per_element_in_place(quantity, op)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.scatter","title":"<code>scatter(send_quantity=None, recv_quantity=None)</code>","text":"<p>Transfer subtile regions of a full-tile quantity from the tile root rank to all subtiles.</p> <p>Parameters:</p> Name Type Description Default <code>send_quantity</code> <code>Quantity | None</code> <p>quantity to send, only required/used on the tile root rank</p> <code>None</code> <code>recv_quantity</code> <code>Quantity | None</code> <p>if provided, assign received data into this Quantity.</p> <code>None</code> <p>Returns:     recv_quantity</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.gather","title":"<code>gather(send_quantity, recv_quantity=None)</code>","text":"<p>Transfer subtile regions of a full-tile quantity from each rank to the tile root rank.</p> <p>Parameters:</p> Name Type Description Default <code>send_quantity</code> <code>Quantity</code> <p>quantity to send</p> required <code>recv_quantity</code> <code>Quantity | None</code> <p>if provided, assign received data into this Quantity (only used on the tile root rank)</p> <code>None</code> <p>Returns:     recv_quantity: quantity if on root rank, otherwise None</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.gather_state","title":"<code>gather_state(send_state=None, recv_state=None, transfer_type=None)</code>","text":"<p>Transfer a state dictionary from subtile ranks to the tile root rank.</p> <p>'time' is assumed to be the same on all ranks, and its value will be set to the value from the root rank.</p> <p>Parameters:</p> Name Type Description Default <code>send_state</code> <p>the model state to be sent containing the subtile data</p> <code>None</code> <code>recv_state</code> <p>the pre-allocated state in which to receive the full tile state. Only variables which are scattered will be written to.</p> <code>None</code> <p>Returns:     recv_state: on the root rank, the state containing the entire tile</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.scatter_state","title":"<code>scatter_state(send_state=None, recv_state=None)</code>","text":"<p>Transfer a state dictionary from the tile root rank to all subtiles.</p> <p>Parameters:</p> Name Type Description Default <code>send_state</code> <p>the model state to be sent containing the entire tile, required only from the root rank</p> <code>None</code> <code>recv_state</code> <p>the pre-allocated state in which to receive the scattered state. Only variables which are scattered will be written to.</p> <code>None</code> <p>Returns:     rank_state: the state corresponding to this rank's subdomain</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.halo_update","title":"<code>halo_update(quantity, n_points)</code>","text":"<p>Perform a halo update on a quantity or quantities</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity | list[Quantity]</code> <p>the quantity to be updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting from the interior</p> required"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.start_halo_update","title":"<code>start_halo_update(quantity, n_points)</code>","text":"<p>Start an asynchronous halo update on a quantity.</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity | list[Quantity]</code> <p>the quantity to be updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting from the interior</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdater</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.vector_halo_update","title":"<code>vector_halo_update(x_quantity, y_quantity, n_points)</code>","text":"<p>Perform a halo update of a horizontal vector quantity or quantities.</p> <p>Assumes the x and y dimension indices are the same between the two quantities.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity | list[Quantity]</code> <p>the x-component quantity to be halo updated</p> required <code>y_quantity</code> <code>Quantity | list[Quantity]</code> <p>the y-component quantity to be halo updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting at the interior</p> required"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.start_vector_halo_update","title":"<code>start_vector_halo_update(x_quantity, y_quantity, n_points)</code>","text":"<p>Start an asynchronous halo update of a horizontal vector quantity.</p> <p>Assumes the x and y dimension indices are the same between the two quantities.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity | list[Quantity]</code> <p>the x-component quantity to be halo updated</p> required <code>y_quantity</code> <code>Quantity | list[Quantity]</code> <p>the y-component quantity to be halo updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting at the interior</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdater</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.synchronize_vector_interfaces","title":"<code>synchronize_vector_interfaces(x_quantity, y_quantity)</code>","text":"<p>Synchronize shared points at the edges of a vector interface variable.</p> <p>Sends the values on the south and west edges to overwrite the values on adjacent subtiles. Vector must be defined on the Arakawa C grid.</p> <p>For interface variables, the edges of the tile are computed on both ranks bordering that edge. This routine copies values across those shared edges so that both ranks have the same value for that edge. It also handles any rotation of vector quantities needed to move data across the edge.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity</code> <p>the x-component quantity to be synchronized</p> required <code>y_quantity</code> <code>Quantity</code> <p>the y-component quantity to be synchronized</p> required"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.start_synchronize_vector_interfaces","title":"<code>start_synchronize_vector_interfaces(x_quantity, y_quantity)</code>","text":"<p>Synchronize shared points at the edges of a vector interface variable.</p> <p>Sends the values on the south and west edges to overwrite the values on adjacent subtiles. Vector must be defined on the Arakawa C grid.</p> <p>For interface variables, the edges of the tile are computed on both ranks bordering that edge. This routine copies values across those shared edges so that both ranks have the same value for that edge. It also handles any rotation of vector quantities needed to move data across the edge.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity</code> <p>the x-component quantity to be synchronized</p> required <code>y_quantity</code> <code>Quantity</code> <p>the y-component quantity to be synchronized</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdateRequest</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.get_scalar_halo_updater","title":"<code>get_scalar_halo_updater(specifications)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.Communicator.get_vector_halo_updater","title":"<code>get_vector_halo_updater(specifications_x, specifications_y)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator","title":"<code>TileCommunicator</code>","text":"<p>               Bases: <code>Communicator</code></p> <p>Performs communications within a single tile or region of a tile</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.partitioner","title":"<code>partitioner = partitioner</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.tile","title":"<code>tile</code>  <code>property</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.__init__","title":"<code>__init__(comm, partitioner, force_cpu=False, timer=None)</code>","text":"<p>Initialize a TileCommunicator.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm</code> <p>communication object behaving like mpi4py.Comm</p> required <code>partitioner</code> <code>TilePartitioner</code> <p>tile partitioner</p> required <code>force_cpu</code> <code>bool</code> <p>force all communication to go through central memory</p> <code>False</code> <code>timer</code> <code>Timer | None</code> <p>Time communication operations.</p> <code>None</code>"},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.from_layout","title":"<code>from_layout(comm, layout, force_cpu=False, timer=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.start_halo_update","title":"<code>start_halo_update(quantity, n_points)</code>","text":"<p>Start an asynchronous halo update on a quantity.</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity | list[Quantity]</code> <p>the quantity to be updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting from the interior</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdater</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.start_vector_halo_update","title":"<code>start_vector_halo_update(x_quantity, y_quantity, n_points)</code>","text":"<p>Start an asynchronous halo update of a horizontal vector quantity.</p> <p>Assumes the x and y dimension indices are the same between the two quantities.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity | list[Quantity]</code> <p>the x-component quantity to be halo updated</p> required <code>y_quantity</code> <code>Quantity | list[Quantity]</code> <p>the y-component quantity to be halo updated</p> required <code>n_points</code> <code>int</code> <p>how many halo points to update, starting at the interior</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdater</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.TileCommunicator.start_synchronize_vector_interfaces","title":"<code>start_synchronize_vector_interfaces(x_quantity, y_quantity)</code>","text":"<p>Synchronize shared points at the edges of a vector interface variable.</p> <p>Sends the values on the south and west edges to overwrite the values on adjacent subtiles. Vector must be defined on the Arakawa C grid.</p> <p>For interface variables, the edges of the tile are computed on both ranks bordering that edge. This routine copies values across those shared edges so that both ranks have the same value for that edge. It also handles any rotation of vector quantities needed to move data across the edge.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity</code> <p>the x-component quantity to be synchronized</p> required <code>y_quantity</code> <code>Quantity</code> <p>the y-component quantity to be synchronized</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdateRequest</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator","title":"<code>CubedSphereCommunicator</code>","text":"<p>               Bases: <code>Communicator</code></p> <p>Performs communications within a cubed sphere</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator.timer","title":"<code>timer</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator.partitioner","title":"<code>partitioner = partitioner</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator.tile","title":"<code>tile</code>  <code>property</code>","text":"<p>communicator for within a tile</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator.__init__","title":"<code>__init__(comm, partitioner, force_cpu=False, timer=None)</code>","text":"<p>Initialize a CubedSphereCommunicator.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm</code> <p>mpi4py.Comm object</p> required <code>partitioner</code> <code>CubedSpherePartitioner</code> <p>cubed sphere partitioner</p> required <code>force_cpu</code> <code>bool</code> <p>Force all communication to go through central memory.</p> <code>False</code> <code>timer</code> <code>Timer | None</code> <p>Time communication operations.</p> <code>None</code>"},{"location":"docstrings/comm/communicator/#comm.communicator.CubedSphereCommunicator.from_layout","title":"<code>from_layout(comm, layout, force_cpu=False, timer=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.to_numpy","title":"<code>to_numpy(array, dtype=None)</code>","text":"<p>Input array can be a numpy array or a cupy array. Returns numpy array.</p>"},{"location":"docstrings/comm/communicator/#comm.communicator.bcast_metadata_list","title":"<code>bcast_metadata_list(comm, quantity_list)</code>","text":""},{"location":"docstrings/comm/communicator/#comm.communicator.bcast_metadata","title":"<code>bcast_metadata(comm, array)</code>","text":""},{"location":"docstrings/comm/decomposition/","title":"decomposition","text":""},{"location":"docstrings/comm/decomposition/#comm.decomposition.determine_rank_is_compiling","title":"<code>determine_rank_is_compiling(rank, size)</code>","text":"<p>Determines if a rank needs to be a compiling one.</p> <p>Parameters:</p> Name Type Description Default <code>rank</code> <code>int</code> <p>current rank</p> required <code>size</code> <code>int</code> <p>size of the communicator</p> required <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True if the rank is a compiling one</p>"},{"location":"docstrings/comm/decomposition/#comm.decomposition.block_waiting_for_compilation","title":"<code>block_waiting_for_compilation(comm, compilation_config)</code>","text":"<p>Block moving on until an ok is received from the compiling rank.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm</code> <p>communicator over which the ok is sent</p> required <code>compilation_config</code> <code>CompilationConfig</code> <p>holding communicator and rank information</p> required"},{"location":"docstrings/comm/decomposition/#comm.decomposition.unblock_waiting_tiles","title":"<code>unblock_waiting_tiles(comm)</code>","text":"<p>Sends a message to all the ranks waiting for compilation to finish.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm</code> <p>communicator over which the ok is sent</p> required"},{"location":"docstrings/comm/decomposition/#comm.decomposition.check_cached_path_exists","title":"<code>check_cached_path_exists(cache_filepath)</code>","text":""},{"location":"docstrings/comm/decomposition/#comm.decomposition.build_cache_path","title":"<code>build_cache_path(config)</code>","text":"<p>Generate the GT-Cache path from the config.</p> <p>Parameters:</p> Name Type Description Default <code>config</code> <code>CompilationConfig</code> <p>stencil-config object at post-init state</p> required <p>Returns:</p> Type Description <code>tuple[str, str]</code> <p>tuple[str, str]: path and individual rank string</p>"},{"location":"docstrings/comm/decomposition/#comm.decomposition.set_distributed_caches","title":"<code>set_distributed_caches(config)</code>","text":"<p>In Run mode, check required file then point current rank cache to source cache.</p>"},{"location":"docstrings/comm/local_comm/","title":"local_comm","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.ConcurrencyError","title":"<code>ConcurrencyError</code>","text":"<p>               Bases: <code>Exception</code></p> <p>Exception to denote that a rank cannot proceed because it is waiting on a call from another rank.</p>"},{"location":"docstrings/comm/local_comm/#comm.local_comm.AsyncResult","title":"<code>AsyncResult</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.AsyncResult.__init__","title":"<code>__init__(result)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.AsyncResult.wait","title":"<code>wait()</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm","title":"<code>LocalComm</code>","text":"<p>               Bases: <code>Comm[T]</code></p>"},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.rank","title":"<code>rank = rank</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.total_ranks","title":"<code>total_ranks = total_ranks</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.__init__","title":"<code>__init__(rank, total_ranks, buffer_dict)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Get_rank","title":"<code>Get_rank()</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Get_size","title":"<code>Get_size()</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.bcast","title":"<code>bcast(value, root=0)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Barrier","title":"<code>Barrier()</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.barrier","title":"<code>barrier()</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Scatter","title":"<code>Scatter(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Gather","title":"<code>Gather(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.allgather","title":"<code>allgather(sendobj)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Send","title":"<code>Send(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Isend","title":"<code>Isend(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Recv","title":"<code>Recv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Irecv","title":"<code>Irecv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.sendrecv","title":"<code>sendrecv(sendbuf, dest, **kwargs)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Split","title":"<code>Split(color, key)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.allreduce","title":"<code>allreduce(sendobj, op=None, recvobj=None)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Allreduce","title":"<code>Allreduce(sendobj, recvobj, op)</code>","text":""},{"location":"docstrings/comm/local_comm/#comm.local_comm.LocalComm.Allreduce_inplace","title":"<code>Allreduce_inplace(obj, op)</code>","text":""},{"location":"docstrings/comm/mpi/","title":"mpi","text":"<p>Wrapper around mpi4py.</p> <p>This module defines a light-weight wrapper around mpi4py. It is the only place where we directly import from mpi4py. This allows to potentially swap mpi4py in the future.</p>"},{"location":"docstrings/comm/mpi/#comm.mpi.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm","title":"<code>MPIComm</code>","text":"<p>               Bases: <code>Comm</code></p>"},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Get_rank","title":"<code>Get_rank()</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Get_size","title":"<code>Get_size()</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.bcast","title":"<code>bcast(value, root=0)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.barrier","title":"<code>barrier()</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Barrier","title":"<code>Barrier()</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Scatter","title":"<code>Scatter(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Gather","title":"<code>Gather(sendbuf, recvbuf, root=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.allgather","title":"<code>allgather(sendobj)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Send","title":"<code>Send(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.sendrecv","title":"<code>sendrecv(sendbuf, dest, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Isend","title":"<code>Isend(sendbuf, dest, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Recv","title":"<code>Recv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Irecv","title":"<code>Irecv(recvbuf, source, tag=0, **kwargs)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Split","title":"<code>Split(color, key)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.allreduce","title":"<code>allreduce(sendobj, op=ReductionOperator.NO_OP)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Allreduce","title":"<code>Allreduce(sendobj, recvobj, op)</code>","text":""},{"location":"docstrings/comm/mpi/#comm.mpi.MPIComm.Allreduce_inplace","title":"<code>Allreduce_inplace(recvobj, op)</code>","text":""},{"location":"docstrings/comm/partitioner/","title":"partitioner","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.DEFAULT_CACHE_SIZE","title":"<code>DEFAULT_CACHE_SIZE = None</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner","title":"<code>Partitioner</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.tile","title":"<code>tile = tile</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.layout","title":"<code>layout = tuple(layout)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.total_ranks","title":"<code>total_ranks</code>  <code>abstractmethod</code> <code>property</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.__init__","title":"<code>__init__(tile, layout)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.boundary","title":"<code>boundary(boundary_type, rank)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.tile_index","title":"<code>tile_index(rank)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.global_extent","title":"<code>global_extent(rank_metadata)</code>  <code>abstractmethod</code>","text":"<p>Return the shape of a full tile representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>rank_metadata</code> <code>QuantityMetadata</code> <p>quantity metadata</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of full tile representation</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.subtile_slice","title":"<code>subtile_slice(rank, global_dims, global_extent, overlap=False)</code>  <code>abstractmethod</code>","text":"<p>Return the subtile slice of a given rank on an array.</p> <p>Global refers to the domain being partitioned. For example, for a partitioning of a tile, the tile would be the \"global\" domain.</p> <p>Parameters:</p> Name Type Description Default <code>rank</code> <code>int</code> <p>the rank of the process</p> required <code>global_dims</code> <code>Sequence[str]</code> <p>dimensions of the global quantity being partitioned</p> required <code>global_extent</code> <code>Sequence[int]</code> <p>extent of the global quantity being partitioned</p> required <code>overlap</code> <code>optional</code> <p>if True, for interface variables include the part of the array shared by adjacent ranks in both ranks. If False, ensure only one of those ranks (the greater rank) is assigned the overlapping section. Default is False.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>subtile_slice</code> <code>tuple[int | slice, ...]</code> <p>the slice of the global compute domain corresponding to the subtile compute domain</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.Partitioner.subtile_extent","title":"<code>subtile_extent(global_metadata, rank)</code>  <code>abstractmethod</code>","text":"<p>Return the shape of a single rank representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>global_metadata</code> <code>QuantityMetadata</code> <p>quantity metadata.</p> required <code>rank</code> <code>int</code> <p>rank of the process.</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of a single rank representation for the given dimensions.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner","title":"<code>TilePartitioner</code>","text":"<p>               Bases: <code>Partitioner</code></p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.edge_interior_ratio","title":"<code>edge_interior_ratio = edge_interior_ratio</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.total_ranks","title":"<code>total_ranks</code>  <code>property</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.__init__","title":"<code>__init__(layout, edge_interior_ratio=1.0)</code>","text":"<p>Create an object for fv3gfs tile decomposition.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.tile_index","title":"<code>tile_index(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.from_namelist","title":"<code>from_namelist(namelist)</code>  <code>classmethod</code>","text":"<p>Initialize a TilePartitioner from a Fortran namelist.</p> <p>Parameters:</p> Name Type Description Default <code>namelist</code> <code>dict</code> <p>the Fortran namelist</p> required"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.subtile_index","title":"<code>subtile_index(rank)</code>","text":"<p>Return the (y, x) subtile position of a given rank as an integer number of subtiles.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.global_extent","title":"<code>global_extent(rank_metadata)</code>","text":"<p>Return the shape of a full tile representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>rank_metadata</code> <code>Quantity | QuantityMetadata</code> <p>quantity metadata</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of full tile representation</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.subtile_extent","title":"<code>subtile_extent(global_metadata, rank)</code>","text":"<p>Return the shape of a single rank representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>global_metadata</code> <code>QuantityMetadata</code> <p>quantity metadata.</p> required <code>rank</code> <code>int</code> <p>rank of the process.</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of a single rank representation for the given dimensions.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.subtile_slice","title":"<code>subtile_slice(rank, global_dims, global_extent, overlap=False)</code>","text":"<p>Return the subtile slice of a given rank on an array.</p> <p>Global refers to the domain being partitioned. For example, for a partitioning of a tile, the tile would be the \"global\" domain.</p> <p>Parameters:</p> Name Type Description Default <code>rank</code> <code>int</code> <p>the rank of the process</p> required <code>global_dims</code> <code>Sequence[str]</code> <p>dimensions of the global quantity being partitioned</p> required <code>global_extent</code> <code>Sequence[int]</code> <p>extent of the global quantity being partitioned</p> required <code>overlap</code> <code>optional</code> <p>if True, for interface variables include the part of the array shared by adjacent ranks in both ranks. If False, ensure only one of those ranks (the greater rank) is assigned the overlapping section. Default is False.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>subtile_slice</code> <code>tuple[slice, ...]</code> <p>the slice of the global compute domain corresponding to the subtile compute domain</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.on_tile_top","title":"<code>on_tile_top(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.on_tile_bottom","title":"<code>on_tile_bottom(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.on_tile_left","title":"<code>on_tile_left(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.on_tile_right","title":"<code>on_tile_right(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.boundary","title":"<code>boundary(boundary_type, rank)</code>","text":"<p>Returns a boundary of the requested type for a given rank.</p> <p>Target ranks will be on the same tile as the given rank, wrapping around as in a doubly-periodic boundary condition.</p> <p>Parameters:</p> Name Type Description Default <code>boundary_type</code> <code>int</code> <p>the type of boundary</p> required <code>rank</code> <code>int</code> <p>the processor rank</p> required <p>Returns:</p> Type Description <code>SimpleBoundary | None</code> <p>boundary</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.fliplr_rank","title":"<code>fliplr_rank(rank)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.TilePartitioner.rotate_rank","title":"<code>rotate_rank(rank, n_clockwise_rotations)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner","title":"<code>CubedSpherePartitioner</code>","text":"<p>               Bases: <code>Partitioner</code></p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.total_ranks","title":"<code>total_ranks</code>  <code>property</code>","text":"<p>the number of ranks on the cubed sphere</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.__init__","title":"<code>__init__(tile)</code>","text":"<p>Create an object for fv3gfs cubed-sphere domain decomposition.</p> <p>Parameters:</p> Name Type Description Default <code>tile</code> <code>TilePartitioner</code> <p>partitioner for the cube faces</p> required"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.from_namelist","title":"<code>from_namelist(namelist)</code>  <code>classmethod</code>","text":"<p>Initialize a CubedSpherePartitioner from a Fortran namelist.</p> <p>Parameters:</p> Name Type Description Default <code>namelist</code> <code>dict</code> <p>the Fortran namelist</p> required"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.tile_index","title":"<code>tile_index(rank)</code>","text":"<p>Returns the tile index of a given rank</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.tile_root_rank","title":"<code>tile_root_rank(rank)</code>","text":"<p>Returns the lowest rank on the same tile as a given rank.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.boundary","title":"<code>boundary(boundary_type, rank)</code>","text":"<p>Returns a boundary of the requested type for a given rank, or None.</p> <p>On tile corners, the boundary across that corner does not exist.</p> <p>Parameters:</p> Name Type Description Default <code>boundary_type</code> <code>int</code> <p>the type of boundary</p> required <code>rank</code> <code>int</code> <p>the processor rank</p> required <p>Returns:</p> Type Description <code>SimpleBoundary | None</code> <p>boundary</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.global_extent","title":"<code>global_extent(rank_metadata)</code>","text":"<p>Return the shape of a full cube representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>rank_metadata</code> <code>QuantityMetadata</code> <p>quantity metadata</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of full cube representation</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.subtile_extent","title":"<code>subtile_extent(cube_metadata, rank)</code>","text":"<p>Return the shape of a single rank representation for the given dimensions.</p> <p>Parameters:</p> Name Type Description Default <code>cube_metadata</code> <code>QuantityMetadata</code> <p>quantity metadata.</p> required <code>rank</code> <code>int</code> <p>rank of the process.</p> required <p>Returns:</p> Name Type Description <code>extent</code> <code>tuple[int, ...]</code> <p>shape of a single rank representation for the given dimensions.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.CubedSpherePartitioner.subtile_slice","title":"<code>subtile_slice(rank, global_dims, global_extent, overlap=False)</code>","text":"<p>Return the subtile slice of a given rank on an array.</p> <p>Global refers to the domain being partitioned. For example, for a partitioning of a tile, the tile would be the \"global\" domain.</p> <p>Parameters:</p> Name Type Description Default <code>rank</code> <code>int</code> <p>the rank of the process</p> required <code>global_dims</code> <code>Sequence[str]</code> <p>dimensions of the global quantity being partitioned</p> required <code>global_extent</code> <code>Sequence[int]</code> <p>extent of the global quantity being partitioned</p> required <code>overlap</code> <code>optional</code> <p>if True, for interface variables include the part of the array shared by adjacent ranks in both ranks. If False, ensure only one of those ranks (the greater rank) is assigned the overlapping section. Default is False.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>subtile_slice</code> <code>tuple[int | slice, ...]</code> <p>the tuple slice of the global compute domain corresponding to the subtile compute domain</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.get_tile_index","title":"<code>get_tile_index(rank, total_ranks)</code>","text":"<p>Returns the zero-indexed tile number, given a rank and total number of ranks.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.on_tile_left","title":"<code>on_tile_left(subtile_index)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.on_tile_right","title":"<code>on_tile_right(subtile_index, layout)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.on_tile_top","title":"<code>on_tile_top(subtile_index, layout)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.on_tile_bottom","title":"<code>on_tile_bottom(subtile_index)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.rotate_subtile_rank","title":"<code>rotate_subtile_rank(rank, layout, n_clockwise_rotations)</code>","text":"<p>Returns the rank position where this rank would be if you rotated the tile n_clockwise_rotations times.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.transpose_subtile_rank","title":"<code>transpose_subtile_rank(rank, layout)</code>","text":"<p>Returns the rank position where this rank would be if you transposed the tile.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.fliplr_subtile_rank","title":"<code>fliplr_subtile_rank(rank, layout)</code>","text":"<p>Returns the rank position where this rank would be if you flipped the tile along a vertical axis</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.flipud_subtile_rank","title":"<code>flipud_subtile_rank(rank, layout)</code>","text":"<p>Returns the rank position where this rank would be if you flipped the tile along a horizontal axis</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.transform_subtile_rank","title":"<code>transform_subtile_rank(transform_func, rank, layout)</code>","text":"<p>Returns the rank position where this rank would be if you performed a transformation on the tile which strictly moves ranks.</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.subtile_index","title":"<code>subtile_index(rank, ranks_per_tile, layout)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.is_even","title":"<code>is_even(value)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.tile_extent_from_rank_metadata","title":"<code>tile_extent_from_rank_metadata(dims, rank_extent, layout, edge_interior_ratio=1.0)</code>","text":"<p>Returns the extent of a tile given data about a single rank, and the tile layout.</p> <p>Parameters:</p> Name Type Description Default <code>dims</code> <code>Sequence[str]</code> <p>dimension names</p> required <code>rank_extent</code> <code>Sequence[int]</code> <p>the extent of one rank</p> required <code>layout</code> <code>tuple[int, int]</code> <p>the (y, x) number of ranks along each tile axis</p> required <code>edge_interior_ratio</code> <code>float</code> <p>target value for the relative 1-dimensional extent of the compute domains of ranks on tile edges and corners compared to ranks on the tile interior. In all cases, the closest valid value will be used, which enables some previously invalid configurations (e.g. C128 on a 3 by 3 layout will use the closest valid edge_interior_ratio to 1.0).</p> <code>1.0</code> <p>Returns:</p> Name Type Description <code>tile_extent</code> <code>tuple[int, ...]</code> <p>the extent of one tile</p>"},{"location":"docstrings/comm/partitioner/#comm.partitioner.rank_slice_from_tile_metadata","title":"<code>rank_slice_from_tile_metadata(dims, *, extent, layout, subtile_index, edge_interior_ratio, overlap)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.discard_dimension","title":"<code>discard_dimension(dims, dim_name, data)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.extent_from_metadata","title":"<code>extent_from_metadata(dims, extent, layout_factors)</code>","text":""},{"location":"docstrings/comm/partitioner/#comm.partitioner.subtile_slice","title":"<code>subtile_slice(dims, global_extent, layout, subtile_index, edge_interior_ratio=1.0, overlap=False)</code>","text":"<p>Returns the slice of data within a tile's computational domain belonging to a single rank.</p> <p>Parameters:</p> Name Type Description Default <code>dims</code> <code>Sequence[str]</code> <p>dimension names for each axis</p> required <code>global_extent</code> <code>Sequence[int]</code> <p>size of the tile or cube's computational domain</p> required <code>layout</code> <code>tuple[int, int]</code> <p>the (y, x) number of ranks along each tile axis</p> required <code>subtile_index</code> <code>tuple[int, int]</code> <p>the (y, x) position of the rank on the tile</p> required <code>edge_interior_ratio</code> <code>float</code> <p>target value for the relative 1-dimensional extent of the compute domains of ranks on tile edges and corners compared to ranks on the tile interior. In all cases, the closest valid value will be used, which enables some previously invalid configurations (e.g. C128 on a 3 by 3 layout will use the closest valid edge_interior_ratio to 1.0).</p> <code>1.0</code> <code>overlap</code> <code>optional</code> <p>if True, for interface variables include the part of the array shared by adjacent ranks in both ranks. If False, ensure only one of those ranks (the greater rank) is assigned the overlapping section. Default is False.</p> <code>False</code>"},{"location":"docstrings/debug/config/","title":"config","text":"<p>This module provides configuration for the global debugger <code>ndsl_debugger</code></p> <p>When loading, the configuration will be searched in the global environment variable <code>NDSL_DEBUG_CONFIG</code></p> <p>Configuration is a yaml file of the shape <pre><code>stencils_or_class:\n  - copy_corners_x_nord\n  - copy_corners_y_nord\n  - DGridShallowWaterLagrangianDynamics.__call__\ntrack_parameter_by_name:\n  - fy\n</code></pre></p> <p>Global variable</p> <p>ndsl_debugger: Debugger accessible throughout the middleware, default to <code>None</code>     if there is no configuration</p>"},{"location":"docstrings/debug/config/#debug.config.ndsl_debugger","title":"<code>ndsl_debugger = None</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/debug/debugger/","title":"debugger","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger","title":"<code>Debugger</code>  <code>dataclass</code>","text":"<p>Debugger relying on <code>ndsl.debug.config</code> for setup capable of doing automatic data save on external configuration.</p>"},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.stencils_or_class","title":"<code>stencils_or_class = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.track_parameter_by_name","title":"<code>track_parameter_by_name = dataclasses.field(default_factory=list)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.save_compute_domain_only","title":"<code>save_compute_domain_only = False</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.dir_name","title":"<code>dir_name = './'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.rank","title":"<code>rank = -1</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.calls_count","title":"<code>calls_count = dataclasses.field(default_factory=dict)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.track_parameter_count","title":"<code>track_parameter_count = dataclasses.field(default_factory=dict)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.__init__","title":"<code>__init__(stencils_or_class=list(), track_parameter_by_name=list(), save_compute_domain_only=False, dir_name='./', rank=-1, calls_count=dict(), track_parameter_count=dict())</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.track_data","title":"<code>track_data(data_as_dict, source_as_name, is_in)</code>","text":""},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.save_as_dataset","title":"<code>save_as_dataset(data_as_dict, savename, is_in)</code>","text":"<p>Save dictionary of data to NetCDF</p> <p>Note: Unknown types in the dictionary won't be saved.</p>"},{"location":"docstrings/debug/debugger/#debug.debugger.Debugger.increment_call_count","title":"<code>increment_call_count(savename)</code>","text":"<p>Increment the call count for this savename</p>"},{"location":"docstrings/debug/tooling/","title":"tooling","text":""},{"location":"docstrings/debug/tooling/#debug.tooling.instrument","title":"<code>instrument(func)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/","title":"gt4py_utils","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.managed_memory","title":"<code>managed_memory = True</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.origin","title":"<code>origin = (N_HALO_DEFAULT, N_HALO_DEFAULT, 0)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.tracer_variables","title":"<code>tracer_variables = ['qvapor', 'qliquid', 'qrain', 'qice', 'qsnow', 'qgraupel', 'qo3mr', 'qsgs_tke', 'qcld']</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.mark_untested","title":"<code>mark_untested(msg='This is not tested')</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.make_storage_data","title":"<code>make_storage_data(data, shape=None, origin=origin, *, backend, dtype=Float, mask=None, start=(0, 0, 0), dummy=None, axis=2, max_dim=3, read_only=True)</code>","text":"<p>Create a new gt4py storage from the given data.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>NDArray</code> <p>Data array for new storage</p> required <code>shape</code> <code>tuple[int, ...] | None</code> <p>Shape of the new storage. Number of indices should be equal to number of unmasked axes</p> <code>None</code> <code>origin</code> <code>tuple[int, ...]</code> <p>Default origin for gt4py stencil calls</p> <code>origin</code> <code>dtype</code> <code>DTypes</code> <p>Data type</p> <code>Float</code> <code>mask</code> <code>tuple[bool, ...] | None</code> <p>Tuple indicating the axes used when initializing the storage. True indicates a masked axis, False is a used axis.</p> <code>None</code> <code>start</code> <code>tuple[int, ...]</code> <p>Starting points for slices in data copies</p> <code>(0, 0, 0)</code> <code>dummy</code> <code>tuple[int, ...] | None</code> <p>Dummy axes</p> <code>None</code> <code>axis</code> <code>int</code> <p>Axis for 2D to 3D arrays</p> <code>2</code> <code>backend</code> <code>str</code> <p>gt4py backend to use</p> required <p>Returns:</p> Type Description <code>NDArray</code> <p>Field[..., dtype]: New storage</p> <p>Examples:</p> <p>1) ptop = utils.make_storage_data(top_p, q4_1.shape) 2) ws3 = utils.make_storage_data(ws3[:, :, -1], shape, origin=(0, 0, 0)) 3) data_dict[names[i]] = make_storage_data(        data[:, :, :, i],        shape,        origin=origin,        start=start,        dummy=dummy,        axis=axis,    )</p>"},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.make_storage_from_shape","title":"<code>make_storage_from_shape(shape, origin=origin, *, backend, dtype=Float, mask=None)</code>","text":"<p>Create a new gt4py storage of a given shape filled with zeros.</p> <p>Parameters:</p> Name Type Description Default <code>shape</code> <code>tuple[int, ...]</code> <p>Shape of the new storage</p> required <code>origin</code> <code>tuple[int, ...]</code> <p>Default origin for gt4py stencil calls</p> <code>origin</code> <code>dtype</code> <code>DTypes</code> <p>Data type</p> <code>Float</code> <code>mask</code> <code>tuple[bool, ...] | None</code> <p>Tuple indicating the axes used when initializing the storage</p> <code>None</code> <code>backend</code> <code>str</code> <p>gt4py backend to use when making the storage</p> required <p>Returns:</p> Type Description <code>NDArray</code> <p>Field[..., dtype]: New storage</p> <p>Examples:</p> <p>1) utmp = utils.make_storage_from_shape(ua.shape) 2) qx = utils.make_storage_from_shape(        qin.shape, origin=(grid().is_, grid().jsd, kstart)    ) 3) q_out = utils.make_storage_from_shape(q_in.shape, origin,)</p>"},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.make_storage_dict","title":"<code>make_storage_dict(data, shape=None, origin=origin, start=(0, 0, 0), dummy=None, names=None, axis=2, *, backend, dtype=Float)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.storage_dict","title":"<code>storage_dict(st_dict, names, shape, origin, *, backend)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.get_kstarts","title":"<code>get_kstarts(column_info, npz)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.k_split_run","title":"<code>k_split_run(func, data, k_indices, splitvars_values)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.asarray","title":"<code>asarray(array, to_type=np.ndarray, dtype=None, order=None)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.is_gpu_backend","title":"<code>is_gpu_backend(backend)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.backend_is_fortran_aligned","title":"<code>backend_is_fortran_aligned(backend)</code>","text":"<p>Check that the standard 3D field on cartesian axis is memory-aligned with Fortran striding.</p>"},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.zeros","title":"<code>zeros(shape, dtype=Float, *, backend)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.sum","title":"<code>sum(array, axis=None, dtype=Float, out=None, keepdims=False)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.repeat","title":"<code>repeat(array, repeats, axis=None)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.index","title":"<code>index(array, key)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.moveaxis","title":"<code>moveaxis(array, source, destination)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.tile","title":"<code>tile(array, reps)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.squeeze","title":"<code>squeeze(array, axis=None)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.reshape","title":"<code>reshape(array, new_shape)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.unique","title":"<code>unique(array, return_index=False, return_inverse=False, return_counts=False, axis=None)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.stack","title":"<code>stack(tup, axis=0, out=None)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.device_sync","title":"<code>device_sync(backend)</code>","text":""},{"location":"docstrings/dsl/gt4py_utils/#dsl.gt4py_utils.split_cartesian_into_storages","title":"<code>split_cartesian_into_storages(var)</code>","text":"<p>Provided a storage of dims [I_DIM, J_DIM, CARTESIAN_DIM]      or [I_INTERFACE_DIM, J_INTERFACE_DIM, CARTESIAN_DIM] Split it into separate 2D storages for each cartesian dimension, and return these in a list.</p>"},{"location":"docstrings/dsl/stencil/","title":"stencil","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector","title":"<code>TimingCollector</code>  <code>dataclass</code>","text":"<p>Attributes:</p> Name Type Description <code>build_info</code> <code>dict[str, dict]</code> <p>contains info about the generation process for each stencil.</p> <code>exec_info</code> <code>dict[str, Any]</code> <p>contains info about the execution of each stencil.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector.build_info","title":"<code>build_info = dataclasses.field(default_factory=dict)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector.exec_info","title":"<code>exec_info = dataclasses.field(default_factory=(lambda: {'__aggregate_data': True}))</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector.__init__","title":"<code>__init__(build_info=dict(), exec_info=(lambda: {'__aggregate_data': True})())</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector.build_report","title":"<code>build_report(key='build_time', **kwargs)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.TimingCollector.exec_report","title":"<code>exec_report(key='total_run_time', **kwargs)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.CompareToNumpyStencil","title":"<code>CompareToNumpyStencil</code>","text":"<p>A wrapper over FrozenStencil which executes a numpy version of the stencil as well, and compares the results.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.CompareToNumpyStencil.__init__","title":"<code>__init__(func, origin, domain, stencil_config, externals=None, skip_passes=(), timing_collector=None, comm=None)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.CompareToNumpyStencil.__call__","title":"<code>__call__(*args, **kwargs)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil","title":"<code>FrozenStencil</code>","text":"<p>               Bases: <code>SDFGConvertible</code></p> <p>Wrapper for gt4py stencils which stores origin and domain at compile time, and uses their stored values at call time.</p> <p>This is useful when the stencil itself is meant to be used on a certain grid, for example if a compile-time external variable is tied to the values of origin and domain.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.origin","title":"<code>origin = origin</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.domain","title":"<code>domain = cast_to_index3d(domain)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.stencil_config","title":"<code>stencil_config = stencil_config</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.comm","title":"<code>comm = comm</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.externals","title":"<code>externals = externals</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.stencil_object","title":"<code>stencil_object</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.__init__","title":"<code>__init__(func, origin, domain, stencil_config, externals=None, skip_passes=(), timing_collector=None, comm=None)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>func</code> <code>Callable[..., None]</code> <p>stencil definition function</p> required <code>origin</code> <code>tuple[int, ...] | Mapping[str, tuple[int, ...]]</code> <p>gt4py origin to use at call time</p> required <code>domain</code> <code>tuple[int, ...]</code> <p>gt4py domain to use at call time</p> required <code>stencil_config</code> <code>StencilConfig</code> <p>container for stencil configuration</p> required <code>externals</code> <code>Mapping[str, Any] | None</code> <p>compile-time external variables required by stencil</p> <code>None</code> <code>skip_passes</code> <code>tuple[str, ...]</code> <p>compiler passes to skip when building stencil</p> <code>()</code> <code>timing_collector</code> <code>TimingCollector | None</code> <p>Optional object that accumulates timings</p> <code>None</code> <code>comm</code> <code>Comm | None</code> <p>if given, inputs and outputs will be compared to the \"twin\" rank of this rank</p> <code>None</code>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.__call__","title":"<code>__call__(*args, **kwargs)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.FrozenStencil.closure_resolver","title":"<code>closure_resolver(constant_args, given_args, parent_closure=None)</code>","text":"<p>Implemented SDFG closure resolver build</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing","title":"<code>GridIndexing</code>","text":"<p>Provides indices for cell-centered variables with halos.</p> <p>These indices can be used with horizontal interface variables by adding 1 to the domain shape along any interface axis.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.origin","title":"<code>origin = (n_halo, n_halo, k_start)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.n_halo","title":"<code>n_halo = n_halo</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.domain","title":"<code>domain = domain</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.south_edge","title":"<code>south_edge = south_edge</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.north_edge","title":"<code>north_edge = north_edge</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.west_edge","title":"<code>west_edge = west_edge</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.east_edge","title":"<code>east_edge = east_edge</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.max_shape","title":"<code>max_shape</code>  <code>property</code>","text":"<p>Maximum required storage shape, corresponding to the shape of a cell-corner variable with maximum halo points.</p> <p>This should rarely be required, consider using appropriate calls to helper methods that get the correct shape for your particular variable.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.isc","title":"<code>isc</code>  <code>property</code>","text":"<p>Start of the compute domain along the x-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.iec","title":"<code>iec</code>  <code>property</code>","text":"<p>Last index of the compute domain along the x-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.jsc","title":"<code>jsc</code>  <code>property</code>","text":"<p>Start of the compute domain along the y-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.jec","title":"<code>jec</code>  <code>property</code>","text":"<p>Last index of the compute domain along the y-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.isd","title":"<code>isd</code>  <code>property</code>","text":"<p>Start of the full domain including halos along the x-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.ied","title":"<code>ied</code>  <code>property</code>","text":"<p>Index of the last data point along the x-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.jsd","title":"<code>jsd</code>  <code>property</code>","text":"<p>Start of the full domain including halos along the y-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.jed","title":"<code>jed</code>  <code>property</code>","text":"<p>Index of the last data point along the y-axis</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.nw_corner","title":"<code>nw_corner</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.sw_corner","title":"<code>sw_corner</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.ne_corner","title":"<code>ne_corner</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.se_corner","title":"<code>se_corner</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.__init__","title":"<code>__init__(domain, n_halo, south_edge, north_edge, west_edge, east_edge, *, k_start=0)</code>","text":"<p>Initialize a grid indexing object.</p> <p>Parameters:</p> Name Type Description Default <code>domain</code> <code>Index3D</code> <p>size of the compute domain for cell-centered variables</p> required <code>n_halo</code> <code>int</code> <p>number of halo points</p> required <code>south_edge</code> <code>bool</code> <p>whether the current rank is on the south edge of a tile</p> required <code>north_edge</code> <code>bool</code> <p>whether the current rank is on the north edge of a tile</p> required <code>west_edge</code> <code>bool</code> <p>whether the current rank is on the west edge of a tile</p> required <code>east_edge</code> <code>bool</code> <p>whether the current rank is on the east edge of a tile</p> required"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.from_sizer_and_communicator","title":"<code>from_sizer_and_communicator(sizer, comm)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.origin_full","title":"<code>origin_full(add=(0, 0, 0))</code>","text":"<p>Returns the origin of the full domain including halos, plus an optional offset.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.origin_compute","title":"<code>origin_compute(add=(0, 0, 0))</code>","text":"<p>Returns the origin of the compute domain, plus an optional offset</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.domain_full","title":"<code>domain_full(add=(0, 0, 0))</code>","text":"<p>Returns the shape of the full domain including halos, plus an optional offset.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.domain_compute","title":"<code>domain_compute(add=(0, 0, 0))</code>","text":"<p>Returns the shape of the compute domain, plus an optional offset.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.axis_offsets","title":"<code>axis_offsets(origin, domain)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.get_origin_domain","title":"<code>get_origin_domain(dims, halos=tuple())</code>","text":"<p>Get the origin and domain for a computation that occurs over a certain grid configuration (given by dims) and a certain number of halo points.</p> <p>Parameters:</p> Name Type Description Default <code>dims</code> <code>Sequence[str]</code> <p>dimension names, using dimension constants from ndsl.constants</p> required <code>halos</code> <code>Sequence[int]</code> <p>number of halo points for each dimension, defaults to zero</p> <code>tuple()</code> <p>Returns:</p> Name Type Description <code>origin</code> <code>tuple[int, ...]</code> <p>origin of the computation</p> <code>domain</code> <code>tuple[int, ...]</code> <p>shape of the computation</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.get_2d_compute_origin_domain","title":"<code>get_2d_compute_origin_domain(klevel=0)</code>","text":"<p>Get the origin and domain for a computation that occurs on the lowest klevel over a certain grid configuration (given by dims) and a certain number of halo points.</p> <p>Parameters:</p> Name Type Description Default <code>klevel</code> <code>int</code> <p>the vertical level of the domain, defaults to zero</p> <code>0</code> <p>Returns:</p> Name Type Description <code>origin</code> <code>tuple[int, ...]</code> <p>origin of the computation</p> <code>domain</code> <code>tuple[int, ...]</code> <p>shape of the computation</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.get_shape","title":"<code>get_shape(dims, halos=tuple())</code>","text":"<p>Get the storage shape required for an array with the given dimensions which is accessed up to a given number of halo points.</p> <p>Parameters:</p> Name Type Description Default <code>dims</code> <code>Sequence[str]</code> <p>dimension names, using dimension constants from ndsl.constants</p> required <code>halos</code> <code>Sequence[int]</code> <p>number of halo points for each dimension, defaults to zero</p> <code>tuple()</code> <p>Returns:</p> Name Type Description <code>shape</code> <code>tuple[int, ...]</code> <p>storage required for an array with the given dimensions</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.GridIndexing.restrict_vertical","title":"<code>restrict_vertical(k_start=0, nk=None)</code>","text":"<p>Returns a copy of itself with modified vertical origin and domain.</p> <p>Parameters:</p> Name Type Description Default <code>k_start</code> <code>int</code> <p>offset to apply to current vertical origin, must be greater than 0 and less than the size of the vertical domain</p> <code>0</code> <code>nk</code> <code>int | None</code> <p>new vertical domain size as a number of grid cells, defaults to remaining grid cells in the current domain, can be at most the size of the vertical domain minus k_start</p> <code>None</code>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory","title":"<code>StencilFactory</code>","text":"<p>Configurable class which creates stencil objects.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.config","title":"<code>config = config</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.grid_indexing","title":"<code>grid_indexing = grid_indexing</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.timing_collector","title":"<code>timing_collector = TimingCollector()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.comm","title":"<code>comm = comm</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.backend","title":"<code>backend</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.__init__","title":"<code>__init__(config, grid_indexing, comm=None)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>config</code> <code>StencilConfig</code> <p>gt4py-specific stencil configuration</p> required <code>grid_indexing</code> <code>GridIndexing</code> <p>configuration for domain and halo indexing</p> required <code>comm</code> <code>Comm | None</code> <p>if given, stencils will compare all data before and after stencil execution to their \"pair\" rank on the comm. This is very expensive and only used for debugging.</p> <code>None</code>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.from_origin_domain","title":"<code>from_origin_domain(func, origin, domain, externals=None, skip_passes=())</code>","text":"<p>Parameters:</p> Name Type Description Default <code>func</code> <code>Callable[..., None]</code> <p>stencil definition function</p> required <code>origin</code> <code>tuple[int, ...] | Mapping[str, tuple[int, ...]]</code> <p>gt4py origin to use at call time</p> required <code>domain</code> <code>tuple[int, ...]</code> <p>gt4py domain to use at call time</p> required <code>externals</code> <code>Mapping[str, Any] | None</code> <p>compile-time external variables required by stencil</p> <code>None</code> <code>skip_passes</code> <code>tuple[str, ...]</code> <p>compiler passes to skip when building stencil</p> <code>()</code>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.from_dims_halo","title":"<code>from_dims_halo(func, compute_dims, compute_halos=tuple(), externals=None, skip_passes=())</code>","text":"<p>Initialize a stencil from dimensions and number of halo points.</p> <p>Automatically injects axis_offsets into stencil externals.</p> <p>Parameters:</p> Name Type Description Default <code>func</code> <code>Callable[..., None]</code> <p>stencil definition function</p> required <code>compute_dims</code> <code>Sequence[str]</code> <p>dimensionality of compute domain</p> required <code>compute_halos</code> <code>Sequence[int]</code> <p>number of halo points to include in compute domain</p> <code>tuple()</code> <code>externals</code> <code>Mapping[str, Any] | None</code> <p>compile-time external variables required by stencil</p> <code>None</code> <code>skip_passes</code> <code>tuple[str, ...]</code> <p>compiler passes to skip when building stencil</p> <code>()</code>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.restrict_vertical","title":"<code>restrict_vertical(k_start=0, nk=None)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.build_report","title":"<code>build_report(key='build_time', **kwargs)</code>","text":"<p>Report all stencils built by this factory.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.StencilFactory.exec_report","title":"<code>exec_report(key='total_run_time', **kwargs)</code>","text":"<p>Report all stencils executed that were built by this factory.</p>"},{"location":"docstrings/dsl/stencil/#dsl.stencil.report_difference","title":"<code>report_difference(args, kwargs, args_copy, kwargs_copy, function_name, gt_id)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.report_diff","title":"<code>report_diff(arg, numpy_arg, label)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.get_pair_rank","title":"<code>get_pair_rank(rank, size)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.compare_ranks","title":"<code>compare_ranks(comm, data)</code>","text":""},{"location":"docstrings/dsl/stencil/#dsl.stencil.get_stencils_with_varied_bounds","title":"<code>get_stencils_with_varied_bounds(func, origins, domains, stencil_factory, externals=None)</code>","text":""},{"location":"docstrings/dsl/stencil_config/","title":"stencil_config","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.RunMode","title":"<code>RunMode</code>","text":"<p>               Bases: <code>Enum</code></p> <p>Run-Mode for the model     Build: compile &amp; save compiled files only     BuildAndRun: compile &amp; save compiled files, then run     Run: load from .so and run, will fail if .so is not available</p>"},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.RunMode.Build","title":"<code>Build = 0</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.RunMode.BuildAndRun","title":"<code>BuildAndRun = 1</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.RunMode.Run","title":"<code>Run = 2</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig","title":"<code>CompilationConfig</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.backend","title":"<code>backend = backend</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.rebuild","title":"<code>rebuild = rebuild</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.validate_args","title":"<code>validate_args = validate_args</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.format_source","title":"<code>format_source = format_source</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.device_sync","title":"<code>device_sync = device_sync</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.run_mode","title":"<code>run_mode = run_mode</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.use_minimal_caching","title":"<code>use_minimal_caching = use_minimal_caching</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.__init__","title":"<code>__init__(backend='numpy', rebuild=True, validate_args=True, format_source=False, device_sync=False, run_mode=RunMode.BuildAndRun, use_minimal_caching=False, communicator=None)</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.check_communicator","title":"<code>check_communicator(communicator)</code>","text":"<p>Checks that the communicator has a square layout</p> <p>Parameters:</p> Name Type Description Default <code>communicator</code> <code>Communicator</code> <p>communicator to use</p> required <p>Raises:</p> Type Description <code>RuntimeError</code> <p>If non-square layout is given</p>"},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.determine_compiling_equivalent","title":"<code>determine_compiling_equivalent(rank, partitioner)</code>","text":"<p>From my rank &amp; the current partitioner we determine which rank we should read from</p>"},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.get_decomposition_info_from_comm","title":"<code>get_decomposition_info_from_comm(communicator)</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.as_dict","title":"<code>as_dict()</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.CompilationConfig.from_dict","title":"<code>from_dict(data)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig","title":"<code>StencilConfig</code>  <code>dataclass</code>","text":"<p>               Bases: <code>Hashable</code></p>"},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.compare_to_numpy","title":"<code>compare_to_numpy = compare_to_numpy</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.compilation_config","title":"<code>compilation_config = compilation_config</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.verbose","title":"<code>verbose = verbose</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.dace_config","title":"<code>dace_config = dace_config if dace_config is not None else DaceConfig(communicator=None, backend=(self.compilation_config.backend), orchestration=(DaCeOrchestration.Python))</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.backend_opts","title":"<code>backend_opts = {'device_sync': self.compilation_config.device_sync, 'format_source': self.compilation_config.format_source}</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.backend","title":"<code>backend</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.is_gpu_backend","title":"<code>is_gpu_backend</code>  <code>property</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.__init__","title":"<code>__init__(*, compare_to_numpy=False, compilation_config=None, verbose=False, dace_config=None)</code>","text":""},{"location":"docstrings/dsl/stencil_config/#dsl.stencil_config.StencilConfig.stencil_kwargs","title":"<code>stencil_kwargs(*, func, skip_passes=())</code>","text":""},{"location":"docstrings/dsl/typing/","title":"typing","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.Field","title":"<code>Field = gtscript.Field</code>  <code>module-attribute</code>","text":"<p>A gt4py field</p>"},{"location":"docstrings/dsl/typing/#dsl.typing.IJK","title":"<code>IJK = gtscript.IJK</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IJ","title":"<code>IJ = gtscript.IJ</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IK","title":"<code>IK = gtscript.IK</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.JK","title":"<code>JK = gtscript.JK</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.I","title":"<code>I = gtscript.I</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.J","title":"<code>J = gtscript.J</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.K","title":"<code>K = gtscript.K</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.DTypes","title":"<code>DTypes = bool | np.bool_ | int | np.int32 | np.int64 | float | np.float32 | np.float64</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.NDSL_32BIT_FLOAT_TYPE","title":"<code>NDSL_32BIT_FLOAT_TYPE = np.float32</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.NDSL_64BIT_FLOAT_TYPE","title":"<code>NDSL_64BIT_FLOAT_TYPE = np.float64</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.NDSL_32BIT_INT_TYPE","title":"<code>NDSL_32BIT_INT_TYPE = np.int32</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.NDSL_64BIT_INT_TYPE","title":"<code>NDSL_64BIT_INT_TYPE = np.int64</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.Bool","title":"<code>Bool = np.bool_</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatField","title":"<code>FloatField = Field[gtscript.IJK, Float]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatField64","title":"<code>FloatField64 = Field[gtscript.IJK, np.float64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatField32","title":"<code>FloatField32 = Field[gtscript.IJK, np.float32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldI","title":"<code>FloatFieldI = Field[gtscript.I, Float]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldI64","title":"<code>FloatFieldI64 = Field[gtscript.I, np.float64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldI32","title":"<code>FloatFieldI32 = Field[gtscript.I, np.float32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldJ","title":"<code>FloatFieldJ = Field[gtscript.J, Float]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldJ64","title":"<code>FloatFieldJ64 = Field[gtscript.J, np.float64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldJ32","title":"<code>FloatFieldJ32 = Field[gtscript.J, np.float32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldIJ","title":"<code>FloatFieldIJ = Field[gtscript.IJ, Float]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldIJ64","title":"<code>FloatFieldIJ64 = Field[gtscript.IJ, np.float64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldIJ32","title":"<code>FloatFieldIJ32 = Field[gtscript.IJ, np.float32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldK","title":"<code>FloatFieldK = Field[gtscript.K, Float]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldK64","title":"<code>FloatFieldK64 = Field[gtscript.K, np.float64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.FloatFieldK32","title":"<code>FloatFieldK32 = Field[gtscript.K, np.float32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntField","title":"<code>IntField = Field[gtscript.IJK, Int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntField64","title":"<code>IntField64 = Field[gtscript.IJK, np.int64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntField32","title":"<code>IntField32 = Field[gtscript.IJK, np.int32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldI","title":"<code>IntFieldI = Field[gtscript.I, Int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldI64","title":"<code>IntFieldI64 = Field[gtscript.I, np.int64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldI32","title":"<code>IntFieldI32 = Field[gtscript.I, np.int32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldJ","title":"<code>IntFieldJ = Field[gtscript.J, Int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldJ64","title":"<code>IntFieldJ64 = Field[gtscript.J, np.int64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldJ32","title":"<code>IntFieldJ32 = Field[gtscript.J, np.int32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldIJ","title":"<code>IntFieldIJ = Field[gtscript.IJ, Int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldIJ64","title":"<code>IntFieldIJ64 = Field[gtscript.IJ, np.int64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldIJ32","title":"<code>IntFieldIJ32 = Field[gtscript.IJ, np.int32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldK","title":"<code>IntFieldK = Field[gtscript.K, Int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldK64","title":"<code>IntFieldK64 = Field[gtscript.K, np.int64]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.IntFieldK32","title":"<code>IntFieldK32 = Field[gtscript.K, np.int32]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.BoolField","title":"<code>BoolField = Field[gtscript.IJK, Bool]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.BoolFieldI","title":"<code>BoolFieldI = Field[gtscript.I, Bool]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.BoolFieldJ","title":"<code>BoolFieldJ = Field[gtscript.J, Bool]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.BoolFieldK","title":"<code>BoolFieldK = Field[gtscript.K, Bool]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.BoolFieldIJ","title":"<code>BoolFieldIJ = Field[gtscript.IJ, Bool]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.Index3D","title":"<code>Index3D = tuple[int, int, int]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.get_precision","title":"<code>get_precision()</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.global_set_precision","title":"<code>global_set_precision()</code>","text":"<p>Set the global precision for all references of Float and Int in the codebase. Defaults to 64 bit.</p>"},{"location":"docstrings/dsl/typing/#dsl.typing.set_4d_field_size","title":"<code>set_4d_field_size(n, dtype)</code>","text":"<p>Defines a 4D field with a given size and type The extra data dimension is not parallel</p>"},{"location":"docstrings/dsl/typing/#dsl.typing.cast_to_index3d","title":"<code>cast_to_index3d(val)</code>","text":""},{"location":"docstrings/dsl/typing/#dsl.typing.is_float","title":"<code>is_float(dtype)</code>","text":"<p>Expected floating point type</p>"},{"location":"docstrings/grid/eta/","title":"eta","text":""},{"location":"docstrings/grid/eta/#grid.eta.ETA_0","title":"<code>ETA_0 = 0.252</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.SURFACE_PRESSURE","title":"<code>SURFACE_PRESSURE = 100000.0</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients","title":"<code>HybridPressureCoefficients</code>  <code>dataclass</code>","text":"<p>Attributes:</p> Name Type Description <code>-</code> <code>ks</code> <p>The number of pure-pressure layers at the top of the model   Also the level where model transitions from pure pressure to   hybrid pressure levels</p> <code>-</code> <code>ptop</code> <p>The pressure at the top of the atmosphere</p> <code>-</code> <code>ak</code> <p>The additive coefficient in the pressure calculation</p> <code>-</code> <code>bk</code> <p>The multiplicative coefficient in the pressure calculation</p>"},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients.ks","title":"<code>ks</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients.ptop","title":"<code>ptop</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients.ak","title":"<code>ak</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients.bk","title":"<code>bk</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.HybridPressureCoefficients.__init__","title":"<code>__init__(ks, ptop, ak, bk)</code>","text":""},{"location":"docstrings/grid/eta/#grid.eta.set_hybrid_pressure_coefficients","title":"<code>set_hybrid_pressure_coefficients(km, eta_file=None, ak_data=None, bk_data=None)</code>","text":"<p>Sets the coefficients describing the hybrid pressure coordinates.</p> <p>The pressure of each k-level is calculated as Pk = ak + (bk * Ps) where Ps is the surface pressure. Values are currently stored in lookup tables.</p> <p>Parameters:</p> Name Type Description Default <code>km</code> <code>int</code> <p>The number of vertical levels in the model</p> required <p>Returns:</p> Type Description <code>HybridPressureCoefficients</code> <p>a HybridPressureCoefficients dataclass</p>"},{"location":"docstrings/grid/eta/#grid.eta.vertical_coordinate","title":"<code>vertical_coordinate(eta_value)</code>","text":"<p>Equation (1) JRMS2006 computes eta_v, the auxiliary variable vertical coordinate</p>"},{"location":"docstrings/grid/eta/#grid.eta.compute_eta","title":"<code>compute_eta(ak, bk)</code>","text":"<p>Equation (1) JRMS2006 eta is the vertical coordinate and eta_v is an auxiliary vertical coordinate</p>"},{"location":"docstrings/grid/generation/","title":"generation","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinition","title":"<code>GridDefinition</code>  <code>dataclass</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinition.dims","title":"<code>dims</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinition.units","title":"<code>units</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinition.__init__","title":"<code>__init__(dims, units)</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions","title":"<code>GridDefinitions</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.CELL_CENTER","title":"<code>CELL_CENTER = (I_DIM, J_DIM)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.CELL_CORNERS","title":"<code>CELL_CORNERS = (I_INTERFACE_DIM, J_INTERFACE_DIM)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.LON_OR_LAT_DIM","title":"<code>LON_OR_LAT_DIM = 'lon_or_lat'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.TILE_DIM","title":"<code>TILE_DIM = 'tile'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.CARTESIAN_DIM","title":"<code>CARTESIAN_DIM = 'xyz_direction'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.grid","title":"<code>grid = GridDefinition(dims=(CELL_CORNERS + (LON_OR_LAT_DIM,)), units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.agrid","title":"<code>agrid = GridDefinition(dims=(CELL_CENTER + (LON_OR_LAT_DIM,)), units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.lon","title":"<code>lon = GridDefinition(dims=CELL_CORNERS, units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.lat","title":"<code>lat = GridDefinition(dims=CELL_CORNERS, units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.lon_agrid","title":"<code>lon_agrid = GridDefinition(dims=CELL_CENTER, units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.lat_agrid","title":"<code>lat_agrid = GridDefinition(dims=CELL_CENTER, units='radians')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.area","title":"<code>area = GridDefinition(dims=CELL_CENTER, units='m^2')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.area_cgrid","title":"<code>area_cgrid = GridDefinition(dims=CELL_CORNERS, units='m^2')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rarea","title":"<code>rarea = GridDefinition(dims=(area.dims), units='1/m^2')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rarea_c","title":"<code>rarea_c = GridDefinition(dims=(area_cgrid.dims), units='1/m^2')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dx","title":"<code>dx = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dy","title":"<code>dy = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dxc","title":"<code>dxc = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dyc","title":"<code>dyc = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dxa","title":"<code>dxa = GridDefinition(dims=CELL_CENTER, units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.dya","title":"<code>dya = GridDefinition(dims=CELL_CENTER, units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdx","title":"<code>rdx = GridDefinition(dims=(dx.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdy","title":"<code>rdy = GridDefinition(dims=(dy.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdxc","title":"<code>rdxc = GridDefinition(dims=(dxc.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdyc","title":"<code>rdyc = GridDefinition(dims=(dyc.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdxa","title":"<code>rdxa = GridDefinition(dims=(dxa.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rdya","title":"<code>rdya = GridDefinition(dims=(dya.dims), units='1/m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ak","title":"<code>ak = GridDefinition(dims=(K_INTERFACE_DIM,), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.bk","title":"<code>bk = GridDefinition(dims=(K_INTERFACE_DIM,), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ec1","title":"<code>ec1 = GridDefinition(dims=(CELL_CENTER + (CARTESIAN_DIM,)), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ec2","title":"<code>ec2 = GridDefinition(dims=(CELL_CENTER + (CARTESIAN_DIM,)), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ew1","title":"<code>ew1 = GridDefinition(dims=(CELL_CORNERS + (CARTESIAN_DIM,)), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ew2","title":"<code>ew2 = GridDefinition(dims=(CELL_CORNERS + (CARTESIAN_DIM,)), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.es1","title":"<code>es1 = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM, CARTESIAN_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.es2","title":"<code>es2 = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM, CARTESIAN_DIM), units='m')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cosa_u","title":"<code>cosa_u = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cosa_v","title":"<code>cosa_v = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cosa_s","title":"<code>cosa_s = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sina_u","title":"<code>sina_u = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sina_v","title":"<code>sina_v = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rsin_u","title":"<code>rsin_u = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rsin_v","title":"<code>rsin_v = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rsina","title":"<code>rsina = GridDefinition(dims=(I_INTERFACE_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.rsin2","title":"<code>rsin2 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cosa","title":"<code>cosa = GridDefinition(dims=(I_INTERFACE_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sina","title":"<code>sina = GridDefinition(dims=(I_INTERFACE_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg1","title":"<code>cos_sg1 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg2","title":"<code>cos_sg2 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg3","title":"<code>cos_sg3 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg4","title":"<code>cos_sg4 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg5","title":"<code>cos_sg5 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg6","title":"<code>cos_sg6 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg7","title":"<code>cos_sg7 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg8","title":"<code>cos_sg8 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.cos_sg9","title":"<code>cos_sg9 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg1","title":"<code>sin_sg1 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg2","title":"<code>sin_sg2 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg3","title":"<code>sin_sg3 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg4","title":"<code>sin_sg4 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg5","title":"<code>sin_sg5 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg6","title":"<code>sin_sg6 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg7","title":"<code>sin_sg7 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg8","title":"<code>sin_sg8 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.sin_sg9","title":"<code>sin_sg9 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.l2c_u","title":"<code>l2c_u = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.l2c_v","title":"<code>l2c_v = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ee1","title":"<code>ee1 = GridDefinition(dims=(CELL_CORNERS + (CARTESIAN_DIM,)), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.ee2","title":"<code>ee2 = GridDefinition(dims=(CELL_CORNERS + (CARTESIAN_DIM,)), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.del6_u","title":"<code>del6_u = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.del6_v","title":"<code>del6_v = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.divg_u","title":"<code>divg_u = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.divg_v","title":"<code>divg_v = GridDefinition(dims=(I_INTERFACE_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.z11","title":"<code>z11 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.z12","title":"<code>z12 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.z21","title":"<code>z21 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.z22","title":"<code>z22 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.a11","title":"<code>a11 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.a12","title":"<code>a12 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.a21","title":"<code>a21 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.a22","title":"<code>a22 = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_s","title":"<code>edge_s = GridDefinition(dims=(I_INTERFACE_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_n","title":"<code>edge_n = GridDefinition(dims=(I_INTERFACE_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_e","title":"<code>edge_e = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_w","title":"<code>edge_w = GridDefinition(dims=(I_DIM, J_INTERFACE_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_s","title":"<code>edge_vect_s = GridDefinition(dims=(I_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_n","title":"<code>edge_vect_n = GridDefinition(dims=(I_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_e_1d","title":"<code>edge_vect_e_1d = GridDefinition(dims=(J_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_w_1d","title":"<code>edge_vect_w_1d = GridDefinition(dims=(J_DIM,), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_e","title":"<code>edge_vect_e = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.GridDefinitions.edge_vect_w","title":"<code>edge_vect_w = GridDefinition(dims=(I_DIM, J_DIM), units='')</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms","title":"<code>MetricTerms</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.LON_OR_LAT_DIM","title":"<code>LON_OR_LAT_DIM = GridDefinitions.LON_OR_LAT_DIM</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.TILE_DIM","title":"<code>TILE_DIM = GridDefinitions.TILE_DIM</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.CARTESIAN_DIM","title":"<code>CARTESIAN_DIM = GridDefinitions.CARTESIAN_DIM</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.N_TILES","title":"<code>N_TILES = 6</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.RIGHT_HAND_GRID","title":"<code>RIGHT_HAND_GRID = False</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.quantity_factory","title":"<code>quantity_factory = quantity_factory</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.grid","title":"<code>grid</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dgrid_lon_lat","title":"<code>dgrid_lon_lat</code>  <code>property</code>","text":"<p>The longitudes and latitudes of the cell corners.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.gridvar","title":"<code>gridvar</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.agrid","title":"<code>agrid</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.agrid_lon_lat","title":"<code>agrid_lon_lat</code>  <code>property</code>","text":"<p>The longitudes and latitudes of the cell centers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.lon","title":"<code>lon</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.lat","title":"<code>lat</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.lon_agrid","title":"<code>lon_agrid</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.lat_agrid","title":"<code>lat_agrid</code>  <code>property</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dx","title":"<code>dx</code>  <code>property</code>","text":"<p>The distance between grid corners along the x-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dy","title":"<code>dy</code>  <code>property</code>","text":"<p>The distance between grid corners along the y-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dxa","title":"<code>dxa</code>  <code>property</code>","text":"<p>The with of each grid cell along the x-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dya","title":"<code>dya</code>  <code>property</code>","text":"<p>The with of each grid cell along the y-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dxc","title":"<code>dxc</code>  <code>property</code>","text":"<p>The distance between cell centers along the x-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.dyc","title":"<code>dyc</code>  <code>property</code>","text":"<p>The distance between cell centers along the y-direction.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ks","title":"<code>ks</code>  <code>property</code>","text":"<p>Number of levels where the vertical coordinate is purely pressure-based.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ak","title":"<code>ak</code>  <code>property</code>","text":"<p>The ak coefficient used to calculate the pressure at a given k-level:</p> <p>pk = ak + (bk * ps)</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.bk","title":"<code>bk</code>  <code>property</code>","text":"<p>The bk coefficient used to calculate the pressure at a given k-level:</p> <p>pk = ak + (bk * ps)</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ptop","title":"<code>ptop</code>  <code>property</code>","text":"<p>The pressure of the top of atmosphere level.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ec1","title":"<code>ec1</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vector in the x-direction at the cell centers.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ec2","title":"<code>ec2</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vector in the y-direction at the cell centers.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ew1","title":"<code>ew1</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vector in the x-direction at the left/right cell edges.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ew2","title":"<code>ew2</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vector in the y-direction at the left/right cell edges.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg1","title":"<code>cos_sg1</code>  <code>property</code>","text":"<p>Cosine of the angle at point 1 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg2","title":"<code>cos_sg2</code>  <code>property</code>","text":"<p>Cosine of the angle at point 2 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg3","title":"<code>cos_sg3</code>  <code>property</code>","text":"<p>Cosine of the angle at point 3 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg4","title":"<code>cos_sg4</code>  <code>property</code>","text":"<p>Cosine of the angle at point 4 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg5","title":"<code>cos_sg5</code>  <code>property</code>","text":"<p>Cosine of the angle at point 5 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7 The inner product of ec1 and ec2 for point 5</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg6","title":"<code>cos_sg6</code>  <code>property</code>","text":"<p>Cosine of the angle at point 6 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg7","title":"<code>cos_sg7</code>  <code>property</code>","text":"<p>Cosine of the angle at point 7 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg8","title":"<code>cos_sg8</code>  <code>property</code>","text":"<p>Cosine of the angle at point 8 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cos_sg9","title":"<code>cos_sg9</code>  <code>property</code>","text":"<p>Cosine of the angle at point 9 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg1","title":"<code>sin_sg1</code>  <code>property</code>","text":"<p>Sine of the angle at point 1 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg2","title":"<code>sin_sg2</code>  <code>property</code>","text":"<p>Sine of the angle at point 2 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg3","title":"<code>sin_sg3</code>  <code>property</code>","text":"<p>Sine of the angle at point 3 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg4","title":"<code>sin_sg4</code>  <code>property</code>","text":"<p>Sine of the angle at point 4 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg5","title":"<code>sin_sg5</code>  <code>property</code>","text":"<p>Sine of the angle at point 5 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p> <p>For the center point this is one minus the inner product of ec1 and ec2 squared</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg6","title":"<code>sin_sg6</code>  <code>property</code>","text":"<p>Sine of the angle at point 6 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg7","title":"<code>sin_sg7</code>  <code>property</code>","text":"<p>Sine of the angle at point 7 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg8","title":"<code>sin_sg8</code>  <code>property</code>","text":"<p>Sine of the angle at point 8 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sin_sg9","title":"<code>sin_sg9</code>  <code>property</code>","text":"<p>Sine of the angle at point 9 of the 'supergrid' within each grid cell:</p> <p>9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cosa","title":"<code>cosa</code>  <code>property</code>","text":"<p>Cosine of angle between coordinate lines at the cell corners.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sina","title":"<code>sina</code>  <code>property</code>","text":"<p>Sine of angle between coordinate lines at the cell corners.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cosa_u","title":"<code>cosa_u</code>  <code>property</code>","text":"<p>Cosine of angle between coordinate lines at the left and right cell edges.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cosa_v","title":"<code>cosa_v</code>  <code>property</code>","text":"<p>Cosine of angle between coordinate lines at the top and bottom cell edges.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.cosa_s","title":"<code>cosa_s</code>  <code>property</code>","text":"<p>as cosa but defined at cell centers</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sina_u","title":"<code>sina_u</code>  <code>property</code>","text":"<p>Sine of angle between coordinate lines at the left and right cell edges.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.sina_v","title":"<code>sina_v</code>  <code>property</code>","text":"<p>Sine of angle between coordinate lines at the top and bottom cell edges.</p> <p>Averaged to ensure consistent answers.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rsin_u","title":"<code>rsin_u</code>  <code>property</code>","text":"<p>1/sina_u**2, defined as the inverse-squrared as it is only used as such</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rsin_v","title":"<code>rsin_v</code>  <code>property</code>","text":"<p>1/sina_v**2, defined as the inverse-squrared as it is only used as such</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rsina","title":"<code>rsina</code>  <code>property</code>","text":"<p>1/sina**2, defined as the inverse-squrared as it is only used as such</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rsin2","title":"<code>rsin2</code>  <code>property</code>","text":"<p>1/sin_sg5**2, defined as the inverse-squrared as it is only used as such</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.l2c_v","title":"<code>l2c_v</code>  <code>property</code>","text":"<p>Angular momentum correction for converting v-winds from lat/lon to cartesian coordinates.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.l2c_u","title":"<code>l2c_u</code>  <code>property</code>","text":"<p>Angular momentum correction for converting u-winds from lat/lon to cartesian coordinates.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.es1","title":"<code>es1</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vetcor in the x-direation at the top/bottom cell edges.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.es2","title":"<code>es2</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vetcor in the y-direation at the top/bottom cell edges.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ee1","title":"<code>ee1</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vetcor in the x-direation at the cell corners.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.ee2","title":"<code>ee2</code>  <code>property</code>","text":"<p>Cartesian components of the local unit vetcor in the y-direation at the cell corners.</p> <p>3d array whose last dimension is length 3 and indicates cartesian x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.divg_u","title":"<code>divg_u</code>  <code>property</code>","text":"<p>sina_v * dyc/dx</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.divg_v","title":"<code>divg_v</code>  <code>property</code>","text":"<p>sina_u * dxc/dy</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.del6_u","title":"<code>del6_u</code>  <code>property</code>","text":"<p>sina_v * dx/dyc</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.del6_v","title":"<code>del6_v</code>  <code>property</code>","text":"<p>sina_u * dy/dxc</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.vlon","title":"<code>vlon</code>  <code>property</code>","text":"<p>Unit vector in eastward longitude direction.</p> <p>3d array whose last dimension is length 3 and indicates x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.vlat","title":"<code>vlat</code>  <code>property</code>","text":"<p>Unit vector in northward latitude direction.</p> <p>3d array whose last dimension is length 3 and indicates x/y/z value.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.z11","title":"<code>z11</code>  <code>property</code>","text":"<p>Vector product of horizontal component of the cell-center vector with the unit longitude vector.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.z12","title":"<code>z12</code>  <code>property</code>","text":"<p>Vector product of horizontal component of the cell-center vector with the unit latitude vector.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.z21","title":"<code>z21</code>  <code>property</code>","text":"<p>Vector product of vertical component of the cell-center vector with the unit longitude vector.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.z22","title":"<code>z22</code>  <code>property</code>","text":"<p>Vector product of vertical component of the cell-center vector with the unit latitude vector.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.a11","title":"<code>a11</code>  <code>property</code>","text":"<p>0.5*z22/sin_sg5</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.a12","title":"<code>a12</code>  <code>property</code>","text":"<p>0.5*z21/sin_sg5</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.a21","title":"<code>a21</code>  <code>property</code>","text":"<p>0.5*z12/sin_sg5</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.a22","title":"<code>a22</code>  <code>property</code>","text":"<p>0.5*z11/sin_sg5</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_w","title":"<code>edge_w</code>  <code>property</code>","text":"<p>Factor to interpolate scalars from a to c grid at the western grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_e","title":"<code>edge_e</code>  <code>property</code>","text":"<p>Factor to interpolate scalars from a to c grid at the eastern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_s","title":"<code>edge_s</code>  <code>property</code>","text":"<p>Factor to interpolate scalars from a to c grid at the southern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_n","title":"<code>edge_n</code>  <code>property</code>","text":"<p>Factor to interpolate scalars from a to c grid at the northern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_w_1d","title":"<code>edge_vect_w_1d</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the western grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_w","title":"<code>edge_vect_w</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the western grid edge repeated in x and y to be used in stencils.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_e_1d","title":"<code>edge_vect_e_1d</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the eastern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_e","title":"<code>edge_vect_e</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the eastern grid edge repeated in x and y to be used in stencils.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_s","title":"<code>edge_vect_s</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the southern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.edge_vect_n","title":"<code>edge_vect_n</code>  <code>property</code>","text":"<p>Factor to interpolate vectors from a to c grid at the northern grid edge.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.da_min","title":"<code>da_min</code>  <code>property</code>","text":"<p>The minimum agrid cell area across all ranks.</p> <p>If mpi is not present and the communicator is a DummyComm this will be the minimum on the local rank.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.da_max","title":"<code>da_max</code>  <code>property</code>","text":"<p>Fhe maximum agrid cell area across all ranks.</p> <p>Ff mpi is not present and the communicator is a DummyComm this will be the maximum on the local rank.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.da_min_c","title":"<code>da_min_c</code>  <code>property</code>","text":"<p>The minimum cgrid cell area across all ranks.</p> <p>If mpi is not present and the communicator is a DummyComm this will be the minimum on the local rank.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.da_max_c","title":"<code>da_max_c</code>  <code>property</code>","text":"<p>The maximum cgrid cell area across all ranks.</p> <p>If mpi is not present and the communicator is a DummyComm this will be the maximum on the local rank.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.area","title":"<code>area</code>  <code>property</code>","text":"<p>The area of each a-grid cell.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.area64","title":"<code>area64</code>  <code>property</code>","text":"<p>The area of each a-grid cell, at 64-bit precision.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.area_c","title":"<code>area_c</code>  <code>property</code>","text":"<p>The area of each c-grid cell.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rarea","title":"<code>rarea</code>  <code>cached</code> <code>property</code>","text":"<p>1/cell area</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rarea_c","title":"<code>rarea_c</code>  <code>cached</code> <code>property</code>","text":"<p>1/cgrid cell area</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdx","title":"<code>rdx</code>  <code>cached</code> <code>property</code>","text":"<p>1/dx</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdy","title":"<code>rdy</code>  <code>cached</code> <code>property</code>","text":"<p>1/dy</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdxa","title":"<code>rdxa</code>  <code>cached</code> <code>property</code>","text":"<p>1/dxa</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdya","title":"<code>rdya</code>  <code>cached</code> <code>property</code>","text":"<p>1/dya</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdxc","title":"<code>rdxc</code>  <code>cached</code> <code>property</code>","text":"<p>1/dxc</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.rdyc","title":"<code>rdyc</code>  <code>cached</code> <code>property</code>","text":"<p>1/dyc</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.__init__","title":"<code>__init__(*, quantity_factory, communicator, grid_type=0, dx_const=1000.0, dy_const=1000.0, deglat=15.0, extdgrid=False, eta_file=None, ak=None, bk=None)</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.from_external","title":"<code>from_external(x, y, quantity_factory, communicator, grid_type, eta_file=None)</code>  <code>classmethod</code>","text":"<p>Generates a metric terms object, using input from data contained in an externally generated tile file.</p>"},{"location":"docstrings/grid/generation/#grid.generation.MetricTerms.from_tile_sizing","title":"<code>from_tile_sizing(npx, npy, npz, communicator, backend, grid_type=0, dx_const=1000.0, dy_const=1000.0, deglat=15.0, eta_file=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.ignore_zero_division","title":"<code>ignore_zero_division(func)</code>","text":""},{"location":"docstrings/grid/generation/#grid.generation.quantity_cast_to_model_float","title":"<code>quantity_cast_to_model_float(quantity_factory, qty_64)</code>","text":"<p>Copy &amp; cast from 64-bit float to model precision if need be.</p>"},{"location":"docstrings/grid/geometry/","title":"geometry","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.get_center_vector","title":"<code>get_center_vector(xyz_gridpoints, grid_type, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates the cartesian unit vectors at the center of each grid cell.</p> <p>Returns:</p> Name Type Description <code>vector1</code> <p>the horizontal unit vector</p> <code>vector2</code> <p>the vertical unit vector</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calc_unit_vector_west","title":"<code>calc_unit_vector_west(xyz_dgrid, xyz_agrid, grid_type, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates the cartesian unit vectors at the left/right edges of each grid cell.</p> <p>Returns:</p> Name Type Description <code>vector1</code> <p>the horizontal unit vector</p> <code>vector2</code> <p>the vertical unit vector</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calc_unit_vector_south","title":"<code>calc_unit_vector_south(xyz_dgrid, xyz_agrid, grid_type, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates the cartesian unit vectors at the top/bottom edges of each grid cell.</p> <p>Returns:</p> Name Type Description <code>vector1</code> <p>the horizontal unit vector</p> <code>vector2</code> <p>the vertical unit vector</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_supergrid_cos_sin","title":"<code>calculate_supergrid_cos_sin(xyz_dgrid, xyz_agrid, ec1, ec2, grid_type, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates the cosine and sine of the grid angles at each of the following points in a supergrid cell: 9---4---8 |       | 1   5   3 |       | 6---2---7</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_l2c_vu","title":"<code>calculate_l2c_vu(dgrid, nhalo, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_xy_unit_vectors","title":"<code>calculate_xy_unit_vectors(xyz_dgrid, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates the cartesian unit vectors at the corners of each grid cell. vector1 is the horizontal unit vector, while vector2 is the vertical unit vector</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_trig_uv","title":"<code>calculate_trig_uv(xyz_dgrid, cos_sg, sin_sg, nhalo, tile_partitioner, rank, np)</code>","text":"<p>Calculates more trig quantities</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.supergrid_corner_fix","title":"<code>supergrid_corner_fix(cos_sg, sin_sg, nhalo, tile_partitioner, rank)</code>","text":"<p>filling the ghost cells overwrites some of the sin_sg values along the outward-facing edge of a tile in the corners, which is incorrect. This function resolves the issue by filling in the appropriate values after the _fill_single_halo_corner call</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_divg_del6","title":"<code>calculate_divg_del6(sin_sg, sina_u, sina_v, dx, dy, dxc, dyc, nhalo, tile_partitioner, rank)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_grid_z","title":"<code>calculate_grid_z(ec1, ec2, vlon, vlat, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_grid_a","title":"<code>calculate_grid_a(z11, z12, z21, z22, sin_sg5)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.edge_factors","title":"<code>edge_factors(grid_quantity, agrid, grid_type, nhalo, tile_partitioner, rank, radius, np)</code>","text":"<p>Creates interpolation factors from the A grid to the B grid on tile edges</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.set_west_edge_factor","title":"<code>set_west_edge_factor(grid, agrid, nhalo, radius, jstart, jend, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.set_east_edge_factor","title":"<code>set_east_edge_factor(grid, agrid, nhalo, radius, jstart, jend, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.set_south_edge_factor","title":"<code>set_south_edge_factor(grid, agrid, nhalo, radius, jstart, jend, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.set_north_edge_factor","title":"<code>set_north_edge_factor(grid, agrid, nhalo, radius, jstart, jend, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.efactor_a2c_v","title":"<code>efactor_a2c_v(grid_quantity, agrid, grid_type, nhalo, tile_partitioner, rank, radius, np)</code>","text":"<p>Creates interpolation factors at tile edges for interpolating vectors from A to C grids</p>"},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_west_edge_vectors","title":"<code>calculate_west_edge_vectors(grid, agrid, jm2, nhalo, radius, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_east_edge_vectors","title":"<code>calculate_east_edge_vectors(grid, agrid, jm2, nhalo, radius, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_south_edge_vectors","title":"<code>calculate_south_edge_vectors(grid, agrid, im2, nhalo, radius, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.calculate_north_edge_vectors","title":"<code>calculate_north_edge_vectors(grid, agrid, jm2, nhalo, radius, np)</code>","text":""},{"location":"docstrings/grid/geometry/#grid.geometry.unit_vector_lonlat","title":"<code>unit_vector_lonlat(grid, np)</code>","text":"<p>Calculates the cartesian unit vectors for each point on a lat/lon grid</p>"},{"location":"docstrings/grid/global_setup/","title":"global_setup","text":""},{"location":"docstrings/grid/global_setup/#grid.global_setup.gnomonic_grid","title":"<code>gnomonic_grid(grid_type, lon, lat, np)</code>","text":"<p>Apply gnomonic grid to lon and lat arrays for all tiles. Tiles must then be rotated and mirrored to the correct orientations before use.</p> <p>This global mesh generation is the way the Fortran code initializes the lon/lat grids and is reproduced here for testing purposes.</p> <p>Parameters:</p> Name Type Description Default <code>grid_type</code> <code>int</code> <p>type of grid to apply</p> required <code>lon</code> <p>longitude array with dimensions [x, y]</p> required <code>lat</code> <p>latitude array with dimensions [x, y]</p> required"},{"location":"docstrings/grid/global_setup/#grid.global_setup.global_gnomonic_ed","title":"<code>global_gnomonic_ed(lon, lat, np)</code>","text":""},{"location":"docstrings/grid/global_setup/#grid.global_setup.global_mirror_grid","title":"<code>global_mirror_grid(grid_global, ng, npx, npy, np, right_hand_grid)</code>","text":"<p>Mirrors and rotates all tiles of a lon/lat grid to the correct orientation. The tiles must then be partitioned onto the appropriate ranks. This global mesh generation is the way the Fortran code initializes the lon/lat grids and is reproduced here for testing purposes.</p>"},{"location":"docstrings/grid/gnomonic/","title":"gnomonic","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.lat_tile_east_west_edge","title":"<code>lat_tile_east_west_edge(alpha, dely, south_north_tile_index)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.local_gnomonic_ed","title":"<code>local_gnomonic_ed(lon, lat, npx, west_edge, east_edge, south_edge, north_edge, global_is, global_js, np, rank)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.normalize_vector","title":"<code>normalize_vector(np, *vector_components)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.normalize_xyz","title":"<code>normalize_xyz(xyz)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.lon_lat_midpoint","title":"<code>lon_lat_midpoint(lon1, lon2, lat1, lat2, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.xyz_midpoint","title":"<code>xyz_midpoint(*points)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.lon_lat_corner_to_cell_center","title":"<code>lon_lat_corner_to_cell_center(lon, lat, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.lon_lat_to_xyz","title":"<code>lon_lat_to_xyz(lon, lat, np)</code>","text":"<p>map (lon, lat) to (x, y, z) Args:     lon: 2d array of longitudes     lat: 2d array of latitudes     np: numpy-like module for arrays Returns:     xyz: 3d array whose last dimension is length 3 and indicates x/y/z value</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.xyz_to_lon_lat","title":"<code>xyz_to_lon_lat(xyz, np)</code>","text":"<p>map (x, y, z) to (lon, lat) Returns:     xyz: 3d array whose last dimension is length 3 and indicates x/y/z value     np: numpy-like module for arrays Returns:     lon: 2d array of longitudes     lat: 2d array of latitudes</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.symm_ed","title":"<code>symm_ed(lon, lat)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.great_circle_distance_along_axis","title":"<code>great_circle_distance_along_axis(lon, lat, radius, np, axis=0)</code>","text":"<p>Returns the great-circle distance between points along the desired axis.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.great_circle_distance_lon_lat","title":"<code>great_circle_distance_lon_lat(lon1, lon2, lat1, lat2, radius, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.great_circle_distance_xyz","title":"<code>great_circle_distance_xyz(p1, p2, radius, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.get_area","title":"<code>get_area(lon, lat, radius, np)</code>","text":"<p>Given latitude and longitude on cell corners, return the area of each cell.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.set_corner_area_to_triangle_area","title":"<code>set_corner_area_to_triangle_area(lon, lat, area, tile_partitioner, rank, radius, np)</code>","text":"<p>Given latitude and longitude on cell corners, and an array of cell areas, set the four corner areas to the area of the inner triangle at those corners.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.set_c_grid_tile_border_area","title":"<code>set_c_grid_tile_border_area(xyz_dgrid, xyz_agrid, radius, area_cgrid, tile_partitioner, rank, np)</code>","text":"<p>Using latitude and longitude without halo points, fix C-grid area at tile edges and corners. Naively, the c-grid area is calculated as the area between the rectangle at the four corners of the grid cell. At tile edges however, this is not accurate, because the area makes a butterfly-like shape as it crosses the tile boundary. Instead we calculate the area on one side of that shape, and multiply it by two. At corners, the corner is composed of three rectangles from each tile bordering the corner. We calculate the area from one tile and multiply it by three. Args:     xyz_dgrid: d-grid cartesian coordinates as a 3-d array, last dimension         of length 3 indicating x/y/z     xyz_agrid: a-grid cartesian coordinates as a 3-d array, last dimension         of length 3 indicating x/y/z     area_cgrid: 2d array of c-grid areas     radius: radius of Earth in metres     tile_partitioner: partitioner class to determine subtile position     rank: rank of current tile     np: numpy-like module to interact with arrays</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.set_tile_border_dxc","title":"<code>set_tile_border_dxc(xyz_dgrid, xyz_agrid, radius, dxc, tile_partitioner, rank, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.set_tile_border_dyc","title":"<code>set_tile_border_dyc(xyz_dgrid, xyz_agrid, radius, dyc, tile_partitioner, rank, np)</code>","text":""},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.get_rectangle_area","title":"<code>get_rectangle_area(p1, p2, p3, p4, radius, np)</code>","text":"<p>Given four point arrays whose last dimensions are x/y/z in clockwise or counterclockwise order, return an array of spherical rectangle areas. NOTE, this is not the exact same order of operations as the Fortran code This results in some errors in the last digit, but the spherical_angle is an exact match. The errors in the last digit multiplied out by the radius end up causing relative errors larger than 1e-14, but still within 1e-12.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.get_triangle_area","title":"<code>get_triangle_area(p1, p2, p3, radius, np)</code>","text":"<p>Given three point arrays whose last dimensions are x/y/z, return an array of spherical triangle areas.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.fortran_vector_spherical_angle","title":"<code>fortran_vector_spherical_angle(e1, e2, e3)</code>","text":"<p>The Fortran version     Given x/y/z tuples, compute the spherical angle between     them according to: !           p3 !         / !        / !       p_center ---&gt; angle !         !          !           p2     This angle will always be less than Pi.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.spherical_angle","title":"<code>spherical_angle(p_center, p2, p3, np)</code>","text":"<pre><code>Given ndarrays whose last dimension is x/y/z, compute the spherical angle between\nthem according to:\n</code></pre> <p>!           p3 !         / !        / !       p_center ---&gt; angle !         !          !           p2     This angle will always be less than Pi.</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.spherical_cos","title":"<code>spherical_cos(p_center, p2, p3, np)</code>","text":"<p>As Spherical angle, but returns cos(angle)</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.get_unit_vector_direction","title":"<code>get_unit_vector_direction(p1, p2, np)</code>","text":"<p>Returns the unit vector pointing from a set of lonlat points p1 to lonlat points p2</p>"},{"location":"docstrings/grid/gnomonic/#grid.gnomonic.get_lonlat_vect","title":"<code>get_lonlat_vect(lonlat_grid, np)</code>","text":"<p>Calculates the unit vectors pointing in the longitude/latitude directions for a set of longitude/latitude points</p>"},{"location":"docstrings/grid/helper/","title":"helper","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients","title":"<code>DampingCoefficients</code>  <code>dataclass</code>","text":"<p>Terms used to compute damping coefficients.</p>"},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.divg_u","title":"<code>divg_u</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.divg_v","title":"<code>divg_v</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.del6_u","title":"<code>del6_u</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.del6_v","title":"<code>del6_v</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.da_min","title":"<code>da_min</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.da_min_c","title":"<code>da_min_c</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.__init__","title":"<code>__init__(divg_u, divg_v, del6_u, del6_v, da_min, da_min_c)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DampingCoefficients.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData","title":"<code>HorizontalGridData</code>  <code>dataclass</code>","text":"<p>Terms defining the horizontal grid.</p>"},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.lon","title":"<code>lon</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.lat","title":"<code>lat</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.lon_agrid","title":"<code>lon_agrid</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.lat_agrid","title":"<code>lat_agrid</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.area","title":"<code>area</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.area_64","title":"<code>area_64</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rarea","title":"<code>rarea</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rarea_c","title":"<code>rarea_c</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dx","title":"<code>dx</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dy","title":"<code>dy</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dxc","title":"<code>dxc</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dyc","title":"<code>dyc</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dxa","title":"<code>dxa</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.dya","title":"<code>dya</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdx","title":"<code>rdx</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdy","title":"<code>rdy</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdxc","title":"<code>rdxc</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdyc","title":"<code>rdyc</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdxa","title":"<code>rdxa</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.rdya","title":"<code>rdya</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.ee1","title":"<code>ee1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.ee2","title":"<code>ee2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.es1","title":"<code>es1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.ew2","title":"<code>ew2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.a11","title":"<code>a11</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.a12","title":"<code>a12</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.a21","title":"<code>a21</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.a22","title":"<code>a22</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.edge_w","title":"<code>edge_w</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.edge_e","title":"<code>edge_e</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.edge_s","title":"<code>edge_s</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.edge_n","title":"<code>edge_n</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.__init__","title":"<code>__init__(lon, lat, lon_agrid, lat_agrid, area, area_64, rarea, rarea_c, dx, dy, dxc, dyc, dxa, dya, rdx, rdy, rdxc, rdyc, rdxa, rdya, ee1, ee2, es1, ew2, a11, a12, a21, a22, edge_w, edge_e, edge_s, edge_n)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.HorizontalGridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData","title":"<code>VerticalGridData</code>  <code>dataclass</code>","text":"<p>Terms defining the vertical grid.</p> <p>Eulerian vertical grid is defined by p = ak + bk * p_ref.</p>"},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.ak","title":"<code>ak</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.bk","title":"<code>bk</code>  <code>instance-attribute</code>","text":"<p>Reference pressure (Pa) used to define pressure at vertical interfaces, where p = ak + bk * p_ref.</p>"},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.p_ref","title":"<code>p_ref</code>  <code>property</code>","text":"<p>Reference pressure (Pa)</p>"},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.p_interface","title":"<code>p_interface</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.p","title":"<code>p</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.dp","title":"<code>dp</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.ptop","title":"<code>ptop</code>  <code>property</code>","text":"<p>Top of atmosphere pressure (Pa)</p>"},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.__init__","title":"<code>__init__(ak, bk)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.VerticalGridData.from_restart","title":"<code>from_restart(restart_path, quantity_factory)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData","title":"<code>ContravariantGridData</code>  <code>dataclass</code>","text":"<p>Grid variables used for converting vectors from covariant to contravariant components.</p>"},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.cosa","title":"<code>cosa</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.cosa_u","title":"<code>cosa_u</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.cosa_v","title":"<code>cosa_v</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.cosa_s","title":"<code>cosa_s</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.sina_u","title":"<code>sina_u</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.sina_v","title":"<code>sina_v</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.rsina","title":"<code>rsina</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.rsin_u","title":"<code>rsin_u</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.rsin_v","title":"<code>rsin_v</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.rsin2","title":"<code>rsin2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.__init__","title":"<code>__init__(cosa, cosa_u, cosa_v, cosa_s, sina_u, sina_v, rsina, rsin_u, rsin_v, rsin2)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.ContravariantGridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData","title":"<code>AngleGridData</code>  <code>dataclass</code>","text":"<p>sin and cos of certain angles used in metric calculations.</p> <p>Corresponds in the fortran code to sin_sg and cos_sg.</p>"},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg1","title":"<code>sin_sg1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg2","title":"<code>sin_sg2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg3","title":"<code>sin_sg3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg4","title":"<code>sin_sg4</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg5","title":"<code>sin_sg5</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg6","title":"<code>sin_sg6</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg7","title":"<code>sin_sg7</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg8","title":"<code>sin_sg8</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.sin_sg9","title":"<code>sin_sg9</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg1","title":"<code>cos_sg1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg2","title":"<code>cos_sg2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg3","title":"<code>cos_sg3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg4","title":"<code>cos_sg4</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg5","title":"<code>cos_sg5</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg6","title":"<code>cos_sg6</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg7","title":"<code>cos_sg7</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg8","title":"<code>cos_sg8</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.cos_sg9","title":"<code>cos_sg9</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.__init__","title":"<code>__init__(sin_sg1, sin_sg2, sin_sg3, sin_sg4, sin_sg5, sin_sg6, sin_sg7, sin_sg8, sin_sg9, cos_sg1, cos_sg2, cos_sg3, cos_sg4, cos_sg5, cos_sg6, cos_sg7, cos_sg8, cos_sg9)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.AngleGridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData","title":"<code>GridData</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.lon","title":"<code>lon</code>  <code>property</code>","text":"<p>longitude of cell corners</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.lat","title":"<code>lat</code>  <code>property</code>","text":"<p>latitude of cell corners</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.lon_agrid","title":"<code>lon_agrid</code>  <code>property</code>","text":"<p>longitude on the A-grid (cell centers)</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.lat_agrid","title":"<code>lat_agrid</code>  <code>property</code>","text":"<p>latitude on the A-grid (cell centers)</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.fC","title":"<code>fC</code>  <code>property</code>","text":"<p>Coriolis parameter at cell corners</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.fC_agrid","title":"<code>fC_agrid</code>  <code>property</code>","text":"<p>Coriolis parameter at cell centers</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.area","title":"<code>area</code>  <code>property</code>","text":"<p>Gridcell area</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.area_64","title":"<code>area_64</code>  <code>property</code>","text":"<p>Gridcell area (64-bit)</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rarea","title":"<code>rarea</code>  <code>property</code>","text":"<p>1 / area</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rarea_c","title":"<code>rarea_c</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.dx","title":"<code>dx</code>  <code>property</code>","text":"<p>distance between cell corners in x-direction</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dy","title":"<code>dy</code>  <code>property</code>","text":"<p>distance between cell corners in y-direction</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dxc","title":"<code>dxc</code>  <code>property</code>","text":"<p>distance between gridcell centers in x-direction</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dyc","title":"<code>dyc</code>  <code>property</code>","text":"<p>distance between gridcell centers in y-direction</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dxa","title":"<code>dxa</code>  <code>property</code>","text":"<p>distance between centers of west and east edges of gridcell</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dya","title":"<code>dya</code>  <code>property</code>","text":"<p>distance between centers of north and south edges of gridcell</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdx","title":"<code>rdx</code>  <code>property</code>","text":"<p>1 / dx</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdy","title":"<code>rdy</code>  <code>property</code>","text":"<p>1 / dy</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdxc","title":"<code>rdxc</code>  <code>property</code>","text":"<p>1 / dxc</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdyc","title":"<code>rdyc</code>  <code>property</code>","text":"<p>1 / dyc</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdxa","title":"<code>rdxa</code>  <code>property</code>","text":"<p>1 / dxa</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.rdya","title":"<code>rdya</code>  <code>property</code>","text":"<p>1 / dya</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.ee1","title":"<code>ee1</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.ee2","title":"<code>ee2</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.es1","title":"<code>es1</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.ew2","title":"<code>ew2</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.a11","title":"<code>a11</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.a12","title":"<code>a12</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.a21","title":"<code>a21</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.a22","title":"<code>a22</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.edge_w","title":"<code>edge_w</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.edge_e","title":"<code>edge_e</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.edge_s","title":"<code>edge_s</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.edge_n","title":"<code>edge_n</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.p_ref","title":"<code>p_ref</code>  <code>property</code>","text":"<p>reference pressure (Pa) used to define pressure at vertical interfaces, where p = ak + bk * p_ref</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.p","title":"<code>p</code>  <code>property</code>","text":"<p>Reference pressure profile for Eulerian grid, defined at cell centers.</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.ak","title":"<code>ak</code>  <code>property</code> <code>writable</code>","text":"<p>constant used to define pressure at vertical interfaces, where p = ak + bk * p_ref</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.bk","title":"<code>bk</code>  <code>property</code> <code>writable</code>","text":"<p>constant used to define pressure at vertical interfaces, where p = ak + bk * p_ref</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.ks","title":"<code>ks</code>  <code>property</code> <code>writable</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.ptop","title":"<code>ptop</code>  <code>property</code> <code>writable</code>","text":"<p>pressure at top of atmosphere (Pa)</p>"},{"location":"docstrings/grid/helper/#grid.helper.GridData.dp_ref","title":"<code>dp_ref</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cosa","title":"<code>cosa</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cosa_u","title":"<code>cosa_u</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cosa_v","title":"<code>cosa_v</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cosa_s","title":"<code>cosa_s</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sina_u","title":"<code>sina_u</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sina_v","title":"<code>sina_v</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.rsina","title":"<code>rsina</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.rsin_u","title":"<code>rsin_u</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.rsin_v","title":"<code>rsin_v</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.rsin2","title":"<code>rsin2</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg1","title":"<code>sin_sg1</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg2","title":"<code>sin_sg2</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg3","title":"<code>sin_sg3</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg4","title":"<code>sin_sg4</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg5","title":"<code>sin_sg5</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg6","title":"<code>sin_sg6</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg7","title":"<code>sin_sg7</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg8","title":"<code>sin_sg8</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.sin_sg9","title":"<code>sin_sg9</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg1","title":"<code>cos_sg1</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg2","title":"<code>cos_sg2</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg3","title":"<code>cos_sg3</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg4","title":"<code>cos_sg4</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg5","title":"<code>cos_sg5</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg6","title":"<code>cos_sg6</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg7","title":"<code>cos_sg7</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg8","title":"<code>cos_sg8</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.cos_sg9","title":"<code>cos_sg9</code>  <code>property</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.__init__","title":"<code>__init__(horizontal_data, vertical_data, contravariant_data, angle_data, fc=None, fc_agrid=None)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.GridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData","title":"<code>DriverGridData</code>  <code>dataclass</code>","text":"<p>Terms used to Apply Physics changes to the Dycore. Attributes:   vlon1: x-component of unit lon vector in eastward longitude direction   vlon2: y-component of unit lon vector in eastward longitude direction   vlon3: z-component of unit lon vector in eastward longitude direction   vlat1: x-component of unit lat vector in northward latitude direction   vlat2: y-component of unit lat vector in northward latitude direction   vlat3: z-component of unit lat vector in northward latitude direction   edge_vect_w: factor to interpolate A to C grids at the western grid edge   edge_vect_e: factor to interpolate A to C grids at the easter grid edge   edge_vect_s: factor to interpolate A to C grids at the southern grid edge   edge_vect_n: factor to interpolate A to C grids at the northern grid edge   es1_1: x-component of grid local unit vector in x-direction at cell edge   es1_2: y-component of grid local unit vector in x-direction at cell edge   es1_3: z-component of grid local unit vector in x-direction at cell edge   ew2_1: x-component of grid local unit vector in y-direction at cell edge   ew2_2: y-component of grid local unit vector in y-direction at cell edge   ew2_3: z-component of grid local unit vector in y-direction at cell edge</p>"},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlon1","title":"<code>vlon1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlon2","title":"<code>vlon2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlon3","title":"<code>vlon3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlat1","title":"<code>vlat1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlat2","title":"<code>vlat2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.vlat3","title":"<code>vlat3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.edge_vect_w","title":"<code>edge_vect_w</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.edge_vect_e","title":"<code>edge_vect_e</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.edge_vect_s","title":"<code>edge_vect_s</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.edge_vect_n","title":"<code>edge_vect_n</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.es1_1","title":"<code>es1_1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.es1_2","title":"<code>es1_2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.es1_3","title":"<code>es1_3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.ew2_1","title":"<code>ew2_1</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.ew2_2","title":"<code>ew2_2</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.ew2_3","title":"<code>ew2_3</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.grid_type","title":"<code>grid_type</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.__init__","title":"<code>__init__(vlon1, vlon2, vlon3, vlat1, vlat2, vlat3, edge_vect_w, edge_vect_e, edge_vect_s, edge_vect_n, es1_1, es1_2, es1_3, ew2_1, ew2_2, ew2_3, grid_type)</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.new_from_metric_terms","title":"<code>new_from_metric_terms(metric_terms)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.DriverGridData.new_from_grid_variables","title":"<code>new_from_grid_variables(vlon, vlat, edge_vect_n, edge_vect_s, edge_vect_e, edge_vect_w, es1, ew2, grid_type=0)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/grid/helper/#grid.helper.split_quantity_along_last_dim","title":"<code>split_quantity_along_last_dim(quantity)</code>","text":"<p>Split a quantity along the last dimension into a list of quantities.</p> <p>Parameters:</p> Name Type Description Default <code>quantity</code> <code>Quantity</code> <p>Quantity to split.</p> required <p>Returns:</p> Type Description <code>list[Quantity]</code> <p>list[Quantity]: List of quantities.</p>"},{"location":"docstrings/grid/mirror/","title":"mirror","text":""},{"location":"docstrings/grid/mirror/#grid.mirror.RIGHT_HAND_GRID","title":"<code>RIGHT_HAND_GRID = False</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/grid/mirror/#grid.mirror.mirror_grid","title":"<code>mirror_grid(mirror_data, tile_index, npx, npy, x_subtile_width, y_subtile_width, global_is, global_js, ng, np, right_hand_grid)</code>","text":""},{"location":"docstrings/grid/mirror/#grid.mirror.set_halo_nan","title":"<code>set_halo_nan(grid, ng, np)</code>","text":""},{"location":"docstrings/grid/stretch_transformation/","title":"stretch_transformation","text":""},{"location":"docstrings/grid/stretch_transformation/#grid.stretch_transformation.T","title":"<code>T = TypeVar('T', bound=(Quantity | np.ndarray))</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/grid/stretch_transformation/#grid.stretch_transformation.direct_transform","title":"<code>direct_transform(*, lon, lat, stretch_factor, lon_target, lat_target, np)</code>","text":"<p>The direct_transform subroutine from fv_grid_utils.F90. Takes in latitude and longitude in radians. Shrinks tile 6 by stretch factor in area to increase resolution locally. Then performs translation of all tiles so that the now-smaller tile 6 is centered on lon_target, lat_target.</p> <p>Parameters:</p> Name Type Description Default <code>lon</code> <code>T</code> <p>longitude in radians</p> required <code>lat</code> <code>T</code> <p>latitude in radians</p> required <code>stretch_factor</code> <code>float</code> <p>stretch_factor (e.g. 3.0 means that the resolution on tile 6 becomes 3 times as fine)</p> required <code>lon_target</code> <code>float</code> <p>in degrees (from namelist)</p> required <code>lat_target</code> <code>float</code> <p>in degrees (from namelist)</p> required <code>np</code> <p>numpy or cupy module</p> required <p>Returns:</p> Type Description <code>(lon_transform, lat_transform)</code> <p>in radians</p>"},{"location":"docstrings/halo/cuda_kernels/","title":"cuda_kernels","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_scalar_f64_kernel","title":"<code>pack_scalar_f64_kernel = None if cp is None else cp.RawKernel(pack_scalar_code('double'), 'pack_scalar_double')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_scalar_f32_kernel","title":"<code>pack_scalar_f32_kernel = None if cp is None else cp.RawKernel(pack_scalar_code('float'), 'pack_scalar_float')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_scalar_f64_kernel","title":"<code>unpack_scalar_f64_kernel = None if cp is None else cp.RawKernel(unpack_scalar_code('double'), 'unpack_scalar_double')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_scalar_f32_kernel","title":"<code>unpack_scalar_f32_kernel = None if cp is None else cp.RawKernel(unpack_scalar_code('float'), 'unpack_scalar_float')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_vector_f64_kernel","title":"<code>pack_vector_f64_kernel = None if cp is None else cp.RawKernel(pack_vector_code('double'), 'pack_vector_double')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_vector_f32_kernel","title":"<code>pack_vector_f32_kernel = None if cp is None else cp.RawKernel(pack_vector_code('float'), 'pack_vector_float')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_vector_f64_kernel","title":"<code>unpack_vector_f64_kernel = None if cp is None else cp.RawKernel(unpack_vector_code('double'), 'unpack_vector_double')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_vector_f32_kernel","title":"<code>unpack_vector_f32_kernel = None if cp is None else cp.RawKernel(unpack_vector_code('float'), 'unpack_vector_float')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_scalar_code","title":"<code>pack_scalar_code(float_dtype)</code>","text":"<p>Pack into o_destinationBuffer data from i_sourceArray.</p> <p>The indexation into i_sourceArray is stored in i_indexes. i_offset is the offset in the destination buffer. i_nIndex allows to protect from out-of-bound read in kernel.</p> <p>tid is the global unique index calculated from the CUDA scheduler inner data.</p>"},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_scalar_code","title":"<code>unpack_scalar_code(float_dtype)</code>","text":"<p>Unpack into o_destinationArray data from i_sourceBuffer.</p> <p>The indexation into o_destinationArray is stored in i_indexes. i_offset is the offset in the source buffer. i_nIndex allows to protect from out-of-bound read in kernel.</p> <p>tid is the global unique index calculated from the CUDA scheduler inner data.</p>"},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.pack_vector_code","title":"<code>pack_vector_code(float_dtype)</code>","text":"<p>Pack into o_destinationBuffer data from i_sourceArrayX/Y.</p> <p>The indexation into i_sourceArrayX/Y is stored in i_indexesX/Y. i_offset is the offset in the destination buffer. i_nIndexX/Y allows to protect from out-of-bound read in kernel. i_rotate refers to the rotation that needs to be applied prior to assignment.</p> <p>tid is the global unique index calculated from the CUDA scheduler inner data.</p>"},{"location":"docstrings/halo/cuda_kernels/#halo.cuda_kernels.unpack_vector_code","title":"<code>unpack_vector_code(float_dtype)</code>","text":"<p>Unpack into o_destinationArrayX/Y data from i_sourceBuffer.</p> <p>The indexation into o_destinationArrayX/Y is stored in i_indexesX/Y. i_offset is the offset in the source buffer. i_nIndexX/Y allows to protect from out-of-bound read in kernel.</p> <p>tid is the global unique index calculated from the CUDA scheduler inner data.</p>"},{"location":"docstrings/halo/data_transformer/","title":"data_transformer","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.STREAM_POOL","title":"<code>STREAM_POOL = []</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.INDICES_CACHE","title":"<code>INDICES_CACHE = {}</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec","title":"<code>HaloExchangeSpec</code>  <code>dataclass</code>","text":"<p>Memory description of the data exchanged.</p> <p>The data stored here target a single exchange, with an optional rotation to give prior to pack. Slices are tupled following the convention of one slice per dimension</p> <p>Parameters:</p> Name Type Description Default <code>specification</code> <code>QuantityHaloSpec</code> <p>memory layout of the data</p> required <code>pack_slices</code> <code>tuple[slice, ...]</code> <p>indexing to pack, one slice per dimension</p> required <code>pack_clockwise_rotation</code> <code>int</code> <p>number of 90-degree rotations to perform before packing</p> required <code>unpack_slices</code> <code>tuple[slice, ...]</code> <p>indexing to unpack, one slice per dimension</p> required"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec.specification","title":"<code>specification</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec.pack_slices","title":"<code>pack_slices</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec.pack_clockwise_rotation","title":"<code>pack_clockwise_rotation</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec.unpack_slices","title":"<code>unpack_slices</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloExchangeSpec.__init__","title":"<code>__init__(specification, pack_slices, pack_clockwise_rotation, unpack_slices)</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer","title":"<code>HaloDataTransformer</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Transform data to exchange in a format optimized for network communication.</p> <p>Current strategy: pack/unpack multiple nD array into/from a single buffer. Offers a pack and an unpack buffer to use for communicating data.</p> <p>The class is responsible for packing &amp; unpacking, not communication. Order of operations: - get HaloDataTransformer via get() with N transformation   with the proper halo specifications.   At the end of get() a _compile() will be triggered, reading   the internal buffers. - call async_pack(quantities) to start packing the quantities in the   internal buffer. - synchronize() to make sure all operations are finished or use get_pack_buffer()   when ready to communicate which will internally call synchronize. [... user should communicate the buffers...] - call async_unpack(quantities) to start unpacking - call synchronize() to finish all the unpacking operations and make sure   the quantities passed in async_unpack have been updated.</p> <p>The class will hold onto the buffers up until deletion, where they will be returned to an internal buffer pool.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.__init__","title":"<code>__init__(np_module, exchange_descriptors_x, exchange_descriptors_y=None)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>np_module</code> <code>NumpyModule</code> <p>numpy-like module for allocation</p> required <code>exchange_descriptors_x</code> <code>Sequence[HaloExchangeSpec]</code> <p>list of memory information describing an exchange. Used for scalar data and the x-component of vectors.</p> required <code>exchange_descriptors_y</code> <code>Sequence[HaloExchangeSpec] | None</code> <p>list of memory information describing an exchange. Optional, used for the y-component of vectors only. If <code>none</code> the data will packed as a scalar.</p> <code>None</code>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.finalize","title":"<code>finalize()</code>","text":"<p>Deletion routine, making sure all buffers were inserted back into cache.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.get","title":"<code>get(np_module, exchange_descriptors_x, exchange_descriptors_y=None)</code>  <code>staticmethod</code>","text":"<p>Construct a module from a numpy-like module.</p> <p>Parameters:</p> Name Type Description Default <code>np_module</code> <code>NumpyModule</code> <p>numpy-like module to determine child transformer type.</p> required <code>exchange_descriptors_x</code> <code>Sequence[HaloExchangeSpec]</code> <p>list of memory information describing an exchange. Used for scalar data and the x-component of vectors.</p> required <code>exchange_descriptors_y</code> <code>Sequence[HaloExchangeSpec] | None</code> <p>list of memory information describing an exchange. Optional, used for the y-component of vectors only. If <code>none</code> the data will packed as a scalar.</p> <code>None</code> <p>Returns:</p> Type Description <code>HaloDataTransformer</code> <p>an initialized packed buffer.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.get_unpack_buffer","title":"<code>get_unpack_buffer()</code>","text":"<p>Retrieve unpack buffer.</p> <p>Synchronizes operations.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.get_pack_buffer","title":"<code>get_pack_buffer()</code>","text":"<p>Retrieve pack buffer.</p> <p>Synchronizes operations.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.ready","title":"<code>ready()</code>","text":"<p>Check if the buffers are ready for communication.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.async_pack","title":"<code>async_pack(quantities_x, quantities_y=None)</code>  <code>abstractmethod</code>","text":"<p>Pack all given quantities into a single send Buffer.</p> <p>Does not guarantee the buffer returned by <code>get_unpack_buffer</code> has received data, doing so requires calling <code>synchronize</code>. Reaching for the buffer via get_pack_buffer() will call synchronize().</p> <p>Parameters:</p> Name Type Description Default <code>quantities_x</code> <code>list[Quantity]</code> <p>scalar or vector x-component quantities to pack, if one is vector they must all be vector</p> required <code>quantities_y</code> <code>list[Quantity] | None</code> <p>if quantities are vector, the y-component quantities.</p> <code>None</code>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.async_unpack","title":"<code>async_unpack(quantities_x, quantities_y=None)</code>  <code>abstractmethod</code>","text":"<p>Unpack the buffer into destination quantities.</p> <p>Does not guarantee the buffer returned by <code>get_unpack_buffer</code> has received data, doing so requires calling <code>synchronize</code>. Reaching for the buffer via get_unpack_buffer() will call synchronize().</p> <p>Parameters:</p> Name Type Description Default <code>quantities_x</code> <code>Sequence[Quantity]</code> <p>scalar or vector x-component quantities to be unpacked into, if one is vector they must all be vector</p> required <code>quantities_y</code> <code>Sequence[Quantity] | None</code> <p>if quantities are vector, the y-component quantities.</p> <code>None</code>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformer.synchronize","title":"<code>synchronize()</code>  <code>abstractmethod</code>","text":"<p>Synchronize all operations.</p> <p>Guarantees all memory is now safe to access.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerCPU","title":"<code>HaloDataTransformerCPU</code>","text":"<p>               Bases: <code>HaloDataTransformer</code></p> <p>Pack/unpack data in a single buffer using numpy flattening &amp; slicing.</p> <p>Default behavior, could be done with any numpy-like library.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerCPU.synchronize","title":"<code>synchronize()</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerCPU.async_pack","title":"<code>async_pack(quantities_x, quantities_y=None)</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerCPU.async_unpack","title":"<code>async_unpack(quantities_x, quantities_y=None)</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU","title":"<code>HaloDataTransformerGPU</code>","text":"<p>               Bases: <code>HaloDataTransformer</code></p> <p>Pack/unpack data in a single buffer using CUDA Kernels.</p> <p>In order to efficiently pack/unpack on the GPU to a single GPU buffer we use streamed (e.g. async) kernels per quantity per edge to send. The kernels are store in <code>cuda_kernels.py</code>, they both follow the same simple pattern by reading the indices to the device memory of the data to pack/unpack. <code>_flatten_indices</code> is the routine that take the layout of the memory and the slice and compute an array of index into the original memory.</p>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU.__init__","title":"<code>__init__(np_module, exchange_descriptors_x, exchange_descriptors_y=None)</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU.synchronize","title":"<code>synchronize()</code>","text":""},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU.async_pack","title":"<code>async_pack(quantities_x, quantities_y=None)</code>","text":"<p>Pack the quantities into a single buffer via streamed cuda kernels</p> <p>Writes into self._pack_buffer using self._x_infos and self._y_infos to read the offsets and sizes per quantity.</p> <p>Parameters:</p> Name Type Description Default <code>quantities_x</code> <code>list[Quantity]</code> <p>list of quantities to pack. Must fit the specifications given at init time.</p> required <code>quantities_y</code> <code>list[Quantity] | None</code> <p>Same as above but optional, used only for vector transfer.</p> <code>None</code>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU.async_unpack","title":"<code>async_unpack(quantities_x, quantities_y=None)</code>","text":"<p>Unpack the quantities from a single buffer via streamed cuda kernels</p> <p>Reads from self._unpack_buffer using self._x_infos and self._y_infos to read the offsets and sizes per quantity.</p> <p>Parameters:</p> Name Type Description Default <code>quantities_x</code> <code>Sequence[Quantity]</code> <p>list of quantities to unpack. Must fit the specifications given at init time.</p> required <code>quantities_y</code> <code>Sequence[Quantity] | None</code> <p>Same as above but optional, used only for vector transfer.</p> <code>None</code>"},{"location":"docstrings/halo/data_transformer/#halo.data_transformer.HaloDataTransformerGPU.finalize","title":"<code>finalize()</code>","text":""},{"location":"docstrings/halo/rotate/","title":"rotate","text":""},{"location":"docstrings/halo/rotate/#halo.rotate.rotate_scalar_data","title":"<code>rotate_scalar_data(data, dims, numpy, n_clockwise_rotations)</code>","text":""},{"location":"docstrings/halo/rotate/#halo.rotate.rotate_vector_data","title":"<code>rotate_vector_data(x_data, y_data, n_clockwise_rotations, dims, numpy)</code>","text":""},{"location":"docstrings/halo/updater/","title":"updater","text":""},{"location":"docstrings/halo/updater/#halo.updater.TIMER_HALO_EX_KEY","title":"<code>TIMER_HALO_EX_KEY = 'halo_exchange_global'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater","title":"<code>HaloUpdater</code>","text":"<p>Exchange halo information between ranks.</p> <p>The class is responsible for the entire exchange and uses the init to precompute the maximum of information to have minimum overhead at runtime. Therefore it should be cached for early and re-used at runtime.</p> <ul> <li>from_scalar_specifications/from_vector_specifications are used to   create a HaloUpdater from a list of memory specifications</li> <li>update and start/wait trigger the halo exchange</li> <li>the class creates a \"pattern\" of exchange that can fit   any memory given to do/start</li> <li>temporary references to the Quantities are held between start and wait</li> </ul>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.__init__","title":"<code>__init__(comm, tag, transformers, timer)</code>","text":"<p>Build the updater.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Communicator</code> <p>communicator responsible for send/recv commands.</p> required <code>tag</code> <code>int</code> <p>network tag to be used for communication</p> required <code>transformers</code> <code>dict[int, HaloDataTransformer]</code> <p>mapping from destination rank to transformers used to pack/unpack before and after communication</p> required <code>timer</code> <code>Timer</code> <p>timing operations</p> required"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.force_finalize_on_wait","title":"<code>force_finalize_on_wait()</code>","text":"<p>HaloDataTransformer are finalized after a wait call</p> <p>This is a temporary fix. See DSL-816 which will remove self._finalize_on_wait.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.from_scalar_specifications","title":"<code>from_scalar_specifications(comm, numpy_like_module, specifications, boundaries, tag, optional_timer=None)</code>  <code>classmethod</code>","text":"<p>Create/retrieve as many packed buffer as needed and queue the slices to exchange.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Communicator</code> <p>communicator to post network messages</p> required <code>numpy_like_module</code> <code>NumpyModule</code> <p>module implementing numpy API</p> required <code>specifications</code> <code>Iterable[QuantityHaloSpec]</code> <p>data specifications to exchange, including number of halo points</p> required <code>boundaries</code> <code>Iterable[Boundary]</code> <p>information on the exchange boundaries.</p> required <code>tag</code> <code>int</code> <p>network tag (to differentiate messaging) for this node.</p> required <code>optional_timer</code> <code>Timer | None</code> <p>timing of operations.</p> <code>None</code> <p>Returns:</p> Type Description <code>HaloUpdater</code> <p>HaloUpdater ready to exchange data.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.from_vector_specifications","title":"<code>from_vector_specifications(comm, numpy_like_module, specifications_x, specifications_y, boundaries, tag, optional_timer=None)</code>  <code>classmethod</code>","text":"<p>Create/retrieve as many packed buffer as needed and queue the slices to exchange.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Communicator</code> <p>communicator to post network messages</p> required <code>numpy_like_module</code> <code>NumpyModule</code> <p>module implementing numpy API</p> required <code>specifications_x</code> <code>Iterable[QuantityHaloSpec]</code> <p>specifications to exchange along the x axis. Length must match y specifications.</p> required <code>specifications_y</code> <code>Iterable[QuantityHaloSpec]</code> <p>specifications to exchange along the y axis. Length must match x specifications.</p> required <code>boundaries</code> <code>Iterable[Boundary]</code> <p>information on the exchange boundaries.</p> required <code>tag</code> <code>int</code> <p>network tag (to differentiate messaging) for this node.</p> required <code>optional_timer</code> <code>Timer | None</code> <p>timing of operations.</p> <code>None</code> <p>Returns:</p> Type Description <code>HaloUpdater</code> <p>HaloUpdater ready to exchange data.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.update","title":"<code>update(quantities_x, quantities_y=None)</code>","text":"<p>Exchange the data and blocks until finished.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.start","title":"<code>start(quantities_x, quantities_y=None)</code>","text":"<p>Start data exchange.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdater.wait","title":"<code>wait()</code>","text":"<p>Finalize data exchange.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdateRequest","title":"<code>HaloUpdateRequest</code>","text":"<p>Asynchronous request object for halo updates.</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdateRequest.__init__","title":"<code>__init__(send_data, recv_data, timer=None)</code>","text":"<p>Build a halo request. Args:     send_data: a tuple of the MPI request and the buffer sent     recv_data: a tuple of the MPI request, the temporary buffer and         the destination buffer     timer: optional, time the wait &amp; unpack of a halo exchange</p>"},{"location":"docstrings/halo/updater/#halo.updater.HaloUpdateRequest.wait","title":"<code>wait()</code>","text":"<p>Wait &amp; unpack data into destination buffers Clean up by inserting back all buffers back in cache for potential reuse</p>"},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater","title":"<code>VectorInterfaceHaloUpdater</code>","text":""},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater.timer","title":"<code>timer = timer if timer is not None else NullTimer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater.comm","title":"<code>comm = comm</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater.boundaries","title":"<code>boundaries = boundaries</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater.__init__","title":"<code>__init__(comm, boundaries, force_cpu=False, timer=None)</code>","text":"<p>Initialize a CubedSphereCommunicator.</p> <p>Parameters:</p> Name Type Description Default <code>comm</code> <code>Comm</code> <p>ndsl.Comm object</p> required <code>boundaries</code> <code>Mapping[int, Boundary]</code> <p>?</p> required <code>force_cpu</code> <code>bool</code> <p>Force all communication to go through central memory. Optional.</p> <code>False</code> <code>timer</code> <code>Timer | None</code> <p>Time communication operations. Optional.</p> <code>None</code>"},{"location":"docstrings/halo/updater/#halo.updater.VectorInterfaceHaloUpdater.start_synchronize_vector_interfaces","title":"<code>start_synchronize_vector_interfaces(x_quantity, y_quantity)</code>","text":"<p>Synchronize shared points at the edges of a vector interface variable.</p> <p>Sends the values on the south and west edges to overwrite the values on adjacent subtiles. Vector must be defined on the Arakawa C grid.</p> <p>For interface variables, the edges of the tile are computed on both ranks bordering that edge. This routine copies values across those shared edges so that both ranks have the same value for that edge. It also handles any rotation of vector quantities needed to move data across the edge.</p> <p>Parameters:</p> Name Type Description Default <code>x_quantity</code> <code>Quantity</code> <p>the x-component quantity to be synchronized</p> required <code>y_quantity</code> <code>Quantity</code> <p>the y-component quantity to be synchronized</p> required <p>Returns:</p> Name Type Description <code>request</code> <code>HaloUpdateRequest</code> <p>an asynchronous request object with a .wait() method</p>"},{"location":"docstrings/halo/updater/#halo.updater.on_c_grid","title":"<code>on_c_grid(x_quantity, y_quantity)</code>","text":""},{"location":"docstrings/initialization/allocator/","title":"allocator","text":""},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory","title":"<code>QuantityFactory</code>","text":""},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.sizer","title":"<code>sizer = sizer</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.backend","title":"<code>backend = backend</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.__init__","title":"<code>__init__(sizer, *, backend)</code>","text":"<p>Initialize a QuantityFactory from a GridSizer and a GT4Py backend name.</p> <p>Parameters:</p> Name Type Description Default <code>sizer</code> <code>GridSizer</code> <p>GridSizer object that determines the array sizes.</p> required <code>backend</code> <code>str</code> <p>GT4Py backend name used for performance-optimized allocation.</p> required"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.update_data_dimensions","title":"<code>update_data_dimensions(data_dimension_descriptions)</code>","text":"<p>Update the length of data (non-x/y/z) dimensions, unknown data dimensions will be added, existing ones updated.</p> <p>Parameters:</p> Name Type Description Default <code>data_dimension_descriptions</code> <code>dict[str, int]</code> <p>Dict of name/length pairs</p> required"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.add_data_dimensions","title":"<code>add_data_dimensions(data_dimension_descriptions)</code>","text":"<p>Add new data (non-x/y/z) dimensions via a key-length pair. If the dimension already exists, it will error out.</p> <p>Parameters:</p> Name Type Description Default <code>data_dimension_descriptions</code> <code>dict[str, int]</code> <p>Dict of name/length pairs</p> required"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.empty","title":"<code>empty(dims, units, dtype=Float, *, allow_mismatch_float_precision=False)</code>","text":"<p>Allocate a Quantity and fill it with uninitialized (undefined) values.</p> <p>Equivalent to <code>numpy.empty</code></p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.zeros","title":"<code>zeros(dims, units, dtype=Float, *, allow_mismatch_float_precision=False)</code>","text":"<p>Allocate a Quantity and fill it with the value 0.</p> <p>Equivalent to <code>numpy.zeros</code></p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.ones","title":"<code>ones(dims, units, dtype=Float, *, allow_mismatch_float_precision=False)</code>","text":"<p>Allocate a Quantity and fill it with the value 1.</p> <p>Equivalent to <code>numpy.ones</code></p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.full","title":"<code>full(dims, units, value, dtype=Float, *, allow_mismatch_float_precision=False)</code>","text":"<p>Allocate a Quantity and fill it with the given value.</p> <p>Equivalent to <code>numpy.full</code></p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.from_array","title":"<code>from_array(data, dims, units, *, allow_mismatch_float_precision=False)</code>","text":"<p>Create a Quantity from values in the <code>data</code> array.</p> <p>This copies the values of <code>data</code> into the resulting Quantity. The data array thus must correspond to the correct shape and extent for the given dims.</p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.from_compute_array","title":"<code>from_compute_array(data, dims, units, *, allow_mismatch_float_precision=False)</code>","text":"<p>Create a Quantity from values of the compute domain.</p> <p>This function will allocate the full Quantity (including potential halo points) to zero. The values of <code>data</code> are then copied into the compute domain. That numpy array must correspond to the correct shape and extent of the compute domain for the given dims.</p>"},{"location":"docstrings/initialization/allocator/#initialization.allocator.QuantityFactory.get_quantity_halo_spec","title":"<code>get_quantity_halo_spec(dims, n_halo=None, dtype=Float)</code>","text":"<p>Build memory specifications for the halo update.</p> <p>Parameters:</p> Name Type Description Default <code>dims</code> <code>Sequence[str]</code> <p>dimensionality of the data</p> required <code>n_halo</code> <code>int | None</code> <p>number of halo points to update, defaults to self.n_halo</p> <code>None</code> <code>dtype</code> <code>type</code> <p>data type of the data</p> <code>Float</code>"},{"location":"docstrings/initialization/grid_sizer/","title":"grid_sizer","text":""},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer","title":"<code>GridSizer</code>  <code>dataclass</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.nx","title":"<code>nx</code>  <code>instance-attribute</code>","text":"<p>Length of the x compute dimension for produced arrays.</p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.ny","title":"<code>ny</code>  <code>instance-attribute</code>","text":"<p>Length of the y compute dimension for produced arrays.</p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.nz","title":"<code>nz</code>  <code>instance-attribute</code>","text":"<p>Length of the z compute dimension for produced arrays.</p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.n_halo","title":"<code>n_halo</code>  <code>instance-attribute</code>","text":"<p>Number of horizontal halo points for produced arrays.</p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.data_dimensions","title":"<code>data_dimensions</code>  <code>instance-attribute</code>","text":"<p>Name/Lengths pair of any non-x/y/z dimensions, such as land or radiation dimensions.</p>"},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.__init__","title":"<code>__init__(nx, ny, nz, n_halo, data_dimensions)</code>","text":""},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.get_origin","title":"<code>get_origin(dims)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.get_extent","title":"<code>get_extent(dims)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/initialization/grid_sizer/#initialization.grid_sizer.GridSizer.get_shape","title":"<code>get_shape(dims)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/","title":"subtile_grid_sizer","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer","title":"<code>SubtileGridSizer</code>","text":"<p>               Bases: <code>GridSizer</code></p>"},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.dim_extents","title":"<code>dim_extents</code>  <code>property</code>","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.__init__","title":"<code>__init__(nx, ny, nz, n_halo, data_dimensions, backend)</code>","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.from_tile_params","title":"<code>from_tile_params(nx_tile, ny_tile, nz, n_halo, layout, *, backend, data_dimensions=None, tile_partitioner=None, tile_rank=0)</code>  <code>classmethod</code>","text":"<p>Create a SubtileGridSizer from parameters about the full tile.</p> <p>Parameters:</p> Name Type Description Default <code>nx_tile</code> <code>int</code> <p>number of x cell centers on the tile</p> required <code>ny_tile</code> <code>int</code> <p>number of y cell centers on the tile</p> required <code>nz</code> <code>int</code> <p>number of vertical levels</p> required <code>n_halo</code> <code>int</code> <p>number of halo points</p> required <code>layout</code> <code>tuple[int, int]</code> <p>(y, x) number of ranks along tile edges</p> required <code>backend</code> <code>str</code> <p>backend name</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>lengths of any non-x/y/z dimensions, such as land or radiation dimensions</p> <code>None</code> <code>tile_partitioner</code> <code>optional</code> <p>partitioner object for the tile. By default, a TilePartitioner is created with the given layout</p> <code>None</code> <code>tile_rank</code> <code>optional</code> <p>rank of this subtile.</p> <code>0</code>"},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.from_namelist","title":"<code>from_namelist(namelist, tile_partitioner=None, tile_rank=0, *, backend)</code>  <code>classmethod</code>","text":"<p>Create a SubtileGridSizer from a Fortran namelist.</p> <p>Parameters:</p> Name Type Description Default <code>namelist</code> <code>dict</code> <p>A namelist for the fv3gfs fortran model</p> required <code>tile_partitioner</code> <code>optional</code> <p>a partitioner to use for segmenting the tile. By default, a TilePartitioner is used.</p> <code>None</code> <code>tile_rank</code> <code>optional</code> <p>current rank on tile. Default is 0. Only matters if different ranks have different domain shapes. If tile_partitioner is a TilePartitioner, this argument does not matter.</p> <code>0</code> <code>backend</code> <code>str</code> <p>backend name</p> required"},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.get_origin","title":"<code>get_origin(dims)</code>","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.get_extent","title":"<code>get_extent(dims)</code>","text":""},{"location":"docstrings/initialization/subtile_grid_sizer/#initialization.subtile_grid_sizer.SubtileGridSizer.get_shape","title":"<code>get_shape(dims)</code>","text":""},{"location":"docstrings/monitor/convert/","title":"convert","text":""},{"location":"docstrings/monitor/convert/#monitor.convert.to_numpy","title":"<code>to_numpy(array, dtype=None)</code>","text":"<p>Input array can be a numpy array or a cupy array. Returns numpy array.</p>"},{"location":"docstrings/monitor/netcdf_monitor/","title":"netcdf_monitor","text":""},{"location":"docstrings/monitor/netcdf_monitor/#monitor.netcdf_monitor.NetCDFMonitor","title":"<code>NetCDFMonitor</code>","text":"<p>sympl.Monitor-style object for storing model state dictionaries netCDF files.</p>"},{"location":"docstrings/monitor/netcdf_monitor/#monitor.netcdf_monitor.NetCDFMonitor.__init__","title":"<code>__init__(path, communicator, time_chunk_size=1, precision=Float)</code>","text":"<p>Create a NetCDFMonitor.</p> <p>Parameters:</p> Name Type Description Default <code>path</code> <code>str</code> <p>directory in which to store data</p> required <code>communicator</code> <code>Communicator</code> <p>provides global communication to gather state</p> required <code>time_chunk_size</code> <code>int</code> <p>number of times per file</p> <code>1</code>"},{"location":"docstrings/monitor/netcdf_monitor/#monitor.netcdf_monitor.NetCDFMonitor.store","title":"<code>store(state)</code>","text":"<p>Append the model state dictionary to the netcdf files.</p> <p>Will only write to disk when a full time chunk has been accumulated, or when .cleanup() is called.</p> <p>Requires the state contain the same quantities with the same metadata as the first time this is called. Dimension order metadata may change between calls so long as the set of dimensions is the same. Quantities are stored with dimensions [time, tile] followed by the dimensions included in the first state snapshot. The one exception is \"time\" which is stored with dimensions [time].</p>"},{"location":"docstrings/monitor/netcdf_monitor/#monitor.netcdf_monitor.NetCDFMonitor.store_constant","title":"<code>store_constant(state)</code>","text":""},{"location":"docstrings/monitor/netcdf_monitor/#monitor.netcdf_monitor.NetCDFMonitor.cleanup","title":"<code>cleanup()</code>","text":""},{"location":"docstrings/monitor/protocol/","title":"protocol","text":""},{"location":"docstrings/monitor/protocol/#monitor.protocol.Monitor","title":"<code>Monitor</code>","text":"<p>               Bases: <code>Protocol</code></p> <p>sympl.Monitor-style object for storing model state dictionaries.</p>"},{"location":"docstrings/monitor/protocol/#monitor.protocol.Monitor.store","title":"<code>store(state)</code>","text":"<p>Append the model state dictionary to the stored data.</p>"},{"location":"docstrings/monitor/protocol/#monitor.protocol.Monitor.store_constant","title":"<code>store_constant(state)</code>","text":""},{"location":"docstrings/monitor/protocol/#monitor.protocol.Monitor.cleanup","title":"<code>cleanup()</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/","title":"zarr_monitor","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor","title":"<code>ZarrMonitor</code>","text":"<p>sympl.Monitor-style object for storing model state dictionaries in a Zarr store.</p>"},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor.partitioner","title":"<code>partitioner = partitioner</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor.__init__","title":"<code>__init__(store, partitioner, mpi_comm, *, mode='w')</code>","text":"<p>Create a ZarrMonitor.</p> <p>Parameters:</p> Name Type Description Default <code>store</code> <code>str | MutableMapping</code> <p>Zarr store in which to store data</p> required <code>partitioner</code> <code>Partitioner</code> <p>object providing grid layout information to the Monitor</p> required <code>mpi_comm</code> <code>Comm</code> <p>mpi4py comm object to use for communications.</p> required <code>mode</code> <code>str</code> <p>mode to use to open the store. Options are as in zarr.open_group.</p> <code>'w'</code>"},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor.store","title":"<code>store(state)</code>","text":"<p>Append the model state dictionary to the zarr store.</p> <p>Requires the state contain the same quantities with the same metadata as the first time this is called. Dimension order metadata may change between calls so long as the set of dimensions is the same. Quantities are stored with dimensions [time, rank] followed by the dimensions included in the first state snapshot. The one exception is \"time\" which is stored with dimensions [time].</p>"},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor.store_constant","title":"<code>store_constant(state)</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.ZarrMonitor.cleanup","title":"<code>cleanup()</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.array_chunks","title":"<code>array_chunks(layout, tile_array_shape, array_dims)</code>","text":""},{"location":"docstrings/monitor/zarr_monitor/#monitor.zarr_monitor.get_calendar","title":"<code>get_calendar(time)</code>","text":""},{"location":"docstrings/performance/collector/","title":"collector","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector","title":"<code>AbstractPerformanceCollector</code>","text":"<p>               Bases: <code>Protocol</code></p>"},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.total_timer","title":"<code>total_timer</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.timestep_timer","title":"<code>timestep_timer</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.collect_performance","title":"<code>collect_performance()</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.write_out_performance","title":"<code>write_out_performance(backend, is_orchestrated, dt_atmos)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.write_out_rank_0","title":"<code>write_out_rank_0(backend, is_orchestrated, dt_atmos, sim_status)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.start_cuda_profiler","title":"<code>start_cuda_profiler()</code>  <code>classmethod</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.stop_cuda_profiler","title":"<code>stop_cuda_profiler()</code>  <code>classmethod</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.AbstractPerformanceCollector.mark_cuda_profiler","title":"<code>mark_cuda_profiler(message)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector","title":"<code>PerformanceCollector</code>","text":"<p>               Bases: <code>AbstractPerformanceCollector</code></p>"},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.times_per_step","title":"<code>times_per_step = []</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.hits_per_step","title":"<code>hits_per_step = []</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.timestep_timer","title":"<code>timestep_timer = Timer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.total_timer","title":"<code>total_timer = Timer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.experiment_name","title":"<code>experiment_name = experiment_name</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.comm","title":"<code>comm = comm</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.__init__","title":"<code>__init__(experiment_name, comm)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.clear","title":"<code>clear()</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.collect_performance","title":"<code>collect_performance()</code>","text":"<p>Take the accumulated timings and flush them into a new entry in times_per_step and hits_per_step.</p>"},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.write_out_rank_0","title":"<code>write_out_rank_0(backend, is_orchestrated, dt_atmos, sim_status)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.PerformanceCollector.write_out_performance","title":"<code>write_out_performance(backend, is_orchestrated, dt_atmos)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector","title":"<code>NullPerformanceCollector</code>","text":"<p>               Bases: <code>AbstractPerformanceCollector</code></p>"},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.total_timer","title":"<code>total_timer = NullTimer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.timestep_timer","title":"<code>timestep_timer = NullTimer()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.collect_performance","title":"<code>collect_performance()</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.write_out_performance","title":"<code>write_out_performance(backend, is_orchestrated, dt_atmos)</code>","text":""},{"location":"docstrings/performance/collector/#performance.collector.NullPerformanceCollector.write_out_rank_0","title":"<code>write_out_rank_0(backend, is_orchestrated, dt_atmos, sim_status)</code>","text":""},{"location":"docstrings/performance/config/","title":"config","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig","title":"<code>PerformanceConfig</code>  <code>dataclass</code>","text":"<p>Performance stats collector.</p> <p>collect_performance: overall flag turning collection on/pff collect_cProfile: use cProfile for CPU Python profiling collect_communication: collect halo exchange details experiment_name: to be printed in the JSON summary json_all_rank_threshold: number of nodes above the full performance     report for all nodes won't be written (rank 0 is always written)</p>"},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.collect_performance","title":"<code>collect_performance = False</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.collect_cProfile","title":"<code>collect_cProfile = False</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.collect_communication","title":"<code>collect_communication = False</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.experiment_name","title":"<code>experiment_name = 'test'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.json_all_rank_threshold","title":"<code>json_all_rank_threshold = 1000</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.__init__","title":"<code>__init__(collect_performance=False, collect_cProfile=False, collect_communication=False, experiment_name='test', json_all_rank_threshold=1000)</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.build","title":"<code>build(comm)</code>","text":""},{"location":"docstrings/performance/config/#performance.config.PerformanceConfig.build_profiler","title":"<code>build_profiler()</code>","text":""},{"location":"docstrings/performance/profiler/","title":"profiler","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler","title":"<code>Profiler</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler.profiler","title":"<code>profiler = cProfile.Profile()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler.enabled","title":"<code>enabled</code>  <code>property</code>","text":"<p>Indicates whether the profiler is currently enabled.</p>"},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler.enable","title":"<code>enable()</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.Profiler.dump_stats","title":"<code>dump_stats(filename)</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler","title":"<code>NullProfiler</code>","text":"<p>A profiler class which does not actually profile anything.</p> <p>Meant to be used in place of an optional profiler.</p>"},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler.profiler","title":"<code>profiler = None</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler.enabled","title":"<code>enabled</code>  <code>property</code>","text":"<p>Indicates whether the profiler is enabled.</p>"},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler.enable","title":"<code>enable()</code>","text":""},{"location":"docstrings/performance/profiler/#performance.profiler.NullProfiler.dump_stats","title":"<code>dump_stats(filename)</code>","text":""},{"location":"docstrings/performance/report/","title":"report","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment","title":"<code>Experiment</code>  <code>dataclass</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.dataset","title":"<code>dataset</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.format_version","title":"<code>format_version</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.git_hash","title":"<code>git_hash</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.timestamp","title":"<code>timestamp</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.timesteps","title":"<code>timesteps</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.backend","title":"<code>backend</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Experiment.__init__","title":"<code>__init__(dataset, format_version, git_hash, timestamp, timesteps, backend)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.TimeReport","title":"<code>TimeReport</code>  <code>dataclass</code>","text":""},{"location":"docstrings/performance/report/#performance.report.TimeReport.hits","title":"<code>hits</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.TimeReport.times","title":"<code>times</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.TimeReport.__init__","title":"<code>__init__(hits, times)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report","title":"<code>Report</code>  <code>dataclass</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.setup","title":"<code>setup</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.times","title":"<code>times</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.dt_atmos","title":"<code>dt_atmos</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.sim_status","title":"<code>sim_status = 'Finished'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.SYPD","title":"<code>SYPD = 0.0</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/performance/report/#performance.report.Report.__init__","title":"<code>__init__(setup, times, dt_atmos, sim_status='Finished', SYPD=0.0)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.get_experiment_info","title":"<code>get_experiment_info(experiment_name, time_step, backend, git_hash, is_orchestrated)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.collect_keys_from_data","title":"<code>collect_keys_from_data(times_per_step)</code>","text":"<p>Collects all the keys in the list of dicts and returns a sorted version</p>"},{"location":"docstrings/performance/report/#performance.report.gather_timing_data","title":"<code>gather_timing_data(times_per_step, comm, root=0)</code>","text":"<p>returns an updated version of the results dictionary owned by the root node to hold data on the substeps as well as the main loop timers</p>"},{"location":"docstrings/performance/report/#performance.report.write_to_timestamped_json","title":"<code>write_to_timestamped_json(experiment)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.gather_hit_counts","title":"<code>gather_hit_counts(hits_per_step, timing_info)</code>","text":"<p>collects the hit count across all timers called in a program execution</p>"},{"location":"docstrings/performance/report/#performance.report.get_sypd","title":"<code>get_sypd(timing_info, dt_atmos)</code>","text":""},{"location":"docstrings/performance/report/#performance.report.collect_data_and_write_to_file","title":"<code>collect_data_and_write_to_file(time_step, backend, is_orchestrated, git_hash, comm, hits_per_step, times_per_step, experiment_name, dt_atmos)</code>","text":"<p>collect the gathered data from all the ranks onto rank 0 and write the timing file</p>"},{"location":"docstrings/performance/timer/","title":"timer","text":""},{"location":"docstrings/performance/timer/#performance.timer.Timer","title":"<code>Timer</code>","text":"<p>Class to accumulate timings for named operations.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.times","title":"<code>times</code>  <code>property</code>","text":"<p>accumulated timings for each operation name</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.hits","title":"<code>hits</code>  <code>property</code>","text":"<p>accumulated hit counts for each operation name</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.enabled","title":"<code>enabled</code>  <code>property</code>","text":"<p>Indicates whether the timer is currently enabled.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/performance/timer/#performance.timer.Timer.start","title":"<code>start(name)</code>","text":"<p>Start timing a given named operation.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.stop","title":"<code>stop(name)</code>","text":"<p>Stop timing a given named operation, add the time elapsed to accumulated timing and increase the hit count.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.clock","title":"<code>clock(name)</code>","text":"<p>Context manager to produce timings of operations.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>the name of the operation being timed</p> required <p>Example</p> <p>The context manager times operations that happen within its context. The following would time a time.sleep operation::</p> <pre><code>&gt;&gt;&gt; import time\n&gt;&gt;&gt; from ndsl.performance.timer import Timer\n&gt;&gt;&gt; timer = Timer()\n&gt;&gt;&gt; with timer.clock(\"sleep\"):\n...     time.sleep(1)\n...\n&gt;&gt;&gt; timer.times\n{'sleep': 1.0032463260000029}\n</code></pre>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.reset","title":"<code>reset()</code>","text":"<p>Remove all accumulated timings.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.enable","title":"<code>enable()</code>","text":"<p>Enable the Timer.</p>"},{"location":"docstrings/performance/timer/#performance.timer.Timer.disable","title":"<code>disable()</code>","text":"<p>Disable the Timer.</p>"},{"location":"docstrings/performance/timer/#performance.timer.NullTimer","title":"<code>NullTimer</code>","text":"<p>               Bases: <code>Timer</code></p> <p>A Timer class which does not actually accumulate timings.</p> <p>Meant to be used in place of an optional timer.</p>"},{"location":"docstrings/performance/timer/#performance.timer.NullTimer.enabled","title":"<code>enabled</code>  <code>property</code>","text":"<p>Indicates whether the timer is currently enabled.</p>"},{"location":"docstrings/performance/timer/#performance.timer.NullTimer.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/performance/timer/#performance.timer.NullTimer.enable","title":"<code>enable()</code>","text":"<p>Enable the Timer.</p>"},{"location":"docstrings/performance/tools/","title":"tools","text":""},{"location":"docstrings/performance/tools/#performance.tools.ACTION_SDFG_MEMORY_STATIC_ANALYSIS","title":"<code>ACTION_SDFG_MEMORY_STATIC_ANALYSIS = 'sdfg_memory_static_analysis'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/performance/tools/#performance.tools.ACTION_SDFG_KERNEL_THEORETICAL_TIMING","title":"<code>ACTION_SDFG_KERNEL_THEORETICAL_TIMING = 'sdfg_kernel_theoretical_timing'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/performance/tools/#performance.tools.command_line","title":"<code>command_line(action, sdfg_path, report_detail, hardware_bw_in_gb_s, output_format, backend)</code>","text":"<p>Run tooling.</p>"},{"location":"docstrings/quantity/bounds/","title":"bounds","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundaryArrayView","title":"<code>BoundaryArrayView</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundaryArrayView.__init__","title":"<code>__init__(data, boundary_type, dims, origin, extent)</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundaryArrayView.sel","title":"<code>sel(**kwargs)</code>","text":"<p>Convenience method to perform indexing using dimension names without knowing dimension order.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <code>slice | int</code> <p>slice/index to retrieve for a given dimension name</p> <code>{}</code> <p>Returns:</p> Name Type Description <code>view_selection</code> <code>ndarray</code> <p>an ndarray-like selection of the given indices on <code>self.view</code></p>"},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView","title":"<code>BoundedArrayView</code>","text":"<p>A container of objects which provide indexing relative to corners and edges of the computational domain for convenience.</p> <p>Default start and end indices for all dimensions are modified to be the start and end of the compute domain. When using edge and corner attributes, it is recommended to explicitly write start and end offsets to avoid confusion.</p> <p>Indexing on the object itself (view[:]) is offset by the origin, and default start and end indices are modified to be the start and end of the compute domain.</p> <p>For corner attributes e.g. <code>northwest</code>, modified indexing is done for the two axes according to the edges which make up the corner. In other words, indexing is offset relative to the intersection of the two edges which make the corner.</p> <p>For <code>interior</code>, start indices of the horizontal dimensions are relative to the origin, and end indices are relative to the origin + extent. For example, view.interior[0:0, 0:0, :] would retrieve the entire compute domain for an x/y/z array, while view.interior[-1:1, -1:1, :] would also include one halo point.</p>"},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.origin","title":"<code>origin</code>  <code>property</code>","text":"<p>the start of the computational domain</p>"},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.extent","title":"<code>extent</code>  <code>property</code>","text":"<p>the shape of the computational domain</p>"},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.northwest","title":"<code>northwest</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.northeast","title":"<code>northeast</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.southwest","title":"<code>southwest</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.southeast","title":"<code>southeast</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.interior","title":"<code>interior</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/bounds/#quantity.bounds.BoundedArrayView.__init__","title":"<code>__init__(array, dims, origin, extent)</code>","text":""},{"location":"docstrings/quantity/field_bundle/","title":"field_bundle","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle","title":"<code>FieldBundle</code>","text":"<p>Field Bundle wraps a nD array (3D + n Data Dimensions) into a complex indexing scheme that allows a dual name-based and index-based access to the underlying memory. It is paired with the <code>FieldBundleType</code> which provides a way to type hint parameters for stencils in the <code>gtscript</code>.</p> <p>WARNING: The present implementation only allows for 4D array.</p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.name","title":"<code>name = bundle_name</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.quantity","title":"<code>quantity</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.shape","title":"<code>shape</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.__init__","title":"<code>__init__(bundle_name, quantity, mapping=None, register_type=False)</code>","text":"<p>Initialize a bundle from a nD quantity.</p> <p>Dev note: current implementation limits to 4D inputs.</p> <p>Parameters:</p> Name Type Description Default <code>bundle_name</code> <code>str</code> <p>name of the bundle, accessible via <code>name</code>.</p> required <code>quantity</code> <code>Quantity</code> <p>data inputs as a nD array.</p> required <code>mapping</code> <code>_FieldBundleIndexer | None</code> <p>sparse dict of [name, index] to be able to call tracers by name.</p> <code>None</code> <code>register_type</code> <code>bool</code> <p>boolean to register the type as part of initialization.</p> <code>False</code>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.map","title":"<code>map(index, name)</code>","text":"<p>Map a single <code>index</code> to <code>name</code></p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.groupby","title":"<code>groupby(name)</code>","text":"<p>Not implemented</p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.index","title":"<code>index(name)</code>","text":"<p>Get index from name.</p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundle.extend_3D_quantity_factory","title":"<code>extend_3D_quantity_factory(quantity_factory, extra_dims)</code>  <code>staticmethod</code>","text":"<p>Create a nD quantity factory from a cartesian 3D factory.</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>Cartesian 3D factory.</p> required <code>extra_dims</code> <code>dict[str, int]</code> <p>dict of [name, size] of the data dimensions to add.</p> required"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.MarkupFieldBundleType","title":"<code>MarkupFieldBundleType</code>  <code>dataclass</code>","text":"<p>Markup a field bundle to delay specialization.</p> <p>Properties</p> <p>name: name of the future type to look into the registrar.</p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.MarkupFieldBundleType.name","title":"<code>name</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.MarkupFieldBundleType.__init__","title":"<code>__init__(name)</code>","text":""},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundleType","title":"<code>FieldBundleType</code>","text":"<p>Field Bundle Types to help with static sizing of Data Dimensions.</p> <p>Methods:</p> Name Description <code>register</code> <p>Register a type by sizing its data dimensions</p> <code>T</code> <p>access any registered types for type hinting.</p>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundleType.register","title":"<code>register(name, data_dims, dtype=Float)</code>  <code>classmethod</code>","text":"<p>Register a name type by name by giving the size of its data dimensions.</p> <p>The same type cannot be registered twice and will error out.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>Type name, to be re-used with <code>T</code>.</p> required <code>data_dims</code> <code>tuple[int]</code> <p>tuple of int giving size of each data dimensions.</p> required <code>dtype</code> <p>Inner data type, defaults to Float.</p> <code>Float</code>"},{"location":"docstrings/quantity/field_bundle/#quantity.field_bundle.FieldBundleType.T","title":"<code>T(name, do_markup=True)</code>  <code>classmethod</code>","text":"<p>Get registered type.</p> <p>Dev note: The markup feature is to allow early parsing (at file import) to go ahead - while we will resolve the full type when calling the stencil.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>name of the type as registered via <code>register</code></p> required <code>do_markup</code> <code>bool</code> <p>if name not registered, markup for a future specialization at stencil call time</p> <code>True</code>"},{"location":"docstrings/quantity/metadata/","title":"metadata","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata","title":"<code>QuantityMetadata</code>  <code>dataclass</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.origin","title":"<code>origin</code>  <code>instance-attribute</code>","text":"<p>The start of the computational domain.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.extent","title":"<code>extent</code>  <code>instance-attribute</code>","text":"<p>The shape of the computational domain.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.n_halo","title":"<code>n_halo</code>  <code>instance-attribute</code>","text":"<p>Number of halo-points used in the horizontal.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.dims","title":"<code>dims</code>  <code>instance-attribute</code>","text":"<p>Names of each dimension.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.units","title":"<code>units</code>  <code>instance-attribute</code>","text":"<p>Units of the quantity.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.data_type","title":"<code>data_type</code>  <code>instance-attribute</code>","text":"<p>ndarray-like type used to store the data.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.dtype","title":"<code>dtype</code>  <code>instance-attribute</code>","text":"<p>dtype of the data in the ndarray-like object.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.backend","title":"<code>backend</code>  <code>instance-attribute</code>","text":"<p>GT4Py backend name. Used for performance optimal data allocation.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.dim_lengths","title":"<code>dim_lengths</code>  <code>property</code>","text":"<p>Mapping of dimension names to their lengths.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.np","title":"<code>np</code>  <code>property</code>","text":"<p>numpy-like module used to interact with the data.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.__init__","title":"<code>__init__(origin, extent, n_halo, dims, units, data_type, dtype, backend)</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityMetadata.duplicate_metadata","title":"<code>duplicate_metadata(metadata_copy)</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec","title":"<code>QuantityHaloSpec</code>  <code>dataclass</code>","text":"<p>Describe the memory to be exchanged, including size of the halo.</p>"},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.n_points","title":"<code>n_points</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.strides","title":"<code>strides</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.itemsize","title":"<code>itemsize</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.shape","title":"<code>shape</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.origin","title":"<code>origin</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.extent","title":"<code>extent</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.dims","title":"<code>dims</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.numpy_module","title":"<code>numpy_module</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.dtype","title":"<code>dtype</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/quantity/metadata/#quantity.metadata.QuantityHaloSpec.__init__","title":"<code>__init__(n_points, strides, itemsize, shape, origin, extent, dims, numpy_module, dtype)</code>","text":""},{"location":"docstrings/quantity/quantity/","title":"quantity","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity","title":"<code>Quantity</code>","text":"<p>Data container for physical quantities.</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.metadata","title":"<code>metadata</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.units","title":"<code>units</code>  <code>property</code>","text":"<p>Units of the quantity</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.backend","title":"<code>backend</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.attrs","title":"<code>attrs</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.dims","title":"<code>dims</code>  <code>property</code>","text":"<p>Names of each dimension</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.view","title":"<code>view</code>  <code>property</code>","text":"<p>A view into the computational domain of the underlying data</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.field","title":"<code>field</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.data","title":"<code>data</code>  <code>property</code> <code>writable</code>","text":"<p>The underlying array of data</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.origin","title":"<code>origin</code>  <code>property</code>","text":"<p>The start of the computational domain</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.extent","title":"<code>extent</code>  <code>property</code>","text":"<p>The shape of the computational domain</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.field_as_xarray","title":"<code>field_as_xarray</code>  <code>property</code>","text":"<p>Returns an Xarray.DataArray of the field (domain)</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.data_as_xarray","title":"<code>data_as_xarray</code>  <code>property</code>","text":"<p>Returns an Xarray.DataArray of the underlying array</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.np","title":"<code>np</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.shape","title":"<code>shape</code>  <code>property</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.__init__","title":"<code>__init__(data, dims, units, *, backend, origin=None, extent=None, allow_mismatch_float_precision=False, number_of_halo_points=0)</code>","text":"<p>Initialize a Quantity.</p> <p>Parameters:</p> Name Type Description Default <code>data</code> <code>ndarray | ndarray</code> <p>ndarray-like object containing the underlying data</p> required <code>dims</code> <code>Sequence[str]</code> <p>dimension names for each axis</p> required <code>units</code> <code>str</code> <p>units of the quantity</p> required <code>backend</code> <code>str</code> <p>GT4Py backend name. We ensure that the data is allocated in a performance optimal way for that backend and copy if necessary.</p> required <code>origin</code> <code>Sequence[int] | None</code> <p>first point in data within the computational domain. Defaults to None.</p> <code>None</code> <code>extent</code> <code>Sequence[int] | None</code> <p>number of points along each axis within the computational domain. Defaults to None.</p> <code>None</code> <code>allow_mismatch_float_precision</code> <code>bool</code> <p>allow for precision that is not the simulation-wide default configuration. Defaults to False.</p> <code>False</code> <code>number_of_halo_points</code> <code>int</code> <p>Number of halo points used. Defaults to 0.</p> <code>0</code> <p>Raises:</p> Type Description <code>ValueError</code> <p>Data-type mismatch between configuration and input-data</p> <code>TypeError</code> <p>Typing of the data that does not fit</p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.from_data_array","title":"<code>from_data_array(data_array, *, origin=None, extent=None, number_of_halo_points=0, backend=None, allow_mismatch_float_precision=False)</code>  <code>classmethod</code>","text":"<p>Initialize a Quantity from an <code>xarray.DataArray</code>.</p> <p>Parameters:</p> Name Type Description Default <code>data_array</code> <code>DataArray</code> <p><code>xarray.DataArray</code> to initialize from</p> required <code>origin</code> <code>Sequence[int] | None</code> <p>first point in data within the computational domain</p> <code>None</code> <code>extent</code> <code>Sequence[int] | None</code> <p>number of points along each axis within the computational domain</p> <code>None</code> <code>allow_mismatch_float_precision</code> <code>bool</code> <p>allow for precision that is not the simulation-wide default configuration. Defaults to False.</p> <code>False</code> <code>number_of_halo_points</code> <code>int</code> <p>Number of halo points used. Defaults to 0.</p> <code>0</code> <code>backend</code> <code>str | None</code> <p>GT4Py backend name. If given, we allocate data in a performance optimal way for this backend. Overrides any potentially saved <code>backend</code> in <code>data.attrs[\"backend\"]</code>.</p> <code>None</code>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.to_netcdf","title":"<code>to_netcdf(path, name='var', rank=-1, all_data=False)</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.halo_spec","title":"<code>halo_spec(n_halo)</code>","text":""},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.sel","title":"<code>sel(**kwargs)</code>","text":"<p>Convenience method to perform indexing on <code>view</code> using dimension names without knowing dimension order.</p> <p>Parameters:</p> Name Type Description Default <code>**kwargs</code> <code>slice | int</code> <p>slice/index to retrieve for a given dimension name</p> <code>{}</code> <p>Returns:</p> Name Type Description <code>view_selection</code> <code>ndarray</code> <p>an ndarray-like selection of the given indices on <code>self.view</code></p>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.transpose","title":"<code>transpose(target_dims, allow_mismatch_float_precision=False)</code>","text":"<p>Change the dimension order of this Quantity.</p> <p>Parameters:</p> Name Type Description Default <code>target_dims</code> <code>Sequence[str | Iterable[str]]</code> <p>a list of output dimensions. Instead of a single dimension name, an iterable of dimensions can be used instead for any entries. For example, you may want to use I_DIMS to place an x-dimension without knowing whether it is on cell centers or interfaces.</p> required <p>Returns:</p> Name Type Description <code>transposed</code> <code>Quantity</code> <p>Quantity with the requested output dimension order</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>if any of the target dimensions do not exist on this Quantity, or if this Quantity contains multiple values from an iterable entry</p> <p>Examples:</p> <p>Let's say we have a cell-centered variable:</p> <pre><code>&gt;&gt;&gt; import ndsl.util\n&gt;&gt;&gt; import numpy as np\n&gt;&gt;&gt; quantity = Quantity(\n...     data=np.zeros([2, 3, 4]),\n...     dims=[I_DIM, J_DIM, K_DIM],\n...             units=\"m\",\n... )\n</code></pre> <p>If you know you are working with cell-centered variables, you can do:</p> <pre><code>&gt;&gt;&gt; from ndsl.constants import I_DIM, J_DIM, K_DIM\n&gt;&gt;&gt; transposed_quantity = quantity.transpose([I_DIM, J_DIM, K_DIM])\n</code></pre> <p>To support re-ordering without checking whether quantities are on cell centers or interfaces, the API supports giving a list of dimension names for dimensions. For example, to re-order to X-Y-Z dimensions regardless of the grid the variable is on, one could do:</p> <pre><code>&gt;&gt;&gt; from ndsl.constants import I_DIMS, J_DIMS, K_DIMS\n&gt;&gt;&gt; transposed_quantity = quantity.transpose([I_DIMS, J_DIMS, K_DIMS])\n</code></pre>"},{"location":"docstrings/quantity/quantity/#quantity.quantity.Quantity.plot_k_level","title":"<code>plot_k_level(k_index=0)</code>","text":""},{"location":"docstrings/quantity/state/","title":"state","text":""},{"location":"docstrings/quantity/state/#quantity.state.StateMemoryMapping","title":"<code>StateMemoryMapping = dict[str, dict | ArrayLike | None]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.OptionalQuantityType","title":"<code>OptionalQuantityType = Quantity | None</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.StateElementType","title":"<code>StateElementType = dict[str, Quantity | OptionalQuantityType | Local | dict[str, Any]]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.State","title":"<code>State</code>  <code>dataclass</code>","text":"<p>Base class for state objects in models.</p> <p>A State groups a collection of (possibly nested) Quantities in a dataclass.</p> <p>This baseclass implements common initialization functions and serialization.</p> <p>Typical usage example:</p> <pre><code>    class MyState(State):\n        pass\n\n    my_state = MyState.zeros(quantity_factory)\n\n    # ...\n\n    my_state.to_netcdf()\n</code></pre>"},{"location":"docstrings/quantity/state/#quantity.state.State.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.State.empty","title":"<code>empty(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities. Do not expect 0 on values, values are random.</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.zeros","title":"<code>zeros(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities and fill their value to zeros</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.ones","title":"<code>ones(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities and fill their value to ones</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.full","title":"<code>full(quantity_factory, value, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities and fill them with the input value</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>value</code> <code>Number</code> <p>number to initialize the buffers with.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.copy_memory","title":"<code>copy_memory(quantity_factory, memory_map, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities and fill their value based on the given memory map. See <code>update_from_memory</code>.</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>memory_map</code> <code>StateMemoryMapping</code> <p>Dict of name/buffer. See <code>update_from_memory</code>.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.move_memory","title":"<code>move_memory(quantity_factory, memory_map, *, data_dimensions=None, check_shape_and_strides=True)</code>  <code>classmethod</code>","text":"<p>Allocate all quantities and move memory based on on the given memory map. See <code>update_move_memory</code>.</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>memory_map</code> <code>StateMemoryMapping</code> <p>Dict of name/buffer. See <code>update_from_memory</code>.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code> <code>check_shape_and_strides</code> <code>bool</code> <p>Check for every given buffer that the shape &amp; strides match the previously allocated memory.</p> <code>True</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.fill","title":"<code>fill(value)</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.State.update_copy_memory","title":"<code>update_copy_memory(memory_map)</code>","text":"<p>Copy data into the Quantities carried by the state.</p> <p>The memory map must follow the dataclass naming convention, e.g.</p> <p><pre><code>@dataclass\nclass MyState:\n    @dataclass\n    class InnerA\n        a: Quantity\n\n    inner_a: InnerA\n    b: Quantity\n</code></pre> will update with a dictionary looking like <pre><code>{\n    \"inner_a\":\n    {\n        \"a\": Quantity(...)\n    }\n    \"b\": Quantity(...)\n\n}\n</code></pre></p> <p>The memory map can be sparse.</p>"},{"location":"docstrings/quantity/state/#quantity.state.State.update_move_memory","title":"<code>update_move_memory(memory_map, *, check_shape_and_strides=True)</code>","text":"<p>Move memory into the Quantities carried by the state. Memory is moved rather than copied (e.g. buffers are swapped)</p> <p>The memory map must follow the dataclass naming convention, e.g.</p> <p><pre><code>@dataclass\nclass MyState:\n    @dataclass\n    class InnerA\n        a: Quantity\n\n    inner_a: InnerA\n    b: Quantity\n</code></pre> will update with a dictionary looking like <pre><code>{\n    \"inner_a\":\n    {\n        \"a\": Quantity(...)\n    }\n    \"b\": Quantity(...)\n\n}\n</code></pre></p> <p>The memory map can be sparse.</p> <p>Parameters:</p> Name Type Description Default <code>memory_map</code> <code>StateMemoryMapping</code> <p>Dictionary of keys to buffers. Buffers must be np.ArrayLike</p> required <code>check_shape_and_strides</code> <code>bool</code> <p>check that the given buffers have the same shape and strides as the original quantity</p> <code>True</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.to_netcdf","title":"<code>to_netcdf(directory_path=None, postfix='')</code>","text":"<p>Save state to NetCDF. Can be reloaded with <code>update_from_netcdf</code>.</p> <p>If applicable, will save separate NetCDF files for each running rank.</p> <p>The file names are deduced from the class name, and post fix with rank number in the case of a multi-process use.</p> <p>Parameters:</p> Name Type Description Default <code>directory_path</code> <code>Path | None</code> <p>directory to save the netcdf in</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.State.update_from_netcdf","title":"<code>update_from_netcdf(directory_path, postfix='')</code>","text":"<p>This is a mirror of the <code>to_netcdf</code> method NOT a generic NetCDF loader. It expects the NetCDF to be named with the auto-naming scheme of <code>to_netcdf</code>.</p> <p>Parameters:</p> Name Type Description Default <code>directory_path</code> <code>Path</code> <p>directory carrying the netcdf saved with <code>to_netcdf</code></p> required"},{"location":"docstrings/quantity/state/#quantity.state.LocalState","title":"<code>LocalState</code>  <code>dataclass</code>","text":"<p>               Bases: <code>State</code></p>"},{"location":"docstrings/quantity/state/#quantity.state.LocalState.__init__","title":"<code>__init__()</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.LocalState.make_locals","title":"<code>make_locals(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allocate all elements as Locals. Do not expect 0 on values, values are random.</p> <p>Parameters:</p> Name Type Description Default <code>quantity_factory</code> <code>QuantityFactory</code> <p>factory, expected to be defined on the Grid dimensions e.g. without data dimensions.</p> required <code>data_dimensions</code> <code>dict[str, int] | None</code> <p>extra data dimensions required for any field with data dimensions. Dict of name/size pair.</p> <code>None</code>"},{"location":"docstrings/quantity/state/#quantity.state.LocalState.make_as_state","title":"<code>make_as_state(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":"<p>Allow LocalState to be allocate as if it was a regular State, e.g. with Quantities.</p> <p>This behavior is useful for testing and interfacing, but should not be used in the regular numerical workflow, hence the warning.</p>"},{"location":"docstrings/quantity/state/#quantity.state.LocalState.zeros","title":"<code>zeros(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.LocalState.empty","title":"<code>empty(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.LocalState.ones","title":"<code>ones(quantity_factory, *, data_dimensions=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/quantity/state/#quantity.state.LocalState.full","title":"<code>full(quantity_factory, value, *, data_dimensions=None)</code>  <code>classmethod</code>","text":""},{"location":"docstrings/restart/_legacy_restart/","title":"_legacy_restart","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.RESTART_NAMES","title":"<code>RESTART_NAMES = ('fv_core.res', 'fv_srf_wnd.res', 'fv_tracer.res')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.RESTART_OPTIONAL_NAMES","title":"<code>RESTART_OPTIONAL_NAMES = ('sfc_data', 'phy_data')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.COUPLER_RES_NAME","title":"<code>COUPLER_RES_NAME = 'coupler.res'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.open_restart","title":"<code>open_restart(dirname, communicator, label='', only_names=None, to_state=None, tracer_properties=None)</code>","text":"<p>Load restart files output by the Fortran model into a state dictionary.</p> <p>Parameters:</p> Name Type Description Default <code>dirname</code> <code>str</code> <p>location of restart files, can be local or remote</p> required <code>communicator</code> <code>Communicator</code> <p>object for communication over the cubed sphere or tile</p> required <code>label</code> <code>str</code> <p>prepended string on the restart files to load</p> <code>''</code> <code>only_names</code> <code>optional</code> <p>list of standard names to load</p> <code>None</code> <code>to_state</code> <code>optional</code> <p>if given, assign loaded data into pre-allocated quantities in this state dictionary</p> <code>None</code> <p>Returns:</p> Name Type Description <code>state</code> <code>dict</code> <p>model state dictionary</p>"},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.get_coupler_res_filename","title":"<code>get_coupler_res_filename(dirname, label)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.restart_files","title":"<code>restart_files(dirname, tile_index, label)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.restart_filenames","title":"<code>restart_filenames(dirname, tile_index, label)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.get_rank_suffix","title":"<code>get_rank_suffix(rank, total_ranks)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.map_keys","title":"<code>map_keys(old_dict, old_keys_to_new)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.prepend_label","title":"<code>prepend_label(filename, label=None)</code>","text":""},{"location":"docstrings/restart/_legacy_restart/#restart._legacy_restart.load_partial_state_from_restart_file","title":"<code>load_partial_state_from_restart_file(file, restart_properties, only_names=None)</code>","text":""},{"location":"docstrings/restart/_properties/","title":"_properties","text":"<p>:: restart._properties</p>"},{"location":"docstrings/stencils/basic_operations/","title":"basic_operations","text":""},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.copy","title":"<code>copy(q_in, q_out)</code>","text":"<p>Copy q_in to q_out.</p> <p>Parameters:</p> Name Type Description Default <code>q_in</code> <code>FloatField</code> <p>input field</p> required <code>q_out</code> <code>FloatField</code> <p>output field</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.adjustmentfactor_stencil","title":"<code>adjustmentfactor_stencil(adjustment, q_out)</code>","text":"<p>Multiplies every element of q_out by every element of the adjustment field over the interval, replacing the elements of q_out by the result of the multiplication.</p> <p>Parameters:</p> Name Type Description Default <code>adjustment</code> <code>FloatFieldIJ</code> <p>adjustment field</p> required <code>q_out</code> <code>FloatField</code> <p>output field</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.set_value","title":"<code>set_value(q_out, value)</code>","text":"<p>Sets every element of q_out to the value specified by value argument.</p> <p>Parameters:</p> Name Type Description Default <code>q_out</code> <code>FloatField</code> <p>output field</p> required <code>value</code> <code>Float</code> <p>NDSL Float type</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.set_value_2D","title":"<code>set_value_2D(buffer, value)</code>","text":"<p>Sets every element of buffer to the value specified by value argument.</p> <p>Parameters:</p> Name Type Description Default <code>buffer</code> <code>FloatFieldIJ</code> <p>output field</p> required <code>value</code> <code>Float</code> <p>value of Float type</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.set_IJ_mask_value","title":"<code>set_IJ_mask_value(mask_out, value)</code>","text":"<p>Sets every element of buffer to the value specified by value argument.</p> <p>Parameters:</p> Name Type Description Default <code>mask_out</code> <code>BoolFieldIJ</code> <p>output field</p> required <code>value</code> <code>Bool</code> <p>value of Bool type</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.adjust_divide_stencil","title":"<code>adjust_divide_stencil(adjustment, q_out)</code>","text":"<p>Divides every element of q_out by every element of the adjustment field over the interval, replacing the elements of q_out by the result of the division.</p> <p>Parameters:</p> Name Type Description Default <code>adjustment</code> <code>FloatField</code> <p>adjustment field</p> required <code>q_out</code> <code>FloatField</code> <p>output field</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.select_k","title":"<code>select_k(in_field, out_field, k_mask, k_select)</code>","text":"<p>Saves a specific k-index of a 3D field to a new 2D array. The k-value can be different for each i,j point.</p> <p>Parameters:</p> Name Type Description Default <code>in_field</code> <code>FloatField</code> <p>A 3D array to select from</p> required <code>out_field</code> <code>FloatFieldIJ</code> <p>A 2D field to save values in</p> required <code>k_mask</code> <code>IntField</code> <p>a field that lists each k-index</p> required <code>k_select</code> <code>IntFieldIJ</code> <p>the k-value to extract from in_field</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.average_in","title":"<code>average_in(q_out, adjustment)</code>","text":"<p>Averages every element of q_out with every element of the adjustment field, overwriting q_out.</p> <p>Parameters:</p> Name Type Description Default <code>adjustment</code> <code>FloatField</code> <p>adjustment field</p> required <code>q_out</code> <code>FloatField</code> <p>output field</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.sign","title":"<code>sign(a, b)</code>","text":"<p>Defines a_sign_b as the absolute value of a, and checks if b is positive or negative, assigning the analogous sign value to a_sign_b. a_sign_b is returned.</p> <p>Parameters:</p> Name Type Description Default <code>a</code> <p>A number</p> required <code>b</code> <p>A number</p> required"},{"location":"docstrings/stencils/basic_operations/#stencils.basic_operations.dim","title":"<code>dim(a, b)</code>","text":"<p>Calculates a - b, camped to 0, i.e. max(a - b, 0).</p>"},{"location":"docstrings/stencils/c2l_ord/","title":"c2l_ord","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.A1","title":"<code>A1 = 0.5625</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.A2","title":"<code>A2 = -0.0625</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.C1","title":"<code>C1 = 1.125</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.C2","title":"<code>C2 = -0.125</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.CubedToLatLon","title":"<code>CubedToLatLon</code>","text":"<p>Fortan name is c2l_ord2</p>"},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.CubedToLatLon.one_rank","title":"<code>one_rank = True</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.CubedToLatLon.u__v","title":"<code>u__v = WrappedHaloUpdater(comm.get_vector_halo_updater([full_size_xyiz_halo_spec], [full_size_xiyz_halo_spec]), state, ['u'], ['v'], comm=comm)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.CubedToLatLon.__init__","title":"<code>__init__(state, stencil_factory, quantity_factory, grid_data, grid_type, order, comm)</code>","text":"<p>Initializes stencils to use either 2nd or 4th order of interpolation based on namelist setting Args:     stencil_factory: creates stencils     grid_data: object with metric terms     order: Order of interpolation, must be 2 or 4</p>"},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.CubedToLatLon.__call__","title":"<code>__call__(u, v, ua, va)</code>","text":"<p>Interpolate D-grid to A-grid winds at latitude-longitude coordinates. Args:     u: x-wind on D-grid (in)     v: y-wind on D-grid (in)     ua: x-wind on A-grid (out)     va: y-wind on A-grid (out)     comm: Cubed-sphere or Tile communicator</p>"},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.mock_exchange","title":"<code>mock_exchange(quantity, domain_2d)</code>","text":""},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.c2l_ord2","title":"<code>c2l_ord2(u, v, dx, dy, a11, a12, a21, a22, ua, va)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>u</code> <code>in</code> required <code>v</code> <code>in</code> required <code>dx</code> <code>in</code> required <code>dy</code> <code>in</code> required <code>a11</code> <code>in</code> required <code>a12</code> <code>in</code> required <code>a21</code> <code>in</code> required <code>a22</code> <code>in</code> required <code>ua</code> <code>out</code> required <code>va</code> <code>out</code> required"},{"location":"docstrings/stencils/c2l_ord/#stencils.c2l_ord.ord4_transform","title":"<code>ord4_transform(u, v, dx, dy, a11, a12, a21, a22, ua, va)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>u</code> <code>in</code> required <code>v</code> <code>in</code> required <code>dx</code> <code>in</code> required <code>dy</code> <code>in</code> required <code>a11</code> <code>in</code> required <code>a12</code> <code>in</code> required <code>a21</code> <code>in</code> required <code>a22</code> <code>in</code> required <code>ua</code> <code>out</code> required <code>va</code> <code>out</code> required"},{"location":"docstrings/stencils/corners/","title":"corners","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.FillCornersDirection","title":"<code>FillCornersDirection = Literal['i', 'x', 'j', 'y']</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.GridType","title":"<code>GridType = Literal['A', 'B']</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.FillCornersBGrid","title":"<code>FillCornersBGrid</code>","text":"<p>Helper-class to fill corners corresponding to the fortran function fill_corners with BGRID=.true. and either FILL=YDir or FILL=YDIR</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.FillCornersBGrid.__init__","title":"<code>__init__(direction, stencil_factory, origin=None, domain=None)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.FillCornersBGrid.__call__","title":"<code>__call__(field)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.kslice_from_inputs","title":"<code>kslice_from_inputs(kstart, nk, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_mult_x","title":"<code>fill_corners_2cells_mult_x(q, q_corner, sw_mult, se_mult, nw_mult, ne_mult)</code>","text":"<p>Fills cell quantity q using corners from q_corner and multipliers in x-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_x_stencil","title":"<code>fill_corners_2cells_x_stencil(q_out, q_in)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_y_stencil","title":"<code>fill_corners_2cells_y_stencil(q_out, q_in)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_x","title":"<code>fill_corners_2cells_x(q)</code>","text":"<p>Fills cell quantity q in x-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_3cells_mult_x","title":"<code>fill_corners_3cells_mult_x(q, q_corner, sw_mult, se_mult, nw_mult, ne_mult)</code>","text":"<p>Fills cell quantity q using corners from q_corner and multipliers in x-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_mult_y","title":"<code>fill_corners_2cells_mult_y(q, q_corner, sw_mult, se_mult, nw_mult, ne_mult)</code>","text":"<p>Fills cell quantity q using corners from q_corner and multipliers in y-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2cells_y","title":"<code>fill_corners_2cells_y(q)</code>","text":"<p>Fills cell quantity q in y-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_3cells_mult_y","title":"<code>fill_corners_3cells_mult_y(q, q_corner, sw_mult, se_mult, nw_mult, ne_mult)</code>","text":"<p>Fills cell quantity q using corners from q_corner and multipliers in y-dir.</p>"},{"location":"docstrings/stencils/corners/#stencils.corners.copy_corners_xy_stencil_defn","title":"<code>copy_corners_xy_stencil_defn(q_in, q_out_x, q_out_y)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_bgrid_x_defn","title":"<code>fill_corners_bgrid_x_defn(q_in, q_out)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_bgrid_y_defn","title":"<code>fill_corners_bgrid_y_defn(q_in, q_out)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_sw_corner_2d_bgrid","title":"<code>fill_sw_corner_2d_bgrid(q, i, j, direction, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_nw_corner_2d_bgrid","title":"<code>fill_nw_corner_2d_bgrid(q, i, j, direction, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_se_corner_2d_bgrid","title":"<code>fill_se_corner_2d_bgrid(q, i, j, direction, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_ne_corner_2d_bgrid","title":"<code>fill_ne_corner_2d_bgrid(q, i, j, direction, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_sw_corner_2d_agrid","title":"<code>fill_sw_corner_2d_agrid(q, i, j, direction, grid_indexer, kstart=0, nk=None)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_nw_corner_2d_agrid","title":"<code>fill_nw_corner_2d_agrid(q, i, j, direction, grid_indexer, kstart=0, nk=None)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_se_corner_2d_agrid","title":"<code>fill_se_corner_2d_agrid(q, i, j, direction, grid_indexer, kstart=0, nk=None)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_ne_corner_2d_agrid","title":"<code>fill_ne_corner_2d_agrid(q, i, j, direction, grid_indexer, kstart=0, nk=None)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2d","title":"<code>fill_corners_2d(q, grid_indexer, gridtype, direction='i')</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2d_bgrid","title":"<code>fill_corners_2d_bgrid(q, grid_indexer, direction='i')</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_2d_agrid","title":"<code>fill_corners_2d_agrid(q, grid_indexer, direction='i')</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_agrid","title":"<code>fill_corners_agrid(x, y, grid_indexer, vector)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_sw_corner_vector_dgrid","title":"<code>fill_sw_corner_vector_dgrid(x, y, i, j, grid_indexer, mysign)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_nw_corner_vector_dgrid","title":"<code>fill_nw_corner_vector_dgrid(x, y, i, j, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_se_corner_vector_dgrid","title":"<code>fill_se_corner_vector_dgrid(x, y, i, j, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_ne_corner_vector_dgrid","title":"<code>fill_ne_corner_vector_dgrid(x, y, i, j, grid_indexer, mysign)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_dgrid","title":"<code>fill_corners_dgrid(x, y, grid_indexer, vector)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_sw_corner_vector_cgrid","title":"<code>fill_sw_corner_vector_cgrid(x, y, i, j, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_nw_corner_vector_cgrid","title":"<code>fill_nw_corner_vector_cgrid(x, y, i, j, grid_indexer, mysign)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_se_corner_vector_cgrid","title":"<code>fill_se_corner_vector_cgrid(x, y, i, j, grid_indexer, mysign)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_ne_corner_vector_cgrid","title":"<code>fill_ne_corner_vector_cgrid(x, y, i, j, grid_indexer)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_cgrid","title":"<code>fill_corners_cgrid(x, y, grid_indexer, vector)</code>","text":""},{"location":"docstrings/stencils/corners/#stencils.corners.fill_corners_dgrid_defn","title":"<code>fill_corners_dgrid_defn(x_in, x_out, y_in, y_out, mysign)</code>","text":"<p>Parameters:</p> Name Type Description Default <code>x_in</code> <code>in</code> required <code>x_out</code> <code>inout</code> required <code>y_in</code> <code>in</code> required <code>y_out</code> <code>inout</code> required"},{"location":"docstrings/stencils/tridiag/","title":"tridiag","text":""},{"location":"docstrings/stencils/tridiag/#stencils.tridiag.tridiag_solve","title":"<code>tridiag_solve(a, b, c, d, x, delta)</code>","text":"<p>This stencil solves a square, k x k tridiagonal matrix system with coefficients a, b, and c, and vectors p and d using the Thomas algorithm: ! ###                                            ### ###  ###   ###  ###! ! #b(0), c(0),  0  ,  0  ,  0  ,   . . .  ,    0   # # x(0) #   # d(0) #! ! #a(1), b(1), c(1),  0  ,  0  ,   . . .  ,    0   # # x(1) #   # d(1) #! ! # 0  , a(2), b(2), c(2),  0  ,   . . .  ,    0   # # x(2) #   # d(2) #! ! # 0  ,  0  , a(3), b(3), c(3),   . . .  ,    0   # # x(3) #   # d(3) #! ! # 0  ,  0  ,  0  , a(4), b(4),   . . .  ,    0   # # x(4) #   # d(4) #! ! # .                                          .   # #  .   # = #   .  #! ! # .                                          .   # #  .   #   #   .  #! ! # .                                          .   # #  .   #   #   .  #! ! # 0  , . . . , 0 , a(k-2), b(k-2), c(k-2),   0   # #x(k-3)#   #d(k-3)#! ! # 0  , . . . , 0 ,   0   , a(k-1), b(k-1), c(k-1)# #x(k-2)#   #d(k-2)#! ! # 0  , . . . , 0 ,   0   ,   0   ,  a(k) ,  b(k) # #x(k-1)#   #d(k-1)#! ! ###                                            ### ###  ###   ###  ###!</p> <p>Parameters:</p> Name Type Description Default <code>a</code> <code>in</code> <p>lower-diagonal matrix coefficients</p> required <code>b</code> <code>in</code> <p>diagonal matrix coefficients</p> required <code>c</code> <code>in</code> <p>upper-diagonal matrix coefficients</p> required <code>d</code> <code>in</code> <p>Result vector</p> required <code>x</code> <code>out</code> <p>The vector to solve for</p> required <code>delta</code> <code>out</code> <p>d post-pivot</p> required"},{"location":"docstrings/stencils/tridiag/#stencils.tridiag.masked_tridiag_solve","title":"<code>masked_tridiag_solve(a, b, c, d, x, delta, mask)</code>","text":"<p>Same as tridiag_solve but restricted to a subset of horizontal points</p> <p>Parameters:</p> Name Type Description Default <code>a</code> <code>in</code> <p>lower-diagonal matrix coefficients</p> required <code>b</code> <code>in</code> <p>diagonal matrix coefficients</p> required <code>c</code> <code>in</code> <p>upper-diagonal matrix coefficients</p> required <code>d</code> <code>in</code> <p>Result vector</p> required <code>mask</code> <code>in</code> <p>Columns to execute the stencil on</p> required <code>x</code> <code>out</code> <p>The vector to solve for</p> required <code>delta</code> <code>out</code> <p>d post-pivot</p> required"},{"location":"docstrings/testing/comparison/","title":"comparison","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric","title":"<code>BaseMetric</code>","text":"<p>               Bases: <code>ABC</code></p>"},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.references","title":"<code>references = np.atleast_1d(reference_values)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.computed","title":"<code>computed = np.atleast_1d(computed_values)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.check","title":"<code>check = False</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.__init__","title":"<code>__init__(reference_values, computed_values)</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.report","title":"<code>report(file_path=None)</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.BaseMetric.one_line_report","title":"<code>one_line_report()</code>  <code>abstractmethod</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric","title":"<code>LegacyMetric</code>","text":"<p>               Bases: <code>BaseMetric</code></p> <p>Legacy (AI2) metric used for original FV3 port.</p> <p>This metric attempts to smooth error comparison around 0. It further tries to deal with close-to-0 breakdown of absolute error by allowing <code>near_zero</code> threshold to be specified by hand.</p>"},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.eps","title":"<code>eps = eps</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.success","title":"<code>success = self._compute_errors(ignore_near_zero_errors, near_zero)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.check","title":"<code>check = np.all(self.success)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.__init__","title":"<code>__init__(reference_values, computed_values, eps, ignore_near_zero_errors, near_zero)</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.one_line_report","title":"<code>one_line_report()</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.LegacyMetric.report","title":"<code>report(file_path=None)</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric","title":"<code>MultiModalFloatMetric</code>","text":"<p>               Bases: <code>BaseMetric</code></p> <p>Combination of absolute, relative &amp; ULP comparison for floats</p> <p>This metric attempts to combine well known comparison on floats to leverage a robust 32/64 bit float comparison on large accumulating floating errors.</p> <p>ULP is used to clear noise (ULP&lt;=1.0 passes) Absolute errors for large amplitude</p>"},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.relative_fraction","title":"<code>relative_fraction = _Metric(1e-06)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.ulp_threshold","title":"<code>ulp_threshold = _Metric(1.0)</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.absolute_distance","title":"<code>absolute_distance = np.empty_like(self.references)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.absolute_distance_metric","title":"<code>absolute_distance_metric = np.empty_like(self.references, dtype=(np.bool_))</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.relative_distance","title":"<code>relative_distance = np.empty_like(self.references)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.relative_distance_metric","title":"<code>relative_distance_metric = np.empty_like(self.references, dtype=(np.bool_))</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.ulp_distance","title":"<code>ulp_distance = np.empty_like(self.references)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.ulp_distance_metric","title":"<code>ulp_distance_metric = np.empty_like(self.references, dtype=(np.bool_))</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.absolute_eps","title":"<code>absolute_eps = _Metric(self._f32_absolute_eps.value)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.success","title":"<code>success = self._compute_all_metrics()</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.check","title":"<code>check = np.all(self.success)</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.sort_report","title":"<code>sort_report = sort_report</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.number_changing_values","title":"<code>number_changing_values = (input_values != reference_values).flatten().shape[0]</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.__init__","title":"<code>__init__(input_values, reference_values, computed_values, absolute_eps_override=-1, relative_fraction_override=-1, ulp_override=-1, sort_report='ulp')</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.one_line_report","title":"<code>one_line_report()</code>","text":""},{"location":"docstrings/testing/comparison/#testing.comparison.MultiModalFloatMetric.report","title":"<code>report(file_path=None)</code>","text":""},{"location":"docstrings/testing/perturbation/","title":"perturbation","text":""},{"location":"docstrings/testing/perturbation/#testing.perturbation.perturb","title":"<code>perturb(input)</code>","text":"<p>Adds roundoff-level noise to the input array in-place through multiplication.</p> <p>Will only make changes to float64 or float32 arrays.</p>"},{"location":"docstrings/top/boilerplate/","title":"boilerplate","text":""},{"location":"docstrings/top/boilerplate/#boilerplate.get_factories_single_tile_orchestrated","title":"<code>get_factories_single_tile_orchestrated(nx, ny, nz, nhalo, backend='dace:cpu', *, orchestration_mode=None)</code>","text":"<p>Build the pair of (StencilFactory, QuantityFactory) for orchestrated code on a single tile topology.</p>"},{"location":"docstrings/top/boilerplate/#boilerplate.get_factories_single_tile","title":"<code>get_factories_single_tile(nx, ny, nz, nhalo, backend='numpy')</code>","text":"<p>Build the pair of (StencilFactory, QuantityFactory) for stencils on a single tile topology.</p>"},{"location":"docstrings/top/buffer/","title":"buffer","text":""},{"location":"docstrings/top/buffer/#buffer.BufferKey","title":"<code>BufferKey = tuple[Callable, Iterable[int], type]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/buffer/#buffer.BUFFER_CACHE","title":"<code>BUFFER_CACHE = {}</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/buffer/#buffer.Buffer","title":"<code>Buffer</code>","text":"<p>A buffer cached by default.</p> <p>_key: key into cache storage to allow easy re-caching array: ndarray allocated</p>"},{"location":"docstrings/top/buffer/#buffer.Buffer.array","title":"<code>array = array</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/top/buffer/#buffer.Buffer.__init__","title":"<code>__init__(key, array)</code>","text":"<p>Init a cacheable buffer.</p> <p>Parameters:</p> Name Type Description Default <code>key</code> <code>BufferKey</code> <p>a cache key made out of tuple of Allocator, shape and dtype</p> required <code>array</code> <code>ndarray</code> <p>ndarray of actual data</p> required"},{"location":"docstrings/top/buffer/#buffer.Buffer.pop_from_cache","title":"<code>pop_from_cache(allocator, shape, dtype)</code>  <code>classmethod</code>","text":"<p>Retrieve or insert then retrieve of buffer from cache.</p> <p>Parameters:</p> Name Type Description Default <code>allocator</code> <code>Allocator</code> <p>used to allocate memory</p> required <code>shape</code> <code>Iterable[int]</code> <p>shape of array</p> required <code>dtype</code> <code>type</code> <p>type of array elements</p> required <p>Return:     a buffer wrapping an allocated array</p>"},{"location":"docstrings/top/buffer/#buffer.Buffer.push_to_cache","title":"<code>push_to_cache(buffer)</code>  <code>staticmethod</code>","text":"<p>Push the buffer back into the cache.</p> <p>Parameters:</p> Name Type Description Default <code>buffer</code> <code>Buffer</code> <p>buffer to push back in cache, using internal key</p> required"},{"location":"docstrings/top/buffer/#buffer.Buffer.finalize_memory_transfer","title":"<code>finalize_memory_transfer()</code>","text":"<p>Finalize any memory transfer</p>"},{"location":"docstrings/top/buffer/#buffer.Buffer.assign_to","title":"<code>assign_to(destination_array, buffer_slice=np.index_exp[:], buffer_reshape=None)</code>","text":"<p>Assign internal array to destination_array.</p> <p>Parameters:</p> Name Type Description Default <code>destination_array</code> <code>ndarray</code> <p>target ndarray</p> required"},{"location":"docstrings/top/buffer/#buffer.Buffer.assign_from","title":"<code>assign_from(source_array, buffer_slice=np.index_exp[:])</code>","text":"<p>Assign source_array to internal array.</p> <p>Parameters:</p> Name Type Description Default <code>source_array</code> <code>ndarray</code> <p>source ndarray</p> required"},{"location":"docstrings/top/buffer/#buffer.array_buffer","title":"<code>array_buffer(allocator, shape, dtype)</code>","text":"<p>A context manager providing a contiguous array, which may be re-used between calls.</p> <p>Parameters:</p> Name Type Description Default <code>allocator</code> <code>Allocator</code> <p>a function with the same signature as numpy.zeros which returns an ndarray</p> required <code>shape</code> <code>Iterable[int]</code> <p>the shape of the desired array</p> required <code>dtype</code> <code>type</code> <p>the dtype of the desired array</p> required <p>Yields:</p> Name Type Description <code>buffer_array</code> <code>Buffer</code> <p>an ndarray created according to the specification in the args. May be retained and re-used in subsequent calls.</p>"},{"location":"docstrings/top/buffer/#buffer.send_buffer","title":"<code>send_buffer(allocator, array, timer=None)</code>","text":"<p>A context manager ensuring that <code>array</code> is contiguous in a context where it is being sent as data, copying into a recycled buffer array if necessary.</p> <p>Parameters:</p> Name Type Description Default <code>allocator</code> <code>Callable</code> <p>used to allocate memory</p> required <code>array</code> <code>ndarray</code> <p>a possibly non-contiguous array for which to provide a buffer</p> required <code>timer</code> <code>Timer | None</code> <p>object to accumulate timings for \"pack\"</p> <code>None</code> <p>Yields:</p> Name Type Description <code>buffer_array</code> <code>ndarray</code> <p>if array is non-contiguous, a contiguous buffer array containing the data from array. Otherwise, yields array.</p>"},{"location":"docstrings/top/buffer/#buffer.recv_buffer","title":"<code>recv_buffer(allocator, array, timer=None)</code>","text":"<p>A context manager ensuring that array is contiguous in a context where it is being used to receive data, using a recycled buffer array and then copying the result into array if necessary.</p> <p>Parameters:</p> Name Type Description Default <code>allocator</code> <code>Callable</code> <p>used to allocate memory</p> required <code>array</code> <code>ndarray</code> <p>a possibly non-contiguous array for which to provide a buffer</p> required <code>timer</code> <code>Timer | None</code> <p>object to accumulate timings for \"unpack\"</p> <code>None</code> <p>Yields:</p> Name Type Description <code>buffer_array</code> <code>ndarray</code> <p>if array is non-contiguous, a contiguous buffer array which is copied into array when the context is exited. Otherwise, yields array.</p>"},{"location":"docstrings/top/constants/","title":"constants","text":""},{"location":"docstrings/top/constants/#constants.CONST_VERSION","title":"<code>CONST_VERSION = ConstantVersions[_get_constant_version()]</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.I_DIM","title":"<code>I_DIM = 'i'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.X_DIM","title":"<code>X_DIM = 'i'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.I_INTERFACE_DIM","title":"<code>I_INTERFACE_DIM = 'i_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.X_INTERFACE_DIM","title":"<code>X_INTERFACE_DIM = 'i_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.J_DIM","title":"<code>J_DIM = 'j'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.Y_DIM","title":"<code>Y_DIM = 'j'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.J_INTERFACE_DIM","title":"<code>J_INTERFACE_DIM = 'j_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.Y_INTERFACE_DIM","title":"<code>Y_INTERFACE_DIM = 'j_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.K_DIM","title":"<code>K_DIM = 'k'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.Z_DIM","title":"<code>Z_DIM = 'k'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.K_INTERFACE_DIM","title":"<code>K_INTERFACE_DIM = 'k_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.Z_INTERFACE_DIM","title":"<code>Z_INTERFACE_DIM = 'k_interface'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.K_SOIL_DIM","title":"<code>K_SOIL_DIM = 'k_soil'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.Z_SOIL_DIM","title":"<code>Z_SOIL_DIM = 'k_soil'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.I_DIMS","title":"<code>I_DIMS = (I_DIM, I_INTERFACE_DIM)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.J_DIMS","title":"<code>J_DIMS = (J_DIM, J_INTERFACE_DIM)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.K_DIMS","title":"<code>K_DIMS = (K_DIM, K_INTERFACE_DIM)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.HORIZONTAL_DIMS","title":"<code>HORIZONTAL_DIMS = I_DIMS + J_DIMS</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.INTERFACE_DIMS","title":"<code>INTERFACE_DIMS = (I_INTERFACE_DIM, J_INTERFACE_DIM, K_INTERFACE_DIM)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SPATIAL_DIMS","title":"<code>SPATIAL_DIMS = I_DIMS + J_DIMS + K_DIMS</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.ROOT_RANK","title":"<code>ROOT_RANK = 0</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.TILE_DIM","title":"<code>TILE_DIM = 'tile'</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.WEST","title":"<code>WEST = 0</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.EAST","title":"<code>EAST = 1</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.NORTH","title":"<code>NORTH = 2</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SOUTH","title":"<code>SOUTH = 3</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.NORTHWEST","title":"<code>NORTHWEST = 4</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.NORTHEAST","title":"<code>NORTHEAST = 5</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SOUTHWEST","title":"<code>SOUTHWEST = 6</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SOUTHEAST","title":"<code>SOUTHEAST = 7</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.INTERIOR","title":"<code>INTERIOR = 8</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.EDGE_BOUNDARY_TYPES","title":"<code>EDGE_BOUNDARY_TYPES = (NORTH, SOUTH, WEST, EAST)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.CORNER_BOUNDARY_TYPES","title":"<code>CORNER_BOUNDARY_TYPES = (NORTHWEST, NORTHEAST, SOUTHWEST, SOUTHEAST)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.BOUNDARY_TYPES","title":"<code>BOUNDARY_TYPES = EDGE_BOUNDARY_TYPES + CORNER_BOUNDARY_TYPES</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.N_HALO_DEFAULT","title":"<code>N_HALO_DEFAULT = 3</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.NQ","title":"<code>NQ = 9</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.RADIUS","title":"<code>RADIUS = Float(6371000.0)</code>  <code>module-attribute</code>","text":"<p>Radius of the Earth [m]</p>"},{"location":"docstrings/top/constants/#constants.PI_8","title":"<code>PI_8 = np.float64(3.141592653589793)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.PI","title":"<code>PI = Float(PI_8)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.OMEGA","title":"<code>OMEGA = Float(2.0) * PI / Float(86164.0)</code>  <code>module-attribute</code>","text":"<p>Rotation of the earth</p>"},{"location":"docstrings/top/constants/#constants.GRAV","title":"<code>GRAV = Float(9.80665)</code>  <code>module-attribute</code>","text":"<p>Acceleration due to gravity [m/s^2].04</p>"},{"location":"docstrings/top/constants/#constants.RGRAV","title":"<code>RGRAV = Float(1.0) / GRAV</code>  <code>module-attribute</code>","text":"<p>Inverse of gravitational acceleration</p>"},{"location":"docstrings/top/constants/#constants.RDGAS","title":"<code>RDGAS = Float(8314.47) / Float(28.965)</code>  <code>module-attribute</code>","text":"<p>Gas constant for dry air [J/kg/deg] ~287.04</p>"},{"location":"docstrings/top/constants/#constants.RVGAS","title":"<code>RVGAS = Float(8314.47) / Float(18.015)</code>  <code>module-attribute</code>","text":"<p>Gas constant for water vapor [J/kg/deg]</p>"},{"location":"docstrings/top/constants/#constants.HLV","title":"<code>HLV = Float(2466500.0)</code>  <code>module-attribute</code>","text":"<p>Latent heat of evaporation [J/kg]</p>"},{"location":"docstrings/top/constants/#constants.HLF","title":"<code>HLF = Float(333700.0)</code>  <code>module-attribute</code>","text":"<p>Latent heat of fusion [J/kg]  ~3.34e5</p>"},{"location":"docstrings/top/constants/#constants.KAPPA","title":"<code>KAPPA = RDGAS / (Float(3.5) * RDGAS)</code>  <code>module-attribute</code>","text":"<p>Specific heat capacity of dry air at</p>"},{"location":"docstrings/top/constants/#constants.CP_AIR","title":"<code>CP_AIR = RDGAS / KAPPA</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.TFREEZE","title":"<code>TFREEZE = Float(273.16)</code>  <code>module-attribute</code>","text":"<p>Freezing temperature of fresh water [K]</p>"},{"location":"docstrings/top/constants/#constants.SAT_ADJUST_THRESHOLD","title":"<code>SAT_ADJUST_THRESHOLD = Float(1e-06)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.DZ_MIN","title":"<code>DZ_MIN = Float(6.0)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SECONDS_PER_DAY","title":"<code>SECONDS_PER_DAY = Float(86400.0)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.SBC","title":"<code>SBC = Float(5.6704e-08)</code>  <code>module-attribute</code>","text":"<p>Stefan-Boltzmann constant (W/m^2/K^4)</p>"},{"location":"docstrings/top/constants/#constants.RHO_H2O","title":"<code>RHO_H2O = Float(1000.0)</code>  <code>module-attribute</code>","text":"<p>Density of water in kg/m^3</p>"},{"location":"docstrings/top/constants/#constants.CV_AIR","title":"<code>CV_AIR = CP_AIR - RDGAS</code>  <code>module-attribute</code>","text":"<p>Heat capacity of dry air at constant volume</p>"},{"location":"docstrings/top/constants/#constants.RDG","title":"<code>RDG = -RDGAS / GRAV</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.K1K","title":"<code>K1K = RDGAS / CV_AIR</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.CNST_0P20","title":"<code>CNST_0P20 = np.float64(0.2)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.CV_VAP","title":"<code>CV_VAP = Float(3.0) * RVGAS</code>  <code>module-attribute</code>","text":"<p>Heat capacity of water vapor at constant volume</p>"},{"location":"docstrings/top/constants/#constants.ZVIR","title":"<code>ZVIR = RVGAS / RDGAS - Float(1)</code>  <code>module-attribute</code>","text":"<p>con_fvirt in Fortran physics</p>"},{"location":"docstrings/top/constants/#constants.C_ICE","title":"<code>C_ICE = Float(1972.0)</code>  <code>module-attribute</code>","text":"<p>Heat capacity of ice at -15 degrees Celsius</p>"},{"location":"docstrings/top/constants/#constants.C_ICE_0","title":"<code>C_ICE_0 = Float(2106.0)</code>  <code>module-attribute</code>","text":"<p>Heat capacity of ice at 0 degrees Celsius</p>"},{"location":"docstrings/top/constants/#constants.C_LIQ","title":"<code>C_LIQ = Float(4185.5)</code>  <code>module-attribute</code>","text":"<p>Heat capacity of water at 15 degrees Celsius</p>"},{"location":"docstrings/top/constants/#constants.CP_VAP","title":"<code>CP_VAP = Float(4.0) * RVGAS</code>  <code>module-attribute</code>","text":"<p>Heat capacity of water vapor at constant pressure</p>"},{"location":"docstrings/top/constants/#constants.TICE","title":"<code>TICE = Float(273.16)</code>  <code>module-attribute</code>","text":"<p>Freezing temperature</p>"},{"location":"docstrings/top/constants/#constants.DC_ICE","title":"<code>DC_ICE = C_LIQ - C_ICE</code>  <code>module-attribute</code>","text":"<p>Isobaric heating / cooling</p>"},{"location":"docstrings/top/constants/#constants.DC_VAP","title":"<code>DC_VAP = CP_VAP - C_LIQ</code>  <code>module-attribute</code>","text":"<p>Isobaric heating / cooling</p>"},{"location":"docstrings/top/constants/#constants.D2ICE","title":"<code>D2ICE = DC_VAP + DC_ICE</code>  <code>module-attribute</code>","text":"<p>Isobaric heating / cooling</p>"},{"location":"docstrings/top/constants/#constants.LI0","title":"<code>LI0 = HLF - DC_ICE * TICE</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.EPS","title":"<code>EPS = RDGAS / RVGAS</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.EPSM1","title":"<code>EPSM1 = EPS - Float(1.0)</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.LV0","title":"<code>LV0 = HLV - DC_VAP * TICE</code>  <code>module-attribute</code>","text":"<p>3.13905782e6, evaporation latent heat coefficient at 0 degrees Kelvin</p>"},{"location":"docstrings/top/constants/#constants.LI00","title":"<code>LI00 = HLF - DC_ICE * TICE</code>  <code>module-attribute</code>","text":"<p>-2.7105966e5, fusion latent heat coefficient at 0 degrees Kelvin</p>"},{"location":"docstrings/top/constants/#constants.LI2","title":"<code>LI2 = LV0 + LI00</code>  <code>module-attribute</code>","text":"<p>2.86799816e6, sublimation latent heat coefficient at 0 degrees Kelvin</p>"},{"location":"docstrings/top/constants/#constants.E00","title":"<code>E00 = Float(611.21)</code>  <code>module-attribute</code>","text":"<p>Saturation vapor pressure at 0 degrees Celsius (Pa)</p>"},{"location":"docstrings/top/constants/#constants.PSAT","title":"<code>PSAT = Float(610.78)</code>  <code>module-attribute</code>","text":"<p>Saturation vapor pressure at H2O 3pt (Pa)</p>"},{"location":"docstrings/top/constants/#constants.T_WFR","title":"<code>T_WFR = TICE - Float(40.0)</code>  <code>module-attribute</code>","text":"<p>homogeneous freezing temperature</p>"},{"location":"docstrings/top/constants/#constants.TICE0","title":"<code>TICE0 = Float(273.15)</code>  <code>module-attribute</code>","text":"<p>Temp at 0C</p>"},{"location":"docstrings/top/constants/#constants.T_MIN","title":"<code>T_MIN = Float(178.0)</code>  <code>module-attribute</code>","text":"<p>Minimum temperature to freeze-dry all water vapor</p>"},{"location":"docstrings/top/constants/#constants.T_SAT_MIN","title":"<code>T_SAT_MIN = TICE - Float(160.0)</code>  <code>module-attribute</code>","text":"<p>Minimum temperature used in saturation calculations</p>"},{"location":"docstrings/top/constants/#constants.LAT2","title":"<code>LAT2 = np.power(HLV + HLF, 2, dtype=Float)</code>  <code>module-attribute</code>","text":"<p>Used in bigg mechanism</p>"},{"location":"docstrings/top/constants/#constants.TTP","title":"<code>TTP = Float(273.16)</code>  <code>module-attribute</code>","text":"<p>Temperature of H2O triple point</p>"},{"location":"docstrings/top/constants/#constants.ConstantVersions","title":"<code>ConstantVersions</code>","text":"<p>               Bases: <code>Enum</code></p>"},{"location":"docstrings/top/constants/#constants.ConstantVersions.GFDL","title":"<code>GFDL = 'GFDL'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.ConstantVersions.UFS","title":"<code>UFS = 'UFS'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/top/constants/#constants.ConstantVersions.GEOS","title":"<code>GEOS = 'GEOS'</code>  <code>class-attribute</code> <code>instance-attribute</code>","text":""},{"location":"docstrings/top/io/","title":"io","text":""},{"location":"docstrings/top/io/#io.THIRTY_DAY_MONTHS","title":"<code>THIRTY_DAY_MONTHS = 1</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/io/#io.JULIAN","title":"<code>JULIAN = 2</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/io/#io.GREGORIAN","title":"<code>GREGORIAN = 3</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/io/#io.NOLEAP","title":"<code>NOLEAP = 4</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/io/#io.FMS_TO_CFTIME_TYPE","title":"<code>FMS_TO_CFTIME_TYPE = {THIRTY_DAY_MONTHS: cftime.Datetime360Day, JULIAN: cftime.DatetimeJulian, GREGORIAN: cftime.DatetimeGregorian, NOLEAP: cftime.DatetimeNoLeap}</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/io/#io.to_xarray_dataset","title":"<code>to_xarray_dataset(state)</code>","text":""},{"location":"docstrings/top/io/#io.write_state","title":"<code>write_state(state, filename)</code>","text":"<p>Write a model state to a NetCDF file.</p> <p>Parameters:</p> Name Type Description Default <code>state</code> <code>dict</code> <p>a model state dictionary</p> required <code>filename</code> <code>str</code> <p>local or remote location to write the NetCDF file</p> required"},{"location":"docstrings/top/io/#io.read_state","title":"<code>read_state(filename)</code>","text":"<p>Read a model state from a NetCDF file.</p> <p>Parameters:</p> Name Type Description Default <code>filename</code> <code>str</code> <p>local or remote location of the NetCDF file</p> required <p>Returns:</p> Name Type Description <code>state</code> <code>dict</code> <p>a model state dictionary</p>"},{"location":"docstrings/top/io/#io.get_current_date_from_coupler_res","title":"<code>get_current_date_from_coupler_res(file)</code>","text":""},{"location":"docstrings/top/logging/","title":"logging","text":""},{"location":"docstrings/top/logging/#logging.AVAILABLE_LOG_LEVELS","title":"<code>AVAILABLE_LOG_LEVELS = {'info': logging.INFO, 'debug': logging.DEBUG, 'warning': logging.WARNING, 'error': logging.ERROR, 'critical': logging.CRITICAL}</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/logging/#logging.ndsl_log","title":"<code>ndsl_log = _ndsl_logger()</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/logging/#logging.ndsl_log_on_rank_0","title":"<code>ndsl_log_on_rank_0 = _ndsl_logger_on_rank_0()</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/optional_imports/","title":"optional_imports","text":""},{"location":"docstrings/top/optional_imports/#optional_imports.RaiseWhenAccessed","title":"<code>RaiseWhenAccessed</code>","text":""},{"location":"docstrings/top/optional_imports/#optional_imports.RaiseWhenAccessed.__init__","title":"<code>__init__(err)</code>","text":""},{"location":"docstrings/top/optional_imports/#optional_imports.RaiseWhenAccessed.__call__","title":"<code>__call__(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/","title":"types","text":""},{"location":"docstrings/top/types/#types.Number","title":"<code>Number = int | float | np.int32 | np.int64 | np.float32 | np.float64</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/types/#types.Allocator","title":"<code>Allocator</code>","text":"<p>               Bases: <code>Protocol</code></p>"},{"location":"docstrings/top/types/#types.Allocator.__call__","title":"<code>__call__(shape, dtype)</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule","title":"<code>NumpyModule</code>","text":"<p>               Bases: <code>Protocol</code></p>"},{"location":"docstrings/top/types/#types.NumpyModule.empty","title":"<code>empty</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.zeros","title":"<code>zeros</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.ones","title":"<code>ones</code>  <code>instance-attribute</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.rot90","title":"<code>rot90(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.sum","title":"<code>sum(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.log","title":"<code>log(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.sin","title":"<code>sin(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/#types.NumpyModule.asarray","title":"<code>asarray(*args, **kwargs)</code>","text":""},{"location":"docstrings/top/types/#types.AsyncRequest","title":"<code>AsyncRequest</code>","text":"<p>               Bases: <code>Protocol</code></p> <p>Define the result of an over-the-network capable communication API</p>"},{"location":"docstrings/top/types/#types.AsyncRequest.wait","title":"<code>wait()</code>","text":"<p>Block the current thread waiting for the request to be completed</p>"},{"location":"docstrings/top/typing/","title":"typing","text":""},{"location":"docstrings/top/utils/","title":"utils","text":""},{"location":"docstrings/top/utils/#utils.GPU_AVAILABLE","title":"<code>GPU_AVAILABLE = True</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/utils/#utils.T","title":"<code>T = TypeVar('T')</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/utils/#utils.DEFAULT_GRID_NML_GROUPS","title":"<code>DEFAULT_GRID_NML_GROUPS = ['fv_core_nml']</code>  <code>module-attribute</code>","text":""},{"location":"docstrings/top/utils/#utils.MetaEnumStr","title":"<code>MetaEnumStr</code>","text":"<p>               Bases: <code>EnumMeta</code></p>"},{"location":"docstrings/top/utils/#utils.list_by_dims","title":"<code>list_by_dims(dims, horizontal_list, non_horizontal_value)</code>","text":"<p>Take in a list of dimensions, a (y, x) set of values, and a value for any non-horizontal dimensions. Return a list of length len(dims) with the value for each dimension.</p>"},{"location":"docstrings/top/utils/#utils.is_contiguous","title":"<code>is_contiguous(array)</code>","text":""},{"location":"docstrings/top/utils/#utils.is_c_contiguous","title":"<code>is_c_contiguous(array)</code>","text":""},{"location":"docstrings/top/utils/#utils.ensure_contiguous","title":"<code>ensure_contiguous(maybe_array)</code>","text":""},{"location":"docstrings/top/utils/#utils.safe_assign_array","title":"<code>safe_assign_array(to_array, from_array)</code>","text":"<p>Failproof assignment for array on different devices.</p> <p>The memory will be downloaded/uploaded from GPU if need be.</p> <p>Parameters:</p> Name Type Description Default <code>to_array</code> <code>ndarray</code> <p>destination ndarray</p> required <code>from_array</code> <code>ndarray</code> <p>source ndarray</p> required"},{"location":"docstrings/top/utils/#utils.device_synchronize","title":"<code>device_synchronize()</code>","text":"<p>Synchronize all memory communication</p>"},{"location":"docstrings/top/utils/#utils.safe_mpi_allocate","title":"<code>safe_mpi_allocate(allocator, shape, dtype)</code>","text":"<p>Make sure the allocation use an allocator that works with MPI</p> <p>For G2G transfer, MPICH requires the allocation to not be done with managed memory. Since we can't know what state <code>cupy</code> is in with switch for the default pooled allocator.</p> <p>If allocator comes from cupy, it must be cupy.empty or cupy.zeros. We raise a RuntimeError if a cupy array is allocated outside of the safe code path.</p> <p>Though the allocation might be safe, the MPI crash that result from a managed memory allocation is non trivial and should be tightly controlled.</p>"},{"location":"docstrings/top/utils/#utils.flatten_nml_to_dict","title":"<code>flatten_nml_to_dict(nml)</code>","text":"<p>Returns a flattened dict version of a f90nml.namelist.Namelist</p> <p>Parameters:</p> Name Type Description Default <code>nml</code> <code>Namelist</code> <p>f90nml.Namelist</p> required"},{"location":"docstrings/top/utils/#utils.load_f90nml","title":"<code>load_f90nml(namelist_path)</code>","text":"<p>Loads a Fortran namelist given its path and return a f90nml.Namelist</p> <p>Parameters:</p> Name Type Description Default <code>namelist_path</code> <code>Path</code> <p>Path to the Fortran namelist file</p> required"},{"location":"docstrings/top/utils/#utils.load_f90nml_as_dict","title":"<code>load_f90nml_as_dict(namelist_path, flatten=True, target_groups=None)</code>","text":"<p>Loads a Fortran namelist given its path and returns a dict representation. If target_groups are specified, then the dict is created using only those groups.</p> <p>Parameters:</p> Name Type Description Default <code>namelist_path</code> <code>Path</code> <p>Path to the Fortran namelist file</p> required <code>flatten</code> <code>bool</code> <p>If True, flattens the loaded namelist (without groups) before      returning it. (Default: True) Otherwise, it returns the f90nml.Namelist      dict representation.</p> <code>True</code> <code>target_groups</code> <code>list[str] | None</code> <p>If 'None' is specified, then all groups are            considered. (Default: None) Otherwise, only parameters            from the specified groups are considered.</p> <code>None</code>"},{"location":"docstrings/top/utils/#utils.f90nml_as_dict","title":"<code>f90nml_as_dict(nml, flatten=True, target_groups=None)</code>","text":"<p>Uses a f90nml.Namelist and returns a dict representation. If target_groups are specified, then the dict is created using only those groups. The return dicts can be flattened further to remove the group information or keep the group information.</p> <p>Parameters:</p> Name Type Description Default <code>nml</code> <code>Namelist</code> <p>f90nml.Namelist</p> required <code>flatten</code> <code>bool</code> <p>If True, flattens the loaded namelist (without groups) before      returning it. (Default: True) Otherwise, it returns the f90nml.Namelist      dict representation.</p> <code>True</code> <code>target_groups</code> <code>list[str] | None</code> <p>If 'None' is specified, then all groups are            considered. (Default: None) Otherwise, only parameters            from the specified groups are considered.</p> <code>None</code>"},{"location":"docstrings/top/utils/#utils.grid_params_from_f90nml","title":"<code>grid_params_from_f90nml(nml)</code>","text":"<p>Uses a f90nml.Namelist and returns a dict representation of parameters useful for grid generation. The return dict will be flattened with key-value pairs from the nml's DEFAULT_GRID_NML_GROUPS.</p> <p>Parameters:</p> Name Type Description Default <code>nml</code> <code>Namelist</code> <p>f90nml.Namelist</p> required"},{"location":"docstrings/viz/cube_sphere/","title":"cube_sphere","text":""},{"location":"docstrings/viz/cube_sphere/#viz.cube_sphere.plot_cube_sphere","title":"<code>plot_cube_sphere(quantity, k_level, comm, grid_data, save_to_path)</code>","text":""},{"location":"includes/glossary/","title":"Glossary","text":""},{"location":"porting/","title":"Notes on porting FORTRAN code","text":"<p>This part of the documentation includes notes about porting FORTRAN code to NDSL.</p>"},{"location":"porting/#general-concepts","title":"General Concepts","text":"<p>Since we are not trying to do model developing but rather replicate an existing model, the main philosophy is to replicate model behavior as precisely as possible. Since weather and climate models can take diverging paths based on very small input differences, as described in [1], a bitwise reproducible code is impossible to achieve. There were attempts at solving this problem like shown in [2] or [3] but all of those require heavy modification to the original code. In our case, the switch from the original FORTRAN environment to a C++ environment can already contribute to these small errors showing up and therefore a 1:1 validation on a large scale is impossible. This effect gets further enhanced by computation on GPUs. Lastly the mixing of precisions found in various models is often done slightly unmethodical and can further complicate the understand of what precision is required where.</p> <p>Since large scale validation is therefore close to impossible, we are trying to get reproducible results (within a margin) on smaller sub-components of the model. When porting code, we therefore try to break down larger components into logical, numerically coherent substructures that can be tested and validated individually. This breakdown serves two main purposes:</p> <ol> <li>Give us confidence, that the ported code behaves as intended.</li> <li>Allow us to monitor if or how performance optimization down the road changes the numerical results of our model components.</li> </ol>"},{"location":"porting/#porting-guidelines","title":"Porting Guidelines","text":"<p>Since GT4Py has certain restrictions on what can be in the same stencil and what needs to be in separate stencils, there is no absolute 1:1 mapping that can or should be applied.</p> <p>The best practices we found are:</p> <ol> <li>A numerically self-contained module should always live in a single class.</li> <li>If possible, try to isolate individual numerical motifs into functions.</li> </ol>"},{"location":"porting/#example","title":"Example","text":"<p>To illustrate best practices, we show a stripped version of the the nonhydrostatic vertical solver on the C-grid (Also know as the Riemann Solver):</p>"},{"location":"porting/#main-definition","title":"Main definition","text":"<pre><code>class NonhydrostaticVerticalSolverCGrid:\n    def __init__(self, ...):\n        # Definition of the (potentially multiple) stencils to call\n        self._precompute_stencil = stencil_factory.from_origin_domain(\n            precompute,\n            origin=origin,\n            domain=domain,\n        )\n        self._compute_sim1_solve = stencil_factory.from_origin_domain(\n            sim1_solver,\n            origin=origin,\n            domain=domain,\n        )\n        # Definition of temporary variables share across two stencils\n        # that are not used outside the module\n        self._pfac = FloatFieldIJ()\n        ...\n    def __call__(self, cappa: FloatField, delpc: FloatField):\n        self._precompute_stencil(cappa, _pfac)\n        self._compute_sim1_solve(_pfac, delpc)\n</code></pre>"},{"location":"porting/#stencil-definitions","title":"Stencil Definitions","text":"<pre><code>#constants definition\nc1 = Float(-2.0) / Float(14.0)\nc2 = Float(11.0) / Float(14.0)\nc3 = Float(5.0) / Float(14.0)\n\n#function for numerical standalone motif\n@gtscript.function\ndef vol_conserv_cubic_interp_func_y(v):\n    return c1 * v[0, -2, 0] + c2 * v[0, -1, 0] + c3 * v\n\ndef precompute(cappa: FloatField, _pfac: FloatFieldIJ):\n    # small computation directly in the stencil\n    with computation(PARALLEL), interval(...):\n        # a variable used only in one stencil can be defined here\n        tmpvar = cappa[1,0,0] + 1\n    with computation(PARALLEL), interval(0, 1):\n        _pfac = tmpvar[0,0,1]\n\ndef sim1_solver(cappa: FloatField, _pfac: FloatFieldIJ):\n    with computation(PARALLEL), interval(...):\n        cappa = vol_conserv_cubic_interp_func_y(cappa) + _pfac\n</code></pre>"},{"location":"porting/translate/","title":"Translate tests","text":"<p>We call tests that validate subsets of computation against serialized data \"translate tests\". These should provide a baseline with which we can validate ported code and ensure the pipeline generates expected results.</p>"},{"location":"porting/translate/#the-translate-infrastructure","title":"The Translate infrastructure","text":"<p>The infrastructure is set up in a way that for basic cases, all the default implementations are enough:</p> <p>The <code>TranslateFortranData2Py</code> base class will be evaluated through the function <code>test_sequential_savepoint</code>. The general structure is:</p> <ol> <li>Extract tolerances for errors - either the defaults or the overwritten ones:<ul> <li>Maximal absolute error</li> <li>Maximal relative error</li> <li>Allowed ULP difference</li> </ul> </li> <li>Extract input data from <code>{savepoint_name}-In.nc</code></li> <li>Run the <code>compute</code> function, returning the outputs.</li> <li>Extract reference output data from <code>{savepoint_name}-Out.nc</code></li> <li>Compare the data in <code>out_vars</code> to the reference data.</li> </ol> <p>For these steps to work, the name of the translate test needs to match the name of the data. In case of special handling required, almost everything can be overwritten:</p>"},{"location":"porting/translate/#overwriting-thresholds","title":"Overwriting thresholds","text":"<p>You can create an overwrite file to manually set the threshold in you data directory:</p> <p></p>"},{"location":"porting/translate/#testing-with-custom-data","title":"Testing with Custom Data","text":"<p>The default netcdf names can be overwritten by setting <code>self.override_input_netcdf_name</code> and/or <code>self.override_output_netcdf_name</code> for the input and output netcdf, respectively. These new names should be the entire file name (including, but not requiring, -In or -Out suffixes), excluding the <code>.nc</code> file tag. These files must be located in the same folder as the default files.</p>"},{"location":"porting/translate/#overwriting-arguments-to-your-compute-function","title":"Overwriting Arguments to your compute function","text":"<p>The compute_func will be called automatically in the test. If your names in the netcdf are matching the <code>kwargs</code> of your function directly, no further action required:</p> <p></p> <p>If you need to rename it from the netcdf, you can use [\"serialname\"]:</p> <p></p> <p>The same applies for scalar inputs with parameters:</p> <p></p>"},{"location":"porting/translate/#modifying-output-variables","title":"Modifying output variables","text":"<p>This can be required either if not all output is serialized, the naming is different or we need the same data as the input:</p> <p></p>"},{"location":"porting/translate/#modifying-the-compute-function","title":"Modifying the <code>compute</code> function","text":"<p>Normally, compute has the three steps:</p> <ol> <li>setup input</li> <li>call <code>compute_func</code></li> <li>slice outputs</li> </ol> <p>Slight adaptations to every step are possible:</p> <p></p>"},{"location":"user/","title":"Usage documentation","text":"<p>This part of the documentation is geared towards users of NDSL.</p>"},{"location":"user/#up-and-running","title":"Up and running","text":"<p>See our quickstart guide on how to get up and running.</p>"},{"location":"user/#configuration","title":"Configuration","text":"<p>NDSL tries to have sensible defaults. In cases you want tweak something, here are some pointers:</p>"},{"location":"user/#literal-precision-floatint","title":"Literal precision (float/int)","text":"<p>Unspecified integer and floating point literals (e.g. <code>42</code> and <code>3.1415</code>) default to 64-bit precision. This can be changed with the environment variable <code>NDSL_LITERAL_PRECISION</code>.</p> <p>For mixed precision code, you can specify the \"hard coded\" precision with type hints and casts, e.g.</p> <pre><code>with computation(PARALLEL), interval(...):\n    # Either 32-bit or 64-bit depending on `NDSL_LITERAL_PRECISION`\n    my_int = 42\n    my_float = 3.1415\n\n    # Always 32-bit\n    my_int32: int32 = 42\n    my_float32: float32 = 3.1415\n\n    # Explicit 64-bit cast within otherwise unspecified calculation\n    factor = 0.5 * float64(3.1415 + 2.71828)\n</code></pre>"},{"location":"user/#full-program-optimizer","title":"Full program optimizer","text":"<p>The behavior of the full program optimizer is controlled by <code>FV3_DACEMODE</code>. Valid values are:</p> <code>Python</code> <p>The default. Disables full program optimization and only accelerates stencil code.</p> <code>Build</code> <p>Build the program, then exit. This mode is only available for backends <code>dace:gpu</code> and <code>dace:cpu</code>.</p> <code>BuildAndRun</code> <p>Build the program, then run it immediately. This mode is only available for backends <code>dace:gpu</code> and <code>dace:cpu</code>.</p> <code>Run</code> <p>Load a pre-compiled program and run it. Fails if the pre-compiled program can not be found. This mode is only available for backends <code>dace:gpu</code> and <code>dace:cpu</code>.</p>"}]}